function Q(e){return Array.from(new Set(e))}function S(e,n){const t=X();return t[e]=t[e]||n}function X(){const e="_vike";return globalThis[e]=globalThis[e]||{}}const f=new Proxy({},{get:(e,n)=>t=>n==="code"?`\`${t}\``:n==="string"?`'${t}'`:t}),B="0.4.231";let p;p??(p=G());function G(){return S("utils/assertSingleInstance.ts",{instances:[],alreadyLogged:new Set})}function v(){return p??(p=G()),p}const Z="Client runtime of both Server Routing and Client Routing loaded https://vike.dev/client-runtimes-conflict",V="Client runtime loaded twice https://vike.dev/client-runtime-duplicated";function U(){const e=v();{const n=Q(e.instances);T(n.length<=1,`vike@${f.bold(n[0])} and vike@${f.bold(n[1])} loaded which is highly discouraged, see ${f.underline("https://vike.dev/warning/version-mismatch")}`,{onlyOnce:!0,showStackTrace:!1})}e.checkSingleInstance&&e.instances.length>1&&T(!1,V,{onlyOnce:!0,showStackTrace:!0})}function me(e){const n=v();T(n.isClientRouting!==!1,Z,{onlyOnce:!0,showStackTrace:!0}),T(n.isClientRouting===void 0,V,{onlyOnce:!0,showStackTrace:!0}),n.isClientRouting=!0,n.checkSingleInstance=!0,U()}function N(){v().instances.push(B),U()}function T(e,n,{onlyOnce:t,showStackTrace:o}){const r=v();if(e)return;const i=`[Vike][Warning] ${n}`;{const{alreadyLogged:s}=r,c=i;if(s.has(c))return;s.add(c)}console.warn(o?new Error(i):i)}function M(){return!(typeof process>"u"||!process.cwd||!process.versions||typeof process.versions.node>"u"||!process.release||process.release.name!=="node")}function $(e,n){const t=new Error(e);return M()&&(t.stack=ee(t.stack,n)),t}function ee(e,n){if(!e)return e;const t=te(e);let o=0;return t.filter(i=>i.includes(" (internal/")||i.includes(" (node:internal")?!1:o<n&&ne(i)?(o++,!1):!0).join(`
`)}function ne(e){return e.startsWith("    at ")}function te(e){return e.split(/\r?\n/)}function H(e){return typeof e=="object"&&e!==null}const a=S("utils/assert.ts",{alreadyLogged:new Set,logger(e,n){n==="info"?console.log(e):console.warn(e)},showStackTraceList:new WeakSet});N();const oe="[vike]",re=`[vike@${B}]`,ie="Bug",P=2;function u(e,n){var s;if(e)return;const t=(()=>{if(!n)return null;const c=typeof n=="string"?n:JSON.stringify(n);return f.dim(`Debug info (for Vike maintainers; you can ignore this): ${c}`)})();let r=[`You stumbled upon a Vike bug. Go to ${f.underline("https://github.com/vikejs/vike/issues/new?template=bug.yml")} and copy-paste this error. A maintainer will fix the bug (usually within 24 hours).`,t].filter(Boolean).join(" ");r=m(r),r=x(r,ie),r=b(r,!0);const i=$(r,P);throw(s=a.onBeforeLog)==null||s.call(a),i}function y(e,n,{showStackTrace:t,exitOnError:o}={}){var i;if(e)return;t=t||a.alwaysShowStackTrace,n=m(n),n=x(n,"Wrong Usage"),n=b(n);const r=$(n,P);if(t&&a.showStackTraceList.add(r),(i=a.onBeforeLog)==null||i.call(a),o)console.error(t?r:n),process.exit(1);else throw r}function se(e){return e=m(e),e=x(e,"Error"),e=b(e),$(e,P)}function ce(e,n,{onlyOnce:t,showStackTrace:o}){var r;if(!e){if(o=o||a.alwaysShowStackTrace,n=m(n),n=x(n,"Warning"),n=b(n),t){const{alreadyLogged:i}=a,s=t===!0?n:t;if(i.has(s))return;i.add(s)}if((r=a.onBeforeLog)==null||r.call(a),o){const i=$(n,P);a.showStackTraceList.add(i),a.logger(i,"warn")}else a.logger(n,"warn")}}function be(e,n,{onlyOnce:t}){var o;n=m(n),n=b(n);{const{alreadyLogged:r}=a,i=n;if(r.has(i))return;r.add(i)}(o=a.onBeforeLog)==null||o.call(a),a.logger(n,"info")}function x(e,n){let t=`[${n}]`;const o=n==="Warning"?"yellow":"red";return t=f.bold(f[o](t)),`${t}${e}`}function m(e){return e.startsWith("[")?e:` ${e}`}function b(e,n=!1){return`${n?re:oe}${e}`}function W(e){const n=e/1e3;if(n<120){const t=R(n);return`${t} second${A(t)}`}{const t=n/60,o=R(t);return`${o} minute${A(o)}`}}function R(e){let n=e.toFixed(1);return n.endsWith(".0")&&(n=n.slice(0,-2)),n}function A(e){return e==="1"?"":"s"}function ae(e){return e instanceof Function||typeof e=="function"}function F(e){return Array.isArray(e)}function Te(e,n){const t=n.find(o=>o.pageId===e);return u(n.length>0),u(t),t}function ue(e){if(!e||F(e)||e.definedBy)return null;const{filePathToShowToUser:n}=e;return u(n),n}function z(e){const n=ue(e);return u(n),n}const le=S("hooks/getHook.ts",{});function Se(e,n){if(!(n in e.exports))return null;const{hooksTimeout:t}=e.config,o=D(t,n),r=e.exports[n];if(r===null)return null;const i=e.exportsAll[n][0];u(i.exportValue===r);const s=i.filePath;return u(s),E(r,n,s,o)}function fe(e,n){var i;const{hooksTimeout:t}=n.config,o=D(t,e),r=[];return(i=n.exportsAll[e])==null||i.forEach(s=>{const c=s.exportValue;if(c===null)return;const l=s.filePath;u(l),r.push(E(c,e,l,o))}),r}function ve(e,n){const t=e.configValues[n];if(!(t!=null&&t.value))return null;const{hookFn:o,hookFilePath:r}=ge(t),i=q(n);return E(o,n,r,i)}function de(e,n){const t=e.configValues[n];if(!(t!=null&&t.value))return[];const o=t.value;return u(F(o)),o.map((r,i)=>{const s=r,c=q(n);u(F(t.definedAtData));const l=z(t.definedAtData[i]);return E(s,n,l,c)})}function q(e){return J(e)}function E(e,n,t,o){return u(t),he(e,{hookName:n,hookFilePath:t}),{hookFn:e,hookName:n,hookFilePath:t,hookTimeout:o}}function ge(e){const n=e.value;u(n);const t=z(e.definedAtData);return{hookFn:n,hookFilePath:t}}function he(e,{hookName:n,hookFilePath:t}){u(n&&t),u(!n.endsWith(")")),u(!t.endsWith(" ")),y(ae(e),`Hook ${n}() defined by ${t} should be a function`)}function D(e,n){const t=ke(e);if(t===!1)return{error:!1,warning:!1};const o=t[n],r=J(n);return(o==null?void 0:o.error)!==void 0&&(r.error=o.error),(o==null?void 0:o.warning)!==void 0&&(r.warning=o.warning),r}function ke(e){if(e===void 0)return{};if(e===!1)return!1;y(H(e),`Setting ${f.cyan("hooksTimeout")} should be ${f.cyan("false")} or an object`);const n={};return Object.entries(e).forEach(([t,o])=>{if(o===!1){n[t]={error:!1,warning:!1};return}y(H(o),`Setting ${f.cyan(`hooksTimeout.${t}`)} should be ${f.cyan("false")} or an object`);const[r,i]=["error","warning"].map(s=>{const c=o[s];if(c===void 0||c===!1)return c;const l=`Setting ${f.cyan(`hooksTimeout.${t}.${s}`)} should be`;return y(typeof c=="number",`${l} ${f.cyan("false")} or a number`),y(c>0,`${l} a positive number`),c});n[t]={error:r,warning:i}}),n}function J(e){return e==="onBeforeRoute"?{error:5*1e3,warning:1*1e3}:le.isPrerendering?{error:2*60*1e3,warning:30*1e3}:(u(!e.toLowerCase().includes("prerender")),{error:30*1e3,warning:4*1e3})}const L=S("utils/execHook.ts",{userHookErrors:new WeakMap,pageContext:null});async function $e(e,n,t){const o=await K([e],n,t);if("err"in o)throw o.err;const{hookReturn:r}=o.hooks[0];y(r===void 0,`The ${e.hookName}() hook defined by ${e.hookFilePath} isn't allowed to return a value`)}async function Pe(e,n,t){const o=await we(e,n,t);if("err"in o)throw o.err;return o.hooks}async function we(e,n,t){const o=fe(e,n);return K(o,n,t)}async function K(e,n,t){if(!e.length)return{hooks:[]};const o=t(n);let r,i;try{r=await Promise.all(e.map(async s=>{const c=await Y(()=>s.hookFn(o),s,o);return{...s,hookReturn:c}}))}catch(s){i=s}return r?{hooks:r}:{hooks:e,err:i}}async function xe(e,n,t,o,r){const i=de(n,e),s=r(o);await Promise.all(i.map(async c=>{await Y(()=>c.hookFn(s),c,t)}))}function Y(e,n,t){const{hookName:o,hookFilePath:r,hookTimeout:{error:i,warning:s}}=n;let c,l;const d=new Promise((h,j)=>{c=C=>{k(),h(C)},l=C=>{k(),j(C)}}),k=()=>{w&&clearTimeout(w),g&&clearTimeout(g)},w=_(s)&&setTimeout(()=>{ce(!1,`The ${o}() hook defined by ${r} is slow: it's taking more than ${W(s)} (https://vike.dev/hooksTimeout)`,{onlyOnce:!1})},s),g=_(i)&&setTimeout(()=>{const h=se(`The ${o}() hook defined by ${r} timed out: it didn't finish after ${W(i)} (https://vike.dev/hooksTimeout)`);l(h)},i);return(async()=>{try{O(t);const h=await e();c(h)}catch(h){H(h)&&L.userHookErrors.set(h,{hookName:o,hookFilePath:r}),l(h)}})(),d}function Ee(e,n,t){const o=t(n);return O(o),{hookReturn:e.hookFn(o)}}function _(e){return!!e&&e!==1/0}function je(e){O(e)}function O(e){L.pageContext=e,Promise.resolve().then(()=>{L.pageContext=null})}const ye="modulepreload",pe=function(e){return"/"+e},I={},Ce=function(n,t,o){let r=Promise.resolve();if(t&&t.length>0){let s=function(d){return Promise.all(d.map(k=>Promise.resolve(k).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),l=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));r=s(t.map(d=>{if(d=pe(d),d in I)return;I[d]=!0;const k=d.endsWith(".css"),w=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${w}`))return;const g=document.createElement("link");if(g.rel=k?"stylesheet":ye,k||(g.as="script"),g.crossOrigin="",g.href=d,l&&g.setAttribute("nonce",l),document.head.appendChild(g),k)return new Promise((h,j)=>{g.addEventListener("load",h),g.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(s){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s}return r.then(s=>{for(const c of s||[])c.status==="rejected"&&i(c.reason);return n().catch(i)})};export{Ce as _,f as a,u as b,y as c,H as d,ae as e,ce as f,S as g,Se as h,F as i,$e as j,J as k,se as l,Te as m,Pe as n,xe as o,je as p,ue as q,Ee as r,ve as s,be as t,Q as u,fe as v,K as w,we as x,me as y};
