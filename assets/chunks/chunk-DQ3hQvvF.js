function A(t){return Array.from(new Set(t))}function L(t,e){const n=N();return n[t]=n[t]||e}function N(){const t="_vike";return globalThis[t]=globalThis[t]||{}}const g=new Proxy({},{get:(t,e)=>n=>e==="code"?`\`${n}\``:e==="string"?`'${n}'`:n}),R="0.4.229";let k;k??(k=_());function _(){return L("utils/assertSingleInstance.ts",{instances:[],alreadyLogged:new Set})}function w(){return k??(k=_()),k}const G="Client runtime of both Server Routing and Client Routing loaded https://vike.dev/client-runtimes-conflict",B="Client runtime loaded twice https://vike.dev/client-runtime-duplicated";function I(){const t=w();{const e=A(t.instances);b(e.length<=1,`vike@${g.bold(e[0])} and vike@${g.bold(e[1])} loaded which is highly discouraged, see ${g.underline("https://vike.dev/warning/version-mismatch")}`,{onlyOnce:!0,showStackTrace:!1})}t.checkSingleInstance&&t.instances.length>1&&b(!1,B,{onlyOnce:!0,showStackTrace:!0})}function ee(t){const e=w();b(e.isClientRouting!==!1,G,{onlyOnce:!0,showStackTrace:!0}),b(e.isClientRouting===void 0,B,{onlyOnce:!0,showStackTrace:!0}),e.isClientRouting=!0,e.checkSingleInstance=!0,I()}function U(){w().instances.push(R),I()}function b(t,e,{onlyOnce:n,showStackTrace:i}){const r=w();if(t)return;const o=`[Vike][Warning] ${e}`;{const{alreadyLogged:a}=r,s=o;if(a.has(s))return;a.add(s)}console.warn(i?new Error(o):o)}function V(){return!(typeof process>"u"||!process.cwd||!process.versions||typeof process.versions.node>"u"||!process.release||process.release.name!=="node")}function v(t,e){const n=new Error(t);return V()&&(n.stack=H(n.stack,e)),n}function H(t,e){if(!t)return t;const n=J(t);let i=0;return n.filter(o=>o.includes(" (internal/")||o.includes(" (node:internal")?!1:i<e&&q(o)?(i++,!1):!0).join(`
`)}function q(t){return t.startsWith("    at ")}function J(t){return t.split(/\r?\n/)}function z(t){return typeof t=="object"&&t!==null}const c=L("utils/assert.ts",{alreadyLogged:new Set,logger(t,e){e==="info"?console.log(t):console.warn(t)},showStackTraceList:new WeakSet});U();const D="[vike]",F=`[vike@${R}]`,K="Bug",S=2;function te(t,e){var a;if(t)return;const n=(()=>{if(!e)return null;const s=typeof e=="string"?e:JSON.stringify(e);return g.dim(`Debug info (for Vike maintainers; you can ignore this): ${s}`)})();let r=[`You stumbled upon a Vike bug. Go to ${g.underline("https://github.com/vikejs/vike/issues/new?template=bug.yml")} and copy-paste this error. A maintainer will fix the bug (usually within 24 hours).`,n].filter(Boolean).join(" ");r=m(r),r=T(r,K),r=y(r,!0);const o=v(r,S);throw(a=c.onBeforeLog)==null||a.call(c),o}function ne(t,e,{showStackTrace:n,exitOnError:i}={}){var o;if(t)return;n=n||c.alwaysShowStackTrace,e=m(e),e=T(e,"Wrong Usage"),e=y(e);const r=v(e,S);if(n&&c.showStackTraceList.add(r),(o=c.onBeforeLog)==null||o.call(c),i)console.error(n?r:e),process.exit(1);else throw r}function Y(t){return t=m(t),t=T(t,"Error"),t=y(t),v(t,S)}function Q(t,e,{onlyOnce:n,showStackTrace:i}){var r;if(!t){if(i=i||c.alwaysShowStackTrace,e=m(e),e=T(e,"Warning"),e=y(e),n){const{alreadyLogged:o}=c,a=n===!0?e:n;if(o.has(a))return;o.add(a)}if((r=c.onBeforeLog)==null||r.call(c),i){const o=v(e,S);c.showStackTraceList.add(o),c.logger(o,"warn")}else c.logger(e,"warn")}}function oe(t,e,{onlyOnce:n}){var i;e=m(e),e=y(e);{const{alreadyLogged:r}=c,o=e;if(r.has(o))return;r.add(o)}(i=c.onBeforeLog)==null||i.call(c),c.logger(e,"info")}function T(t,e){let n=`[${e}]`;const i=e==="Warning"?"yellow":"red";return n=g.bold(g[i](n)),`${n}${t}`}function m(t){return t.startsWith("[")?t:` ${t}`}function y(t,e=!1){return`${e?F:D}${t}`}function C(t){const e=t/1e3;if(e<120){const n=O(e);return`${n} second${P(n)}`}{const n=e/60,i=O(n);return`${i} minute${P(i)}`}}function O(t){let e=t.toFixed(1);return e.endsWith(".0")&&(e=e.slice(0,-2)),e}function P(t){return t==="1"?"":"s"}const $=L("utils/executeHook.ts",{userHookErrors:new WeakMap,pageContext:null});function re(t,e,n){const{hookName:i,hookFilePath:r,hookTimeout:{error:o,warning:a}}=e;let s,p;const l=new Promise((f,E)=>{s=j=>{d(),f(j)},p=j=>{d(),E(j)}}),d=()=>{h&&clearTimeout(h),u&&clearTimeout(u)},h=W(a)&&setTimeout(()=>{Q(!1,`The ${i}() hook defined by ${r} is slow: it's taking more than ${C(a)} (https://vike.dev/hooksTimeout)`,{onlyOnce:!1})},a),u=W(o)&&setTimeout(()=>{const f=Y(`The ${i}() hook defined by ${r} timed out: it didn't finish after ${C(o)} (https://vike.dev/hooksTimeout)`);p(f)},o);return(async()=>{try{X(n);const f=await t();s(f)}catch(f){z(f)&&$.userHookErrors.set(f,{hookName:i,hookFilePath:r}),p(f)}})(),l}function W(t){return!!t&&t!==1/0}function X(t){$.pageContext=t,Promise.resolve().then(()=>{$.pageContext=null})}const Z="modulepreload",M=function(t){return"/"+t},x={},ie=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){let a=function(l){return Promise.all(l.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),p=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=a(n.map(l=>{if(l=M(l),l in x)return;x[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":Z,d||(u.as="script"),u.crossOrigin="",u.href=l,p&&u.setAttribute("nonce",p),document.head.appendChild(u),d)return new Promise((f,E)=>{u.addEventListener("load",f),u.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return r.then(a=>{for(const s of a||[])s.status==="rejected"&&o(s.reason);return e().catch(o)})};export{ie as _,g as a,ne as b,Q as c,te as d,re as e,Y as f,L as g,oe as h,z as i,ee as j,X as p,A as u};
