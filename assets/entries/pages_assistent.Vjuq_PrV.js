import{J as Z,K as ee,M as te,N as se,O as ae,P as ne,r as p,j as e,Q as V,S as t,R as M,T as oe,U as re,V as ie,X as le,Y as ce,Z as de,_ as ue,$ as R,a0 as _,a1 as me,a2 as W,a3 as pe,a4 as he,a5 as fe,a6 as ge,a7 as ye,a8 as I,a9 as xe,aa as be,ab as ve,ac as Se,ad as je,ae as Ce,af as Te,ag as we,ah as Ae,ai as Ne,aj as Ee,ak as Be,al as Pe,am as ke,an as Le,ao as Me,ap as Ue,aq as ze,ar as De,as as $e,at as Fe,au as L,av as H,aw as q,ax as Re,ay as _e,az as We,aA as Ie,aB as He,aC as qe,aD as Oe,F as Ve,a as Ke,W as Ge,d as Je,e as Ye,f as Qe,o as Xe}from"../chunks/chunk-Bb_NzOU8.js";import{A as Ze,g as et,a as tt,b as st,u as at,c as nt,d as ot}from"../chunks/chunk-Co4kmlCr.js";import{p as rt}from"../chunks/chunk-CRVUSFRq.js";import"../chunks/chunk-CT5atk_u.js";/* empty css                      *//* empty css                      *//* empty css                      */async function it(a,{account:o=a.account,message:s}){if(!o)throw new Ze({docsPath:"/docs/actions/wallet/signMessage"});const r=Z(o);if(r.signMessage)return r.signMessage({message:s});const m=typeof s=="string"?ee(s):s.raw instanceof Uint8Array?te(s.raw):s.raw;return a.request({method:"personal_sign",params:[m,r.address]},{retryCount:0})}async function lt(a,o){const{account:s,connector:r,...m}=o;let h;return typeof s=="object"&&s.type==="local"?h=a.getClient():h=await et(a,{account:s,connector:r}),se(h,it,"signMessage")({...m,...s?{account:s}:{}})}function ct(a){return{mutationFn(o){return lt(a,o)},mutationKey:["signMessage"]}}function dt(a={}){const{mutation:o}=a,s=ae(a),r=ct(s),{mutate:m,mutateAsync:h,...l}=ne({...o,...r});return{...l,signMessage:m,signMessageAsync:h}}function ut({address:a,isOpen:o,onClose:s}){const[r,m]=p.useState([]),[h,l]=p.useState(!1),g=async()=>{if(a){l(!0);try{const c=await(await fetch(`https://mypersonaljscloudivnad9dy-leafhistory.functions.fnc.fr-par.scw.cloud?address=${a}`)).json();m(c.leaves||[])}catch(i){console.error("Failed to fetch leaf history:",i)}finally{l(!1)}}};return p.useEffect(()=>{o&&a&&g()},[o,a]),o?e.jsxs("div",{style:{position:"fixed",right:0,top:0,height:"100vh",width:"300px",backgroundColor:"white",borderLeft:"1px solid #ddd",padding:"1rem",overflowY:"auto",zIndex:1e3},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"📊 Request History"}),e.jsx("button",{onClick:s,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer"},children:"✕"})]}),h?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1rem",fontSize:"0.9rem",color:"#666"},children:["Total: ",r.length," requests"]}),r.length===0?e.jsx("div",{style:{textAlign:"center",color:"#999",marginTop:"2rem"},children:"No requests found"}):r.slice(0,10).map(i=>{const c=(v=>v?{backgroundColor:"#e8f5e8",borderColor:"#4caf50",borderLeftColor:"#4caf50",borderLeftWidth:"4px",icon:"✓",text:"Validated",textColor:"#2e7d32"}:{backgroundColor:"#fff3e0",borderColor:"#ff9800",borderLeftColor:"#ff9800",borderLeftWidth:"4px",icon:"⏳",text:"Unprocessed",textColor:"#ef6c00"})(i.processed);return e.jsxs("div",{style:{padding:"0.75rem",marginBottom:"0.5rem",border:`1px solid ${c.borderColor}`,borderLeft:`${c.borderLeftWidth} solid ${c.borderLeftColor}`,borderRadius:"4px",fontSize:"0.8rem",backgroundColor:c.backgroundColor},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e.jsxs("span",{style:{color:c.textColor,fontWeight:"bold"},children:[c.icon," ",c.text]}),e.jsxs("span",{style:{fontSize:"0.7rem",color:"#666",marginLeft:"auto"},children:[new Date(i.timestamp).toLocaleDateString()," ",new Date(i.timestamp).toLocaleTimeString()]})]}),e.jsxs("div",{style:{marginBottom:"0.25rem",color:"#333"},children:["Tokens: ",i.tokenCount]}),e.jsxs("div",{style:{marginBottom:"0.25rem",color:"#333"},children:["Cost: ",V(BigInt(i.cost))," ETH"]}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"#666"},children:["Tree ",i.treeIndex,", Leaf ",i.id]})]},`${i.treeIndex}-${i.id}`)}),r.length>10&&e.jsxs("div",{style:{textAlign:"center",marginTop:"1rem",fontSize:"0.8rem",color:"#666"},children:["Showing first 10 of ",r.length," requests"]})]})]}):null}function O({address:a,onRefetchBalance:o}){const s=tt(),r=st(),m=t({label:"assistent.invalidAmount"}),h=t({label:"assistent.invalidAmountFormat"}),{data:l,refetch:g}=at({...s,functionName:"checkBalance",args:a?[a]:void 0,...r?.id&&{chainId:r.id}}),{writeContract:i,data:b}=nt(),{isLoading:c,isSuccess:v}=ot({hash:b}),[N,y]=p.useState(!1),[w,E]=p.useState("0.01"),[S,f]=p.useState(""),x=()=>S.trim()||w,B=async()=>{if(a)try{const d=x(),u=rt(d);if(!u||u<=0n){alert(m);return}i({...s,functionName:"depositForLLM",value:u,...r?.id&&{chainId:r.id}}),y(!1)}catch(d){console.error("Top-up failed",d),alert(h)}};M.useEffect(()=>{v&&g()},[v,g]),M.useEffect(()=>{o&&o(g)},[g,o]);const A=d=>{const u=parseFloat(V(d));return u===0?"0":u>=1?u.toFixed(3):u>=.1?u.toFixed(4):u>=.001?u.toFixed(5):u.toFixed(6)};return a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:Me,children:[e.jsxs("span",{className:Ue,children:[l?A(l):"0"," ETH"]}),e.jsx("button",{onClick:()=>y(!0),disabled:c,className:ze,children:t({label:"assistent.topUp"})})]}),N&&e.jsx("div",{className:De,onClick:()=>y(!1),children:e.jsxs("div",{className:$e,onClick:d=>d.stopPropagation(),children:[e.jsx("h3",{className:Fe,children:t({label:"assistent.topUpBalance"})}),e.jsx("div",{className:L,children:e.jsxs("div",{className:H,children:[t({label:"assistent.currentBalance"})," ",l?A(l):"0"," ","ETH"]})}),e.jsxs("div",{className:L,children:[e.jsx("div",{className:q,children:t({label:"assistent.quickAmounts"})}),e.jsx("div",{className:Re,children:["0.001","0.005","0.01"].map(d=>e.jsxs("button",{onClick:()=>{E(d),f("")},className:`${_e} ${w===d&&!S?We:""}`,children:[d," ETH"]},d))})]}),e.jsxs("div",{className:L,children:[e.jsx("div",{className:q,children:t({label:"assistent.customAmount"})}),e.jsx("input",{type:"text",value:S,onChange:d=>f(d.target.value),placeholder:"0.0",className:Ie}),e.jsx("div",{className:H,children:t({label:"assistent.amountHint"})})]}),e.jsxs("div",{className:He,children:[e.jsx("button",{onClick:()=>y(!1),className:qe,children:t({label:"assistent.cancel"})}),e.jsx("button",{onClick:B,disabled:c||!S&&!w,className:Oe,children:c?t({label:"assistent.processing"}):t({label:"assistent.topUpAmount"}).replace("{amount}",x())})]})]})})]}):null}function mt(){const[a,o]=p.useState([]),[s,r]=p.useState(""),[m,h]=p.useState(!1),[l,g]=p.useState(!1),[i,b]=p.useState(null),[c,v]=p.useState(null),[N,y]=p.useState(!1),w=t({label:"assistent.systemPrompt"}),E=t({label:"assistent.noResponse"}),S=t({label:"assistent.errorPrefix"});M.useEffect(()=>{const n=()=>{h(window.innerWidth<=768)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const{address:f,isConnected:x}=oe(),{signMessageAsync:B}=dt(),{connectors:A,connect:d}=re(),u=()=>{A.length>0&&d({connector:A[0]})},K=()=>x?l?"loading":s.trim()?"ready":"empty":"connect",G=n=>{switch(n){case"connect":return t({label:"assistent.connectWalletMessage"});case"loading":return t({label:"assistent.sending"});case"empty":return t({label:"assistent.send"});case"ready":return t({label:"assistent.send"});default:return t({label:"assistent.send"})}},U=K(),z=n=>{v(()=>n)},J=async()=>{if(!f||!x)throw new Error("Wallet not connected");if(i)return i;const n=`Authenticate wallet: ${f}`,j=await B({message:n});return b(j),j},D=async n=>{if(!n.trim()||l)return;g(!0);const j={role:"user",content:n.trim(),timestamp:Date.now()};o(C=>[...C,j]),r("");try{const C=await J(),P=[{role:"system",content:w},...a.map(T=>({role:T.role,content:T.content})),{role:"user",content:n.trim()}],k=await fetch("https://mypersonaljscloudivnad9dy-llm.functions.fnc.fr-par.scw.cloud",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({auth:{address:f,signature:C,message:`Authenticate wallet: ${f}`},data:{prompt:P}})});if(!k.ok){const T=await k.json();throw new Error(T.error||"Failed to get response")}const X={role:"assistant",content:(await k.json()).content||E,timestamp:Date.now()};o(T=>[...T,X]),c&&c()}catch(C){const P={role:"assistant",content:`${S} ${C instanceof Error?C.message:t({label:"assistent.unknownError"})}`,timestamp:Date.now()};o(F=>[...F,P])}finally{g(!1)}},$=()=>{o([]),b(null)},Y=n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),x&&D(s))},Q=()=>{if(!x){u();return}D(s)};return e.jsxs("div",{className:ie,children:[e.jsxs("div",{className:`${le} ${m?ce:de}`,children:[!m&&e.jsxs("div",{className:ue,children:[e.jsxs("div",{className:R,children:[e.jsx("h4",{className:_,children:t({label:"assistent.balance"})}),e.jsx(O,{address:f,onRefetchBalance:z})]}),e.jsxs("div",{className:R,children:[e.jsx("h4",{className:_,children:t({label:"assistent.actions"})}),e.jsxs("div",{className:me,children:[e.jsx("button",{onClick:()=>y(!0),className:W,title:"View request history",children:t({label:"assistent.history"})}),e.jsx("button",{onClick:$,className:`${W} ${pe}`,children:t({label:"assistent.clearChat"})})]})]})]}),e.jsxs("div",{className:he,children:[m&&e.jsxs("div",{className:fe,children:[e.jsx("h2",{className:ge,children:t({label:"assistent.mobileTitle"})}),e.jsxs("div",{className:ye,children:[e.jsx(O,{address:f,onRefetchBalance:z}),e.jsx("button",{onClick:()=>y(!0),className:I,title:"History",children:"📜"}),e.jsx("button",{onClick:$,className:I,title:"Clear Chat",children:"🗑️"})]})]}),e.jsxs("div",{className:xe,children:[a.length===0?e.jsx("div",{className:be,children:t({label:"assistent.emptyState"})}):a.map((n,j)=>e.jsx("div",{className:`${ve} ${n.role==="user"?Se:je}`,children:e.jsxs("div",{className:`${Ce} ${n.role==="user"?Te:we}`,children:[e.jsx("div",{className:Ae,children:n.role==="user"?t({label:"assistent.you"}):t({label:"assistent.assistant"})}),e.jsx("div",{className:Ne,children:n.content})]})},j)),l&&e.jsx("div",{className:Ee,children:e.jsx("div",{className:Be,children:t({label:"assistent.typing"})})})]}),e.jsxs("div",{className:Pe,children:[e.jsx("textarea",{value:s,onChange:n=>r(n.target.value),onKeyPress:Y,placeholder:t({label:"assistent.placeholder"}),disabled:l,className:ke}),e.jsxs("button",{onClick:Q,disabled:l||(x?!s.trim():!1),className:Le,children:[U==="connect"?"🔗 ":"",G(U)]})]})]})]}),e.jsx(ut,{address:f,isOpen:N,onClose:()=>y(!1)})]})}const pt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"})),jt={serverOnlyHooks:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!1}},isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:Xe}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Qe}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Ye}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/assistent/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:pt}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:Je}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:Ge}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:Ke}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:Ve}}};export{jt as configValuesSerialized};
