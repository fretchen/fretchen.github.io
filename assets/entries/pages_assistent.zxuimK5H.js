import{J as ce,K as de,M as ue,N as me,O as pe,P as he,r as c,j as e,Q as ee,S as t,R as te,T as fe,U as ge,V as be,X as ye,Y as xe,Z as ve,_ as Se,$ as V,a0 as K,a1 as je,a2 as G,a3 as Ce,a4 as Te,a5 as we,a6 as Le,a7 as Ae,a8 as J,a9 as Ne,aa as Ee,ab as ke,ac as Be,ad as Pe,ae as Me,af as Ue,ag as ze,ah as De,ai as $e,aj as Fe,ak as _e,al as Re,am as We,an as He,ao as Ie,ap as qe,aq as Oe,ar as Ve,as as Ke,at as Ge,au as R,av as Y,aw as Q,ax as Je,ay as Ye,az as Qe,aA as Xe,aB as Ze,aC as et,aD as tt,F as st,a as at,W as nt,d as ot,e as rt,f as it,o as lt}from"../chunks/chunk-CZNPNpaT.js";import{A as ct,g as dt,u as ut,a as mt,l as X,b as pt,c as ht}from"../chunks/chunk-CUH142gR.js";import{p as ft}from"../chunks/chunk-C0oRS4J6.js";import"../chunks/chunk-CT5atk_u.js";/* empty css                      *//* empty css                      *//* empty css                      */async function gt(s,{account:n=s.account,message:a}){if(!n)throw new ct({docsPath:"/docs/actions/wallet/signMessage"});const i=ce(n);if(i.signMessage)return i.signMessage({message:a});const m=typeof a=="string"?de(a):a.raw instanceof Uint8Array?ue(a.raw):a.raw;return s.request({method:"personal_sign",params:[m,i.address]},{retryCount:0})}async function bt(s,n){const{account:a,connector:i,...m}=n;let h;return typeof a=="object"&&a.type==="local"?h=s.getClient():h=await dt(s,{account:a,connector:i}),me(h,gt,"signMessage")({...m,...a?{account:a}:{}})}function yt(s){return{mutationFn(n){return bt(s,n)},mutationKey:["signMessage"]}}function xt(s={}){const{mutation:n}=s,a=pe(s),i=yt(a),{mutate:m,mutateAsync:h,...d}=he({...n,...i});return{...d,signMessage:m,signMessageAsync:h}}function vt({address:s,isOpen:n,onClose:a}){const[i,m]=c.useState([]),[h,d]=c.useState(!1),y=c.useCallback(async()=>{if(s){d(!0);try{const p=await(await fetch(`https://mypersonaljscloudivnad9dy-leafhistory.functions.fnc.fr-par.scw.cloud?address=${s}`)).json();m(p.leaves||[])}catch(l){console.error("Failed to fetch leaf history:",l)}finally{d(!1)}}},[s]);return c.useEffect(()=>{n&&s&&y()},[n,s,y]),n?e.jsxs("div",{style:{position:"fixed",right:0,top:0,height:"100vh",width:"300px",backgroundColor:"white",borderLeft:"1px solid #ddd",padding:"1rem",overflowY:"auto",zIndex:1e3},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"📊 Request History"}),e.jsx("button",{onClick:a,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer"},children:"✕"})]}),h?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1rem",fontSize:"0.9rem",color:"#666"},children:["Total: ",i.length," requests"]}),i.length===0?e.jsx("div",{style:{textAlign:"center",color:"#999",marginTop:"2rem"},children:"No requests found"}):i.slice(0,10).map(l=>{const p=(g=>g?{backgroundColor:"#e8f5e8",borderColor:"#4caf50",borderLeftColor:"#4caf50",borderLeftWidth:"4px",icon:"✓",text:"Validated",textColor:"#2e7d32"}:{backgroundColor:"#fff3e0",borderColor:"#ff9800",borderLeftColor:"#ff9800",borderLeftWidth:"4px",icon:"⏳",text:"Unprocessed",textColor:"#ef6c00"})(l.processed);return e.jsxs("div",{style:{padding:"0.75rem",marginBottom:"0.5rem",border:`1px solid ${p.borderColor}`,borderLeft:`${p.borderLeftWidth} solid ${p.borderLeftColor}`,borderRadius:"4px",fontSize:"0.8rem",backgroundColor:p.backgroundColor},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e.jsxs("span",{style:{color:p.textColor,fontWeight:"bold"},children:[p.icon," ",p.text]}),e.jsxs("span",{style:{fontSize:"0.7rem",color:"#666",marginLeft:"auto"},children:[new Date(l.timestamp).toLocaleDateString()," ",new Date(l.timestamp).toLocaleTimeString()]})]}),e.jsxs("div",{style:{marginBottom:"0.25rem",color:"#333"},children:["Tokens: ",l.tokenCount]}),e.jsxs("div",{style:{marginBottom:"0.25rem",color:"#333"},children:["Cost: ",ee(BigInt(l.cost))," ETH"]}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"#666"},children:["Tree ",l.treeIndex,", Leaf ",l.id]})]},`${l.treeIndex}-${l.id}`)}),i.length>10&&e.jsxs("div",{style:{textAlign:"center",marginTop:"1rem",fontSize:"0.8rem",color:"#666"},children:["Showing first 10 of ",i.length," requests"]})]})]}):null}function Z({address:s}){const n=mt(),a=t({label:"assistent.invalidAmount"}),i=t({label:"assistent.invalidAmountFormat"}),m=t({label:"assistent.topUp"}),h=t({label:"assistent.topUpBalance"}),d=t({label:"assistent.currentBalance"}),y=t({label:"assistent.quickAmounts"}),l=t({label:"assistent.customAmount"}),v=t({label:"assistent.amountHint"}),p=t({label:"assistent.cancel"}),g=t({label:"assistent.processing"}),N=t({label:"assistent.topUpAmount"}),{data:S,refetch:E}=ut({...X,functionName:"checkBalance",args:s?[s]:void 0,...n?.id&&{chainId:n.id}}),{writeContract:P,data:M}=pt(),{isLoading:b,isSuccess:k}=ht({hash:M}),[U,j]=c.useState(!1),[C,z]=c.useState("0.01"),[x,B]=c.useState(""),A=c.useMemo(()=>x.trim()||C,[x,C]),D=c.useMemo(()=>b?g:N.replace("{amount}",A),[b,g,N,A]),$=async()=>{if(s)try{const u=ft(A);if(!u||u<=0n){alert(a);return}P({...X,functionName:"depositForLLM",value:u,...n?.id&&{chainId:n.id}}),j(!1)}catch(r){console.error("Top-up failed",r),alert(i)}};te.useEffect(()=>{k&&E()},[k,E]);const f=r=>{const u=parseFloat(ee(r));return u===0?"0":u>=1?u.toFixed(3):u>=.1?u.toFixed(4):u>=.001?u.toFixed(5):u.toFixed(6)};return s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:Ie,children:[e.jsxs("span",{className:qe,children:[S?f(S):"0"," ETH"]}),e.jsx("button",{onClick:()=>j(!0),disabled:b,className:Oe,children:m})]}),U&&e.jsx("div",{className:Ve,onClick:()=>j(!1),children:e.jsxs("div",{className:Ke,onClick:r=>r.stopPropagation(),children:[e.jsx("h3",{className:Ge,children:h}),e.jsx("div",{className:R,children:e.jsxs("div",{className:Y,children:[d," ",S?f(S):"0"," ETH"]})}),e.jsxs("div",{className:R,children:[e.jsx("div",{className:Q,children:y}),e.jsx("div",{className:Je,children:["0.001","0.005","0.01"].map(r=>e.jsxs("button",{onClick:()=>{z(r),B("")},className:`${Ye} ${C===r&&!x?Qe:""}`,children:[r," ETH"]},r))})]}),e.jsxs("div",{className:R,children:[e.jsx("div",{className:Q,children:l}),e.jsx("input",{type:"text",value:x,onChange:r=>B(r.target.value),placeholder:"0.0",className:Xe}),e.jsx("div",{className:Y,children:v})]}),e.jsxs("div",{className:Ze,children:[e.jsx("button",{onClick:()=>j(!1),className:et,children:p}),e.jsx("button",{onClick:$,disabled:b||!x&&!C,className:tt,children:D})]})]})})]}):null}function St(){const[s,n]=c.useState([]),[a,i]=c.useState(""),[m,h]=c.useState(!1),[d,y]=c.useState(!1),[l,v]=c.useState(null),[p,g]=c.useState(!1),N=t({label:"assistent.systemPrompt"}),S=t({label:"assistent.noResponse"}),E=t({label:"assistent.errorPrefix"}),P=t({label:"assistent.connectWalletMessage"}),M=t({label:"assistent.loading"}),b=t({label:"assistent.send"}),k=t({label:"assistent.unknownError"}),U=t({label:"assistent.balance"}),j=t({label:"assistent.typing"}),C=t({label:"assistent.actions"}),z=t({label:"assistent.history"}),x=t({label:"assistent.clearChat"}),B=t({label:"assistent.mobileTitle"}),A=t({label:"assistent.emptyState"}),D=t({label:"assistent.you"}),$=t({label:"assistent.assistant"});te.useEffect(()=>{const o=()=>{h(window.innerWidth<=768)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const{address:f,isConnected:r}=fe(),{signMessageAsync:u}=xt(),{connectors:W,connect:se}=ge(),ae=()=>{W.length>0&&se({connector:W[0]})},H=c.useMemo(()=>r?d?"loading":a.trim()?"ready":"empty":"connect",[r,d,a]),ne=o=>{switch(o){case"connect":return P;case"loading":return M;case"empty":return b;case"ready":return b;default:return b}},oe=async()=>{if(!f||!r)throw new Error("Wallet not connected");if(l)return l;const o=`Authenticate wallet: ${f}`,T=await u({message:o});return v(T),T},I=async o=>{if(!o.trim()||d)return;y(!0);const T={role:"user",content:o.trim(),timestamp:Date.now()};n(w=>[...w,T]),i("");try{const w=await oe(),F=[{role:"system",content:N},...s.map(L=>({role:L.role,content:L.content})),{role:"user",content:o.trim()}],_=await fetch("https://mypersonaljscloudivnad9dy-llm.functions.fnc.fr-par.scw.cloud",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({auth:{address:f,signature:w,message:`Authenticate wallet: ${f}`},data:{prompt:F}})});if(!_.ok){const L=await _.json();throw new Error(L.error||"Failed to get response")}const le={role:"assistant",content:(await _.json()).content||S,timestamp:Date.now()};n(L=>[...L,le])}catch(w){const F={role:"assistant",content:`${E} ${w instanceof Error?w.message:k}`,timestamp:Date.now()};n(O=>[...O,F])}finally{y(!1)}},q=()=>{n([]),v(null)},re=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),r&&I(a))},ie=()=>{if(!r){ae();return}I(a)};return e.jsxs("div",{className:be,children:[e.jsxs("div",{className:`${ye} ${m?xe:ve}`,children:[!m&&e.jsxs("div",{className:Se,children:[e.jsxs("div",{className:V,children:[e.jsx("h4",{className:K,children:U}),e.jsx(Z,{address:f})]}),e.jsxs("div",{className:V,children:[e.jsx("h4",{className:K,children:C}),e.jsxs("div",{className:je,children:[e.jsx("button",{onClick:()=>g(!0),className:G,title:"View request history",children:z}),e.jsx("button",{onClick:q,className:`${G} ${Ce}`,children:x})]})]})]}),e.jsxs("div",{className:Te,children:[m&&e.jsxs("div",{className:we,children:[e.jsx("h2",{className:Le,children:B}),e.jsxs("div",{className:Ae,children:[e.jsx(Z,{address:f}),e.jsx("button",{onClick:()=>g(!0),className:J,title:"History",children:"📜"}),e.jsx("button",{onClick:q,className:J,title:"Clear Chat",children:"🗑️"})]})]}),e.jsxs("div",{className:Ne,children:[s.length===0?e.jsx("div",{className:Ee,children:A}):s.map((o,T)=>e.jsx("div",{className:`${ke} ${o.role==="user"?Be:Pe}`,children:e.jsxs("div",{className:`${Me} ${o.role==="user"?Ue:ze}`,children:[e.jsx("div",{className:De,children:o.role==="user"?D:$}),e.jsx("div",{className:$e,children:o.content})]})},T)),d&&e.jsx("div",{className:Fe,children:e.jsx("div",{className:_e,children:j})})]}),e.jsxs("div",{className:Re,children:[e.jsx("textarea",{value:a,onChange:o=>i(o.target.value),onKeyPress:re,placeholder:t({label:"assistent.placeholder"}),disabled:d,className:We}),e.jsxs("button",{onClick:ie,disabled:d||(r?!a.trim():!1),className:He,children:[H==="connect"?"🔗 ":"",ne(H)]})]})]})]}),e.jsx(vt,{address:f,isOpen:p,onClose:()=>g(!1)})]})}const jt=Object.freeze(Object.defineProperty({__proto__:null,default:St},Symbol.toStringTag,{value:"Module"})),Bt={serverOnlyHooks:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!1}},isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:lt}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:it}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:rt}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/assistent/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:jt}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:ot}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:nt}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:at}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:st}}};export{Bt as configValuesSerialized};
