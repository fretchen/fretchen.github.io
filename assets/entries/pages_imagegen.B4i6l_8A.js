import{r as i,j as e,E as A,F as z,i as F,W as R,L as _,a as L,b as N,o as G}from"../chunks/chunk-Bh18XQD2.js";import{d as b,b as M,a as $,u as B}from"../chunks/chunk-Z0dFSHj9.js";/* empty css                      */import"../chunks/chunk-DQ3hQvvF.js";/* empty css                      *//* empty css                      */const q=async o=>new Promise((r,c)=>{const t=async()=>{try{const a=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[o]});a?r(a):setTimeout(t,2e3)}catch(a){c(a)}};t()});function W({onGenerate:o}){const[r,c]=i.useState(""),[t,a]=i.useState(!1),[s,l]=i.useState("idle"),[p,u]=i.useState(null),[T,E]=i.useState(void 0),{address:f,isConnected:h}=A(),S=$(),w=b(),{data:d}=M({...w,functionName:"mintPrice",args:[],chainId:S.id});console.log("2. Mint price:",d?d.toString():"Loading...");const v=d?parseFloat(d.toString())/1e18:void 0;console.log("3. Mint price in ETH:",v?v.toString():"Loading...");const{writeContractAsync:C}=B(),U=async()=>{if(!h||!f){u("Please connect your wallet first");return}if(!r.trim()){u("Please enter a prompt");return}if(!d){u("Could not load mint price from contract");return}a(!0),u(null),l("minting");try{const n=`ipfs://tempURI/${Date.now()}`,j=await C({...w,functionName:"safeMint",args:[n],value:d,chainId:S.id});console.log("Minting transaction sent:",j);const x=await q(j),y=x==null?void 0:x.logs.find(I=>I.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!y||y.topics.length<4)throw new Error("Could not extract token ID from transaction");const k=y.topics[3],g=BigInt(k);console.log("Minted token ID:",g),E(g),l("generating");const m=await fetch(`https://mypersonaljscloudivnad9dy-readnft.functions.fnc.fr-par.scw.cloud?prompt=${encodeURIComponent(r)}&tokenId=${g}`);if(!m.ok)throw new Error(`Error: ${m.status} ${m.statusText}`);const P=await m.json();console.log("Image generation completed",P);const D=P.image_url;o(D,g),l("idle")}catch(n){console.error("Error:",n),u(n instanceof Error?n.message:"An unknown error occurred"),l("error")}finally{a(!1)}};return e.jsx("div",{style:{padding:"20px"},children:e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px",flexDirection:"column"},children:[e.jsx("textarea",{value:r,onChange:n=>c(n.target.value),placeholder:"Describe your image...",disabled:t||s!=="idle",style:{padding:"8px",width:"300px",height:"150px",borderRadius:"4px",border:"1px solid #ccc",resize:"vertical",opacity:t||s!=="idle"?.7:1}}),e.jsx("button",{onClick:U,disabled:t||!r.trim()||!h||!f,style:{padding:"8px 16px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:t||!r.trim()||!h||!f?"not-allowed":"pointer",width:"300px",opacity:t||!r.trim()||!h||!f?.7:1},children:t?s==="minting"?"NFT is being minted...":"Image is being generated...":"Mint & Generate"}),!h&&e.jsx("p",{style:{color:"#666"},children:"Connect your wallet to create an NFT"}),p&&e.jsx("p",{style:{color:"red",margin:"10px 0"},children:p}),T&&s==="idle"&&e.jsxs("p",{style:{color:"green"},children:["NFT successfully created! Token ID: ",T.toString()]})]})})}function H({imageUrl:o}){return e.jsx("div",{style:{width:"300px",height:"300px",border:"2px dashed #ccc",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20px"},children:o?e.jsx("img",{src:o,alt:"Generated",style:{maxWidth:"100%",maxHeight:"100%"}}):e.jsx("p",{style:{color:"#666"},children:"Your image will appear here"})})}function V(){const o=b(),[r,c]=i.useState(),[t,a]=i.useState(),s=(l,p)=>{c(l),p&&a(p)};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Decentral AI Image Generator"}),e.jsx("p",{children:"Create your AI image and pay for it with ETH. The process:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Enter a prompt"}),e.jsx("li",{children:'Click on "Mint & Generate"'}),e.jsx("li",{children:"First an NFT is created, then the image is generated"}),e.jsx("li",{children:"Your image shows up after roughly 30s in the placeholder below"})]}),e.jsx(W,{onGenerate:s}),e.jsx(H,{imageUrl:r}),t&&e.jsxs("div",{style:{marginTop:"20px",padding:"15px",border:"1px solid #28a745",borderRadius:"4px"},children:[e.jsx("h3",{children:"ðŸŽ‰ NFT successfully created!"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Token ID:"})," ",t.toString()]}),e.jsx("p",{children:e.jsxs("a",{href:`https://optimistic.etherscan.io/token/${o.address}?a=${t}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"none"},children:[" ","View on Etherscan â†’"]})})]})]})}const O=Object.freeze(Object.defineProperty({__proto__:null,default:V},Symbol.toStringTag,{value:"Module"})),te={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:G}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:N}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:L}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:O}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:_}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:R}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:F}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:z}}};export{te as configValuesSerialized};
