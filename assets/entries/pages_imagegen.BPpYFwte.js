import{r as u,e as W,j as e,f,s as E,g as Q,h as G,n as P,k as B,R as X,l as o,m as _,q as H,t as ee,v as R,c as te,w as ae,F as re,i as ne,W as oe,L as se,a as ie,b as le,o as ce}from"../chunks/chunk-EeCUCye7.js";import{u as V,g as Y,a as O,b as Z,r as M,c as de}from"../chunks/chunk-CAwQi4ep.js";/* empty css                      */import"../chunks/chunk-DQ3hQvvF.js";/* empty css                      *//* empty css                      */const ue=async t=>new Promise((c,n)=>{const l=async()=>{try{const m=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[t]});m?c(m):setTimeout(l,2e3)}catch(m){n(m)}};l()});function me({apiUrl:t="https://mypersonaljscloudivnad9dy-readnftv2.functions.fnc.fr-par.scw.cloud",onSuccess:c,onError:n}){const l=O(),[m,d]=u.useState(),[h,p]=u.useState(),[v,S]=u.useState(""),[k,T]=u.useState("1024x1024"),[j,I]=u.useState(!1),[x,b]=u.useState("idle"),[A,y]=u.useState(null),{address:L,isConnected:s}=W(),r=Y(),{data:i}=V({...l,functionName:"mintPrice",args:[],...(r==null?void 0:r.id)&&{chainId:r.id}}),{writeContractAsync:g}=Z(),$=async()=>{if(!s||!L){const a="Please connect your account first";y(a),n==null||n(a);return}if(!v.trim()){const a="Please enter a prompt";y(a),n==null||n(a);return}if(!i){const a="Could not load creation fee from system";y(a),n==null||n(a);return}I(!0),y(null),b("minting");try{const a=`ipfs://tempURI/${Date.now()}`,w=await g({...l,functionName:"safeMint",args:[a],value:i,...(r==null?void 0:r.id)&&{chainId:r.id}});console.log("Minting transaction sent:",w);const C=await ue(w),D=C==null?void 0:C.logs.find(K=>K.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!D||D.topics.length<4)throw new Error("Could not extract artwork ID from transaction");const q=D.topics[3],U=BigInt(q);console.log("Created artwork ID:",U),p(U),b("generating");const N=await fetch(`${t}?prompt=${encodeURIComponent(v)}&tokenId=${U}&size=${k}`);if(!N.ok)throw new Error(`Error: ${N.status} ${N.statusText}`);const z=await N.json();console.log("Image generation completed",z);const F=z.image_url;d(F),b("idle");const J={name:`AI Generated Artwork #${U}`,description:`AI generated artwork based on the prompt: "${v}"`,image:F,external_url:z.metadata_url||"",attributes:[{trait_type:"Prompt",value:v},{trait_type:"Generation Method",value:"AI Generated"}]};c==null||c(U,F,J),setTimeout(()=>{S(""),T("1024x1024"),d(void 0),p(void 0),y(null)},3e3)}catch(a){console.error("Error:",a);const w=a instanceof Error?a.message:"An unknown error occurred";y(w),b("error"),n==null||n(w)}finally{I(!1)}};return e.jsx("div",{className:f.compactLayout,children:e.jsxs("div",{className:f.compactContainer,children:[e.jsxs("div",{className:f.compactHeader,children:[e.jsx("h3",{className:f.compactTitle,children:"🎨 Create Your Digital Artwork"}),e.jsx("span",{className:f.compactSubtitle,children:"Describe your vision and generate a unique AI artwork for ~10¢. Your creation will be minted as an NFT on the blockchain."})]}),e.jsxs("div",{className:f.compactForm,children:[e.jsx("textarea",{value:v,onChange:a=>S(a.target.value),placeholder:"Describe your image in detail... (e.g., 'A futuristic city skyline at sunset with neon lights reflecting in the water')",disabled:j||x!=="idle",className:f.compactTextarea}),e.jsxs("div",{className:f.compactFormRow,children:[e.jsxs("select",{id:"imageSizeSelect",value:k,onChange:a=>T(a.target.value),disabled:j||x!=="idle",className:f.compactSelect,"aria-label":"Select image format for your artwork",children:[e.jsx("option",{value:"1024x1024",children:"◼ Square"}),e.jsx("option",{value:"1792x1024",children:"▬ Wide"})]}),e.jsx("button",{onClick:$,disabled:j||!v.trim()||!s,className:`${f.compactButton} ${j||!v.trim()||!s?f.compactButtonDisabled:""}`,children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:E}),x==="minting"?"Creating...":"Generating..."]}):"🎨 Create Artwork"})]})]}),x!=="idle"&&e.jsxs("div",{className:f.compactStatus,children:[e.jsx("div",{className:E}),e.jsx("span",{children:x==="minting"?"Creating your artwork...":"Generating image..."})]}),!s&&e.jsx("div",{className:f.compactError,children:"Connect your account to create artwork"}),A&&e.jsx("div",{className:f.compactError,children:A}),h&&m&&e.jsxs("div",{className:Q,children:[e.jsx("h4",{className:G({margin:0,fontSize:"sm"}),children:"✅ Artwork created successfully!"}),e.jsxs("p",{className:G({margin:"xs 0",fontSize:"sm"}),children:["ID: ",h.toString()," - Check your gallery below"]})]})]})})}function he({newlyCreatedNFT:t,onNewNFTDisplayed:c}={}){const{address:n,isConnected:l}=W(),m=Y(),d=O(),[h,p]=u.useState([]),[v,S]=u.useState(!1),[k,T]=u.useState(null),[j,I]=u.useState(null),{data:x,isLoading:b}=V({...d,functionName:"balanceOf",args:n?[n]:void 0,chainId:m.id,query:{enabled:!!n&&l}}),A=async s=>{try{if(s.startsWith("file://"))return console.warn("Cannot fetch file:// URLs in browser. Metadata:",s),null;const r=await fetch(s);if(!r.ok)throw new Error(`Failed to fetch metadata: ${r.status}`);return await r.json()}catch(r){return console.error("Error fetching NFT metadata:",r),null}},y=async()=>{if(!l||!n){p([]);return}S(!0);try{const s=await M(B,{...d,functionName:"balanceOf",args:[n]});if(!s||s===0n){p([]);return}const r=Array.from({length:Number(s)},()=>({tokenId:0n,tokenURI:"",isLoading:!0}));p(r);const i=[];for(let a=0;a<Number(s);a++){const w=(async()=>{try{const D=await M(B,{...d,functionName:"tokenOfOwnerByIndex",args:[n,BigInt(a)]}),U=await M(B,{...d,functionName:"tokenURI",args:[D]}),N=await A(U);return{tokenId:D,tokenURI:U,metadata:N||void 0,imageUrl:N==null?void 0:N.image,isLoading:!1}}catch(C){return console.error(`Error loading NFT at index ${a}:`,C),{tokenId:0n,tokenURI:"",isLoading:!1,error:`Failed to load NFT #${a}: ${C instanceof Error?C.message:"Unknown error"}`}}})();i.push(w)}const $=(await Promise.all(i)).sort((a,w)=>a.error&&!w.error?1:!a.error&&w.error?-1:a.error&&w.error?0:Number(w.tokenId-a.tokenId));p($)}catch(s){console.error("Error loading NFTs:",s),p([])}finally{S(!1)}};if(u.useEffect(()=>{l&&n&&y()},[n,l,x]),u.useEffect(()=>{if(t){T(t.tokenId);const s={tokenId:t.tokenId,tokenURI:"",imageUrl:t.imageUrl,metadata:t.metadata,isLoading:!1};p(r=>{const i=r.findIndex(g=>g.tokenId===t.tokenId);if(i!==-1){const g=[...r];return g[i]={...g[i],imageUrl:t.imageUrl,metadata:t.metadata},g}else return[s,...r]}),setTimeout(()=>{T(null),c==null||c()},5e3)}},[t,c]),!l)return e.jsx("div",{className:P.walletPrompt,children:e.jsx("p",{children:"Connect your account to view your artworks"})});const L=b||v;return e.jsxs("div",{className:P.container,children:[e.jsx("div",{className:P.heading,children:e.jsxs("h2",{className:f.columnHeading,children:["Your Digital Artworks (",(x==null?void 0:x.toString())||"0",")"]})}),L&&h.length===0?e.jsxs("div",{className:P.loadingContainer,children:[e.jsx("div",{className:E}),e.jsx("p",{children:"Loading your artworks..."})]}):x===0n||!x?e.jsx("div",{className:P.emptyStateContainer,children:e.jsx("p",{className:P.emptyStateText,children:"You haven't created any artworks yet. Use the generator above to create your first one!"})}):e.jsx("div",{className:P.grid,children:h.map((s,r)=>e.jsx(pe,{nft:s,onImageClick:I,onNftBurned:()=>y(),isHighlighted:k===s.tokenId},`${s.tokenId}-${r}`))}),j&&e.jsx(ge,{image:j,onClose:()=>I(null)})]})}function pe({nft:t,onImageClick:c,onNftBurned:n,isHighlighted:l=!1}){var y,L,s;const{writeContract:m,isPending:d,data:h}=Z(),p=O(),[v,S]=u.useState(!1),k=X.useRef(null),{isLoading:T,isSuccess:j}=de({hash:h});u.useEffect(()=>{j&&setTimeout(()=>{n()},1e3)},[j,n]),u.useEffect(()=>()=>{k.current&&clearTimeout(k.current)},[]);const I=()=>{var r,i,g;t.imageUrl&&c({src:t.imageUrl,alt:((r=t.metadata)==null?void 0:r.name)||`Artwork #${t.tokenId}`,title:(i=t.metadata)==null?void 0:i.name,description:(g=t.metadata)==null?void 0:g.description})},x=async()=>{var r;if(t.imageUrl)try{const g=await(await fetch(t.imageUrl)).blob(),$=window.URL.createObjectURL(g),a=document.createElement("a");a.href=$,a.download=`${((r=t.metadata)==null?void 0:r.name)||`Artwork-${t.tokenId}`}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL($)}catch(i){console.error("Download failed:",i),alert("Download failed. Please try again.")}},b=async()=>{const i=`https://opensea.io/item/optimism/${p.address}/${t.tokenId}`;try{await navigator.clipboard.writeText(i),S(!0),k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{S(!1),k.current=null},3e3)}catch(g){console.error("Failed to copy URL:",g),window.open(i,"_blank","noopener,noreferrer")}},A=async()=>{var r;if(confirm(`Are you sure you want to permanently delete "${((r=t.metadata)==null?void 0:r.name)||`Artwork #${t.tokenId}`}"? This action cannot be undone.`))try{await m({...p,functionName:"burn",args:[t.tokenId]})}catch(i){console.error("Delete failed:",i),alert("Failed to delete artwork. Please try again.")}};return e.jsxs("div",{className:`${o.container} ${l?o.highlighted:""}`,children:[t.isLoading?e.jsxs("div",{className:o.loadingContainer,children:[e.jsx("div",{className:E}),e.jsx("p",{className:o.loadingText,children:"Loading artwork..."})]}):t.error?e.jsxs("div",{className:o.errorContainer,children:[e.jsx("div",{className:o.errorBox,children:e.jsx("p",{className:o.errorText,children:t.error})}),e.jsxs("p",{className:o.tokenIdText,children:["ID: ",t.tokenId.toString()]})]}):e.jsxs(e.Fragment,{children:[t.imageUrl?e.jsxs("div",{className:o.imageContainer,children:[e.jsx("img",{src:t.imageUrl,alt:((y=t.metadata)==null?void 0:y.name)||`Artwork #${t.tokenId}`,className:o.image,onClick:I,style:{cursor:"pointer"},onError:r=>{const i=r.target;i.style.display="none",i.nextElementSibling.classList.remove("hidden")}}),e.jsx("div",{className:o.imageError,style:{display:"none"},children:"Image not available"})]}):e.jsx("div",{className:o.imagePlaceholder,children:"No image available"}),e.jsx("h3",{className:o.title,children:((L=t.metadata)==null?void 0:L.name)||`Artwork #${t.tokenId}`}),((s=t.metadata)==null?void 0:s.description)&&e.jsx("p",{className:o.description,children:t.metadata.description}),e.jsx("div",{className:o.footer,children:e.jsxs("span",{children:["ID: ",t.tokenId.toString()]})}),e.jsxs("div",{className:o.actions,children:[t.imageUrl&&e.jsx("button",{onClick:I,className:`${o.actionButton} ${_}`,title:"View full size",children:"🔍 Zoom"}),t.imageUrl&&e.jsx("button",{onClick:x,className:`${o.actionButton} ${H}`,title:"Download image",children:"⬇️ Download"}),e.jsx("button",{onClick:b,className:`${o.actionButton} ${_}`,title:"Share your artwork on the marketplace",children:"📤 Share"}),e.jsx("button",{onClick:A,disabled:d||T,className:`${o.actionButton} ${d||T?_:ee}`,title:"Delete artwork (permanent)",style:{opacity:d||T?.6:1},children:d?"🗑️ Deleting...":T?"⏳ Confirming...":"🗑️ Delete"})]})]}),v&&e.jsx("div",{className:R.container,children:e.jsxs("div",{className:R.content,children:[e.jsx("span",{className:R.icon,children:"✅"}),e.jsx("span",{className:R.message,children:"OpenSea URL copied to clipboard!"})]})})]})}function ge({image:t,onClose:c}){u.useEffect(()=>{const l=m=>{m.key==="Escape"&&c()};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[c]);const n=async()=>{try{const m=await(await fetch(t.src)).blob(),d=window.URL.createObjectURL(m),h=document.createElement("a");h.href=d,h.download=`${t.title||"NFT-image"}.png`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(d)}catch(l){console.error("Download failed:",l),alert("Download failed. Please try again.")}};return e.jsx("div",{className:o.modalOverlay,onClick:c,children:e.jsxs("div",{className:o.modalContent,onClick:l=>l.stopPropagation(),children:[e.jsx("button",{className:o.modalClose,onClick:c,children:"✕"}),e.jsx("img",{src:t.src,alt:t.alt,className:o.modalImage}),(t.title||t.description)&&e.jsxs("div",{className:o.modalInfo,children:[t.title&&e.jsx("h3",{className:o.modalTitle,children:t.title}),t.description&&e.jsx("p",{className:o.modalDescription,children:t.description}),e.jsx("div",{className:o.actions,style:{justifyContent:"center",marginTop:"12px"},children:e.jsx("button",{onClick:n,className:`${o.actionButton} ${H}`,children:"⬇️ Download Full Size"})})]})]})})}function fe(){const[t,c]=u.useState(null),n=(d,h,p)=>{console.log("Image generation succeeded:",{tokenId:d,imageUrl:h,metadata:p}),c({tokenId:d,imageUrl:h,metadata:p})},l=d=>{console.error("Image generation failed:",d)},m=()=>{c(null)};return e.jsxs("div",{className:te,children:[e.jsx("h1",{className:ae,children:"AI Image Creator"}),e.jsx(me,{onSuccess:n,onError:l}),e.jsx(he,{newlyCreatedNFT:t??void 0,onNewNFTDisplayed:m})]})}const xe=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"})),Ne={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:ce}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:le}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:ie}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:xe}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:se}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:oe}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:ne}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:re}}};export{Ne as configValuesSerialized};
