import{r as m,e as G,j as e,f as x,s as _,g as J,h as O,n as A,k as z,R as K,l as n,m as F,q,t as Q,v as E,c as X,w as ee,F as te,i as ae,W as re,L as ne,a as oe,b as se,o as ie}from"../chunks/chunk-DVUYG-jY.js";import{u as W,g as H,a as M,b as V,r as B,c as le}from"../chunks/chunk-CSICpu8r.js";/* empty css                      */import"../chunks/chunk-DQ3hQvvF.js";/* empty css                      *//* empty css                      */const ce=async t=>new Promise((c,a)=>{const s=async()=>{try{const h=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[t]});h?c(h):setTimeout(s,2e3)}catch(h){a(h)}};s()});function de({apiUrl:t="https://mypersonaljscloudivnad9dy-readnftv2.functions.fnc.fr-par.scw.cloud",onSuccess:c,onError:a}){const s=M(),[h,d]=m.useState(),[p,g]=m.useState(),[w,b]=m.useState(""),[f,k]=m.useState(!1),[j,T]=m.useState("idle"),[v,N]=m.useState(null),{address:D,isConnected:S}=G(),y=H(),{data:l}=W({...s,functionName:"mintPrice",args:[],...(y==null?void 0:y.id)&&{chainId:y.id}}),{writeContractAsync:o}=V(),i=async()=>{if(!S||!D){const r="Please connect your account first";N(r),a==null||a(r);return}if(!w.trim()){const r="Please enter a prompt";N(r),a==null||a(r);return}if(!l){const r="Could not load creation fee from system";N(r),a==null||a(r);return}k(!0),N(null),T("minting");try{const r=`ipfs://tempURI/${Date.now()}`,I=await o({...s,functionName:"safeMint",args:[r],value:l,...(y==null?void 0:y.id)&&{chainId:y.id}});console.log("Minting transaction sent:",I);const u=await ce(I),C=u==null?void 0:u.logs.find(Z=>Z.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!C||C.topics.length<4)throw new Error("Could not extract artwork ID from transaction");const L=C.topics[3],U=BigInt(L);console.log("Created artwork ID:",U),g(U),T("generating");const R=await fetch(`${t}?prompt=${encodeURIComponent(w)}&tokenId=${U}`);if(!R.ok)throw new Error(`Error: ${R.status} ${R.statusText}`);const $=await R.json();console.log("Image generation completed",$);const P=$.image_url;d(P),T("idle");const Y={name:`AI Generated Artwork #${U}`,description:`AI generated artwork based on the prompt: "${w}"`,image:P,external_url:$.metadata_url||"",attributes:[{trait_type:"Prompt",value:w},{trait_type:"Generation Method",value:"AI Generated"}]};c==null||c(U,P,Y),setTimeout(()=>{b(""),d(void 0),g(void 0),N(null)},3e3)}catch(r){console.error("Error:",r);const I=r instanceof Error?r.message:"An unknown error occurred";N(I),T("error"),a==null||a(I)}finally{k(!1)}};return e.jsx("div",{className:x.compactLayout,children:e.jsxs("div",{className:x.compactContainer,children:[e.jsxs("div",{className:x.compactHeader,children:[e.jsx("h3",{className:x.compactTitle,children:"Create Your Art"}),e.jsx("span",{className:x.compactSubtitle,children:"Describe what you want and generate your unique digital artwork (~10Â¢)"})]}),e.jsxs("div",{className:x.compactForm,children:[e.jsx("textarea",{value:w,onChange:r=>b(r.target.value),placeholder:"Describe your image in detail... (e.g., 'A futuristic city skyline at sunset')",disabled:f||j!=="idle",className:x.compactTextarea}),e.jsx("button",{onClick:i,disabled:f||!w.trim()||!S,className:`${x.compactButton} ${f||!w.trim()||!S?x.compactButtonDisabled:""}`,children:f?j==="minting"?"Creating...":"Generating...":"ðŸŽ¨ Create Art"})]}),j!=="idle"&&e.jsxs("div",{className:x.compactStatus,children:[e.jsx("div",{className:_}),e.jsx("span",{children:j==="minting"?"Creating your artwork...":"Generating image..."})]}),!S&&e.jsx("div",{className:x.compactError,children:"Connect your account to create artwork"}),v&&e.jsx("div",{className:x.compactError,children:v}),p&&h&&e.jsxs("div",{className:J,children:[e.jsx("h4",{className:O({margin:0,fontSize:"sm"}),children:"âœ… Artwork created successfully!"}),e.jsxs("p",{className:O({margin:"xs 0",fontSize:"sm"}),children:["ID: ",p.toString()," - Check your gallery below"]})]})]})})}function ue({newlyCreatedNFT:t,onNewNFTDisplayed:c}={}){const{address:a,isConnected:s}=G(),h=H(),d=M(),[p,g]=m.useState([]),[w,b]=m.useState(!1),[f,k]=m.useState(null),[j,T]=m.useState(null),{data:v,isLoading:N}=W({...d,functionName:"balanceOf",args:a?[a]:void 0,chainId:h.id,query:{enabled:!!a&&s}}),D=async l=>{try{if(l.startsWith("file://"))return console.warn("Cannot fetch file:// URLs in browser. Metadata:",l),null;const o=await fetch(l);if(!o.ok)throw new Error(`Failed to fetch metadata: ${o.status}`);return await o.json()}catch(o){return console.error("Error fetching NFT metadata:",o),null}},S=async()=>{if(!s||!a){g([]);return}b(!0);try{const l=await B(z,{...d,functionName:"balanceOf",args:[a]});if(!l||l===0n){g([]);return}const o=Array.from({length:Number(l)},()=>({tokenId:0n,tokenURI:"",isLoading:!0}));g(o);const i=[];for(let u=0;u<Number(l);u++){const C=(async()=>{try{const U=await B(z,{...d,functionName:"tokenOfOwnerByIndex",args:[a,BigInt(u)]}),$=await B(z,{...d,functionName:"tokenURI",args:[U]}),P=await D($);return{tokenId:U,tokenURI:$,metadata:P||void 0,imageUrl:P==null?void 0:P.image,isLoading:!1}}catch(L){return console.error(`Error loading NFT at index ${u}:`,L),{tokenId:0n,tokenURI:"",isLoading:!1,error:`Failed to load NFT #${u}: ${L instanceof Error?L.message:"Unknown error"}`}}})();i.push(C)}const I=(await Promise.all(i)).sort((u,C)=>u.error&&!C.error?1:!u.error&&C.error?-1:u.error&&C.error?0:Number(C.tokenId-u.tokenId));g(I)}catch(l){console.error("Error loading NFTs:",l),g([])}finally{b(!1)}};if(m.useEffect(()=>{s&&a&&S()},[a,s,v]),m.useEffect(()=>{if(t){k(t.tokenId);const l={tokenId:t.tokenId,tokenURI:"",imageUrl:t.imageUrl,metadata:t.metadata,isLoading:!1};g(o=>{const i=o.findIndex(r=>r.tokenId===t.tokenId);if(i!==-1){const r=[...o];return r[i]={...r[i],imageUrl:t.imageUrl,metadata:t.metadata},r}else return[l,...o]}),setTimeout(()=>{k(null),c==null||c()},5e3)}},[t,c]),!s)return e.jsx("div",{className:A.walletPrompt,children:e.jsx("p",{children:"Connect your account to view your artworks"})});const y=N||w;return e.jsxs("div",{className:A.container,children:[e.jsx("div",{className:A.heading,children:e.jsxs("h2",{className:x.columnHeading,children:["Your Digital Artworks (",(v==null?void 0:v.toString())||"0",")"]})}),y&&p.length===0?e.jsxs("div",{className:A.loadingContainer,children:[e.jsx("div",{className:_}),e.jsx("p",{children:"Loading your artworks..."})]}):v===0n||!v?e.jsx("div",{className:A.emptyStateContainer,children:e.jsx("p",{className:A.emptyStateText,children:"You haven't created any artworks yet. Use the generator above to create your first one!"})}):e.jsx("div",{className:A.grid,children:p.map((l,o)=>e.jsx(me,{nft:l,onImageClick:T,onNftBurned:()=>S(),isHighlighted:f===l.tokenId},`${l.tokenId}-${o}`))}),j&&e.jsx(he,{image:j,onClose:()=>T(null)})]})}function me({nft:t,onImageClick:c,onNftBurned:a,isHighlighted:s=!1}){var S,y,l;const{writeContract:h,isPending:d,data:p}=V(),g=M(),[w,b]=m.useState(!1),f=K.useRef(null),{isLoading:k,isSuccess:j}=le({hash:p});m.useEffect(()=>{j&&setTimeout(()=>{a()},1e3)},[j,a]),m.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]);const T=()=>{var o,i,r;t.imageUrl&&c({src:t.imageUrl,alt:((o=t.metadata)==null?void 0:o.name)||`Artwork #${t.tokenId}`,title:(i=t.metadata)==null?void 0:i.name,description:(r=t.metadata)==null?void 0:r.description})},v=async()=>{var o;if(t.imageUrl)try{const r=await(await fetch(t.imageUrl)).blob(),I=window.URL.createObjectURL(r),u=document.createElement("a");u.href=I,u.download=`${((o=t.metadata)==null?void 0:o.name)||`Artwork-${t.tokenId}`}.png`,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(I)}catch(i){console.error("Download failed:",i),alert("Download failed. Please try again.")}},N=async()=>{const i=`https://opensea.io/item/optimism/${g.address}/${t.tokenId}`;try{await navigator.clipboard.writeText(i),b(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{b(!1),f.current=null},3e3)}catch(r){console.error("Failed to copy URL:",r),window.open(i,"_blank","noopener,noreferrer")}},D=async()=>{var o;if(confirm(`Are you sure you want to permanently delete "${((o=t.metadata)==null?void 0:o.name)||`Artwork #${t.tokenId}`}"? This action cannot be undone.`))try{await h({...g,functionName:"burn",args:[t.tokenId]})}catch(i){console.error("Delete failed:",i),alert("Failed to delete artwork. Please try again.")}};return e.jsxs("div",{className:`${n.container} ${s?n.highlighted:""}`,children:[t.isLoading?e.jsxs("div",{className:n.loadingContainer,children:[e.jsx("div",{className:_}),e.jsx("p",{className:n.loadingText,children:"Loading artwork..."})]}):t.error?e.jsxs("div",{className:n.errorContainer,children:[e.jsx("div",{className:n.errorBox,children:e.jsx("p",{className:n.errorText,children:t.error})}),e.jsxs("p",{className:n.tokenIdText,children:["ID: ",t.tokenId.toString()]})]}):e.jsxs(e.Fragment,{children:[t.imageUrl?e.jsxs("div",{className:n.imageContainer,children:[e.jsx("img",{src:t.imageUrl,alt:((S=t.metadata)==null?void 0:S.name)||`Artwork #${t.tokenId}`,className:n.image,onClick:T,style:{cursor:"pointer"},onError:o=>{const i=o.target;i.style.display="none",i.nextElementSibling.classList.remove("hidden")}}),e.jsx("div",{className:n.imageError,style:{display:"none"},children:"Image not available"})]}):e.jsx("div",{className:n.imagePlaceholder,children:"No image available"}),e.jsx("h3",{className:n.title,children:((y=t.metadata)==null?void 0:y.name)||`Artwork #${t.tokenId}`}),((l=t.metadata)==null?void 0:l.description)&&e.jsx("p",{className:n.description,children:t.metadata.description}),e.jsx("div",{className:n.footer,children:e.jsxs("span",{children:["ID: ",t.tokenId.toString()]})}),e.jsxs("div",{className:n.actions,children:[t.imageUrl&&e.jsx("button",{onClick:T,className:`${n.actionButton} ${F}`,title:"View full size",children:"ðŸ” Zoom"}),t.imageUrl&&e.jsx("button",{onClick:v,className:`${n.actionButton} ${q}`,title:"Download image",children:"â¬‡ï¸ Download"}),e.jsx("button",{onClick:N,className:`${n.actionButton} ${F}`,title:"Share your artwork on the marketplace",children:"ðŸ“¤ Share"}),e.jsx("button",{onClick:D,disabled:d||k,className:`${n.actionButton} ${d||k?F:Q}`,title:"Delete artwork (permanent)",style:{opacity:d||k?.6:1},children:d?"ðŸ—‘ï¸ Deleting...":k?"â³ Confirming...":"ðŸ—‘ï¸ Delete"})]})]}),w&&e.jsx("div",{className:E.container,children:e.jsxs("div",{className:E.content,children:[e.jsx("span",{className:E.icon,children:"âœ…"}),e.jsx("span",{className:E.message,children:"OpenSea URL copied to clipboard!"})]})})]})}function he({image:t,onClose:c}){m.useEffect(()=>{const s=h=>{h.key==="Escape"&&c()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[c]);const a=async()=>{try{const h=await(await fetch(t.src)).blob(),d=window.URL.createObjectURL(h),p=document.createElement("a");p.href=d,p.download=`${t.title||"NFT-image"}.png`,document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(d)}catch(s){console.error("Download failed:",s),alert("Download failed. Please try again.")}};return e.jsx("div",{className:n.modalOverlay,onClick:c,children:e.jsxs("div",{className:n.modalContent,onClick:s=>s.stopPropagation(),children:[e.jsx("button",{className:n.modalClose,onClick:c,children:"âœ•"}),e.jsx("img",{src:t.src,alt:t.alt,className:n.modalImage}),(t.title||t.description)&&e.jsxs("div",{className:n.modalInfo,children:[t.title&&e.jsx("h3",{className:n.modalTitle,children:t.title}),t.description&&e.jsx("p",{className:n.modalDescription,children:t.description}),e.jsx("div",{className:n.actions,style:{justifyContent:"center",marginTop:"12px"},children:e.jsx("button",{onClick:a,className:`${n.actionButton} ${q}`,children:"â¬‡ï¸ Download Full Size"})})]})]})})}function pe(){const[t,c]=m.useState(null),a=(d,p,g)=>{console.log("Image generation succeeded:",{tokenId:d,imageUrl:p,metadata:g}),c({tokenId:d,imageUrl:p,metadata:g})},s=d=>{console.error("Image generation failed:",d)},h=()=>{c(null)};return e.jsxs("div",{className:X,children:[e.jsx("h1",{className:ee,children:"AI Image Creator"}),e.jsx(de,{onSuccess:a,onError:s}),e.jsx(ue,{newlyCreatedNFT:t??void 0,onNewNFTDisplayed:h})]})}const ge=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"})),je={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:ie}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:se}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:oe}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:ge}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:ne}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:re}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:ae}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:te}}};export{je as configValuesSerialized};
