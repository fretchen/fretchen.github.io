import{be as _t,bf as Ht,bg as Wt,$ as Ue,r as m,a0 as qt,g as u,j as e,u as Gt,bh as Kt,bi as Yt,bj as Jt,a4 as ee,bb as ze,a5 as Qt,a2 as r,az as me,bk as O,bl as f,bm as Z,bn as Vt,bo as Xt,bp as G,bq as de,a1 as Le,br as ye,bs as _,f as Zt,F as ea,a as ta,W as aa,c as na,d as sa,e as ra,o as oa}from"../chunks/chunk-C0CDn6bf.js";import{a as ge,g as k,e as Ee}from"../chunks/chunk-DwFTiSeS.js";import{d as ia}from"../chunks/chunk-DBQ_J0i3.js";import{u as he,a as ue,b as we,r as Te}from"../chunks/chunk-BW25ieF8.js";import{u as Be}from"../chunks/chunk-DpknaJ8s.js";/* empty css                      *//* empty css                      */import"../chunks/chunk-CIwvxh-D.js";import"../chunks/chunk-B49QVJgS.js";let be=[];function Ae(t){const a=t.chains;return _t(be,a)?be:(be=a,a)}async function ca(t,a){const{addEthereumChainParameter:n,chainId:s}=a,c=t.state.connections.get(a.connector?.uid??t.state.current);if(c){const o=c.connector;if(!o.switchChain)throw new Ht({connector:o});return await o.switchChain({addEthereumChainParameter:n,chainId:s})}const i=t.chains.find(o=>o.id===s);if(!i)throw new Wt;return t.setState(o=>({...o,chainId:s})),i}function la(t,a){const{onChange:n}=a;return t._internal.chains.subscribe((s,c)=>{n(s,c)})}function da(t){return{mutationFn(a){return ca(t,a)},mutationKey:["switchChain"]}}function ma(t={}){const a=Ue(t);return m.useSyncExternalStore(n=>la(a,{onChange:n}),()=>Ae(a),()=>Ae(a))}function ua(t={}){const{mutation:a}=t,n=Ue(t),s=da(n),{mutate:c,mutateAsync:i,...o}=qt({...a,...s});return{...o,chains:ma({config:n}),switchChain:c,switchChainAsync:i}}function $e({size:t="sm",className:a}){const n={xs:u({fontSize:"xs",lineHeight:"1"}),sm:u({fontSize:"sm",lineHeight:"1"}),md:u({fontSize:"md",lineHeight:"1"})},s=u({display:"inline-flex",alignItems:"center",justifyContent:"center",width:"1em",height:"1em",borderRadius:"50%",backgroundColor:"blue.100",color:"blue.600",fontWeight:"bold",cursor:"help"});return e.jsx("span",{className:`${s} ${n[t]} ${a||""}`,role:"img","aria-label":"Information",children:"i"})}function Fe({label:t,locale:a}){const s=Gt(),c=a??s.locale??ia,o=Kt(c==="de"?Yt:Jt,t);return e.jsx("span",{"data-locale":c,children:o})}const ga="https://mypersonaljscloudivnad9dy-genimgbfl.functions.fnc.fr-par.scw.cloud",ha=(t,a,n=1920)=>{const s=t/a;return t<=n&&a<=n?{width:t,height:a}:t>a?{width:n,height:Math.round(n/s)}:{width:Math.round(n*s),height:n}},pa=(t,a=1024)=>new Promise((n,s)=>{const c=document.createElement("canvas"),i=c.getContext("2d"),o=new Image;o.onload=()=>{const{width:p,height:h}=ha(o.width,o.height);if(c.width=p,c.height=h,!i){s(new Error("Could not get canvas context"));return}i.fillStyle="white",i.fillRect(0,0,p,h),i.drawImage(o,0,0,p,h);let x=.9;const v=()=>{const y=c.toDataURL("image/jpeg",x);y.length*.75/1024<=a||x<=.1?n({base64:y.split(",")[1],mimeType:"image/jpeg"}):(x-=.1,setTimeout(v,0))};v()},o.onerror=()=>s(new Error("Failed to load image")),o.src=URL.createObjectURL(t)}),fa=async t=>new Promise((a,n)=>{const s=async()=>{try{const c=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[t]});c?a(c):setTimeout(s,2e3)}catch(c){n(c)}};s()});function xa({apiUrl:t=ga,onSuccess:a,onError:n}){const[s,c]=m.useState(),[i,o]=m.useState(),[p,h]=m.useState(),[x,v]=m.useState(null),[y,I]=m.useState("image/jpeg"),{address:B,isConnected:D}=ee(),[C,l]=m.useState("empty"),[P,A]=m.useState(""),[w,T]=m.useState("1024x1024"),[R,H]=m.useState(!1),[j,$]=m.useState(!1),[L,q]=m.useState("idle"),[W,S]=m.useState(null),U=ge(),Y=ze(),{switchChain:te,isPending:K}=ua(),{connectors:ae,connect:pe}=Qt(),{data:ne}=he({...k,functionName:"mintPrice",args:[],...U?.id&&{chainId:U.id}}),{writeContractAsync:b}=ue(),N=async d=>new Promise((g,E)=>{const Q=()=>{Y===d?g():setTimeout(Q,100)};setTimeout(()=>{E(new Error(Ye))},1e4),Q()}),F=()=>{ae.length>0&&pe({connector:ae[0]})},M=r({label:"imagegen.connectWalletButton"}),se=r({label:"imagegen.enterPrompt"}),re=r({label:"imagegen.switchingNetwork"}),oe=r({label:"imagegen.creating"}),z=r({label:"imagegen.generating"}),ve=r({label:"imagegen.createArtwork"}),_e=r({label:"imagegen.promptPlaceholder"}),He=r({label:"imagegen.editPromptPlaceholder"}),je=r({label:"imagegen.editImage"}),We=r({label:"imagegen.connectAccountFirst"}),qe=r({label:"imagegen.switchToOptimism"}),Ge=r({label:"imagegen.enterPromptError"}),Ke=r({label:"imagegen.loadMintPrice"}),Ye=r({label:"imagegen.chainSwitchTimeout"}),Je=r({label:"imagegen.extractTokenId"}),Qe=r({label:"imagegen.unknownError"}),Ve=r({label:"imagegen.uploadReferenceImage"}),Xe=r({label:"imagegen.dragDropHere"}),Ze=r({label:"imagegen.supportedFormats"}),et=r({label:"imagegen.referenceImageTitle"}),tt=r({label:"imagegen.generatedArtworkTitle"}),Ne=r({label:"imagegen.remove"}),at=r({label:"imagegen.referenceImageAlt"}),nt=r({label:"imagegen.generatedArtworkAlt"}),st=r({label:"imagegen.referenceImageHint"}),rt=r({label:"imagegen.invalidFileType"}),ot=r({label:"imagegen.fileTooLarge"}),it=r({label:"imagegen.compressionFailed"}),ct=r({label:"imagegen.failedToProcessImage"}),lt=r({label:"imagegen.creatingArtwork"}),dt=r({label:"imagegen.generatingImage"}),mt=r({label:"imagegen.title"}),ut=r({label:"imagegen.collapsedTitle"}),gt=r({label:"imagegen.collapsedDescription"}),ht=r({label:"imagegen.square"}),pt=r({label:"imagegen.wide"}),ft=r({label:"imagegen.mintingInfo"}),xt=r({label:"imagegen.artworkCreated"}),bt=r({label:"imagegen.checkGallery"}),yt=r({label:"imagegen.switchingToOptimism"}),wt=r({label:"imagegen.poweredBy"}),Tt=r({label:"imagegen.viewContract"}),vt=r({label:"imagegen.learnMoreOptimism"}),jt=r({label:"imagegen.viewContractEtherscan"}),Nt=()=>K?"switching":j?"loading":P.trim()?"ready":"needsPrompt",Ce=d=>{switch(d){case"switching":return re;case"loading":return L==="minting"?oe:z;case"connect":return M;case"needsPrompt":return se;case"ready":return C!=="empty"?je:ve;default:return C!=="empty"?je:ve}},J=Nt(),Ct=()=>{const d=J==="needsPrompt",g=J==="loading"||J==="switching";return e.jsx("button",{onClick:St,disabled:d,className:`${me} ${d?Xt:""}`,title:r({label:"imagegen.mintingInfo"}),"aria-describedby":"create-artwork-info",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:Z}),Ce(J)]}):e.jsxs(e.Fragment,{children:["ðŸŽ¨ ",Ce(J),e.jsx($e,{size:"xs",className:u({ml:"1",opacity:"0.7"})})]})})},St=async()=>{if(!D||!B){const g=We;S(g),n?.(g);return}const d=U?.id;if(d&&Y!==d)try{S(yt),await te({chainId:d}),await N(d),S(null)}catch(g){console.error("Failed to switch chain:",g);const E=g instanceof Error?g.message:qe;S(E),n?.(E);return}if(!P.trim()){const g=Ge;S(g),n?.(g);return}if(!ne){const g=Ke;S(g),n?.(g);return}$(!0),S(null),q("minting");try{const E=await b({...k,functionName:"safeMint",args:["",R],value:ne,...U?.id&&{chainId:U.id}});console.log("Minting transaction sent:",E);const fe=(await fa(E))?.logs.find(ce=>ce.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!fe||fe.topics.length<4)throw new Error(Je);const Rt=fe.topics[3],V=BigInt(Rt);console.log("Created artwork ID:",V),o(V),q("generating");const Ie=x!==null,Ut=Ie?"edit":"generate",Pe={prompt:P,tokenId:V.toString(),size:w,mode:Ut};Ie&&x&&(Pe.referenceImage=x);const ie=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!ie.ok)throw new Error(`Error: ${ie.status} ${ie.statusText}`);const xe=await ie.json();console.log("Image generation completed",xe);const X=xe.image_url;c(X),h(X),l("generated"),q("idle");try{const Bt=await(await fetch(X)).blob(),Dt=(await new Promise((Mt,Ot)=>{const le=new FileReader;le.onload=()=>Mt(le.result),le.onerror=Ot,le.readAsDataURL(Bt)})).split(",")[1];v(Dt)}catch(ce){console.warn("Failed to convert generated image to base64:",ce)}const zt={name:`AI Generated Artwork #${V}`,description:`AI generated artwork based on the prompt: "${P}"`,image:X,external_url:xe.metadata_url||"",attributes:[{trait_type:"Prompt",value:P},{trait_type:"Generation Method",value:"AI Generated"}]};a?.(V,X,zt),setTimeout(()=>{A(""),T("1024x1024"),c(void 0),o(void 0),S(null)},3e3)}catch(g){console.error("Error:",g);const E=g instanceof Error?g.message:Qe;S(E),q("error"),n?.(E)}finally{$(!1)}},kt=r({label:"imagegen.mintingInfo"}),It=d=>["image/jpeg","image/png"].includes(d.type)?d.size>10485760?(S(ot),!1):!0:(S(rt),!1),Se=async d=>{if(It(d)){S(null),$(!0);try{const g=await pa(d,1024);v(g.base64),I(g.mimeType),l("reference");const E=Math.round(d.size/1024),Q=Math.round(g.base64.length*.75/1024);console.log(`Image compressed: ${E}KB â†’ ${Q}KB (${d.type} â†’ ${g.mimeType})`)}catch(g){console.error("Image compression failed:",g);const E=g instanceof Error?g.message:ct;S(`${it}: ${E}`)}finally{$(!1)}}},Pt=d=>{d.preventDefault(),d.stopPropagation()},Lt=d=>{d.preventDefault(),d.stopPropagation()},Et=d=>{d.preventDefault(),d.stopPropagation();const g=Array.from(d.dataTransfer.files);g.length>0&&Se(g[0])},At=d=>{const g=d.target.files;g&&g.length>0&&Se(g[0])},$t=()=>{v(null),I("image/jpeg");const d=document.getElementById("reference-image-input");d&&(d.value=""),l(p?"generated":"empty")},ke=w==="1792x1024"?"wide":"square",Ft=()=>{F()};return e.jsx("div",{className:u({transition:"all 0.5s ease-in-out",overflow:"hidden"}),children:D?e.jsx("div",{className:O.compactLayout,children:e.jsxs("div",{className:O.compactContainer,children:[e.jsx("div",{className:O.compactHeader,children:e.jsxs("h3",{className:O.compactTitle,children:["ðŸŽ¨",e.jsx(Fe,{label:"imagegen.title"})]})}),e.jsxs("div",{className:O.compactForm,children:[e.jsxs("div",{"data-testid":"drop-zone",className:u({mb:"4",border:"1px solid",borderColor:C==="empty"?"gray.300":"gray.400",borderRadius:"md",bg:C==="empty"?"gray.50":"white",position:"relative",cursor:C==="empty"?"pointer":"default",overflow:"hidden",width:"100%",_hover:C==="empty"?{borderColor:"gray.400",bg:"gray.100"}:{}}),onDragOver:Pt,onDragEnter:Lt,onDrop:Et,onClick:()=>{C==="empty"&&document.getElementById("reference-image-input")?.click()},children:[e.jsx("input",{id:"reference-image-input","data-testid":"reference-image-input",type:"file",accept:"image/*",onChange:At,className:u({position:"absolute",opacity:0,width:0,height:0,pointerEvents:"none"})}),C==="empty"&&e.jsxs("div",{className:u({display:"flex",alignItems:"center",justifyContent:"center",py:"6",px:"4",gap:"3"}),children:[e.jsx("div",{className:u({fontSize:"xl",color:"gray.500"}),children:"ðŸ“¸"}),e.jsxs("div",{className:u({textAlign:"left"}),children:[e.jsx("h4",{className:u({fontSize:"sm",fontWeight:"medium",color:"gray.700",mb:"1"}),children:Ve}),e.jsxs("p",{className:u({fontSize:"xs",color:"gray.500",mb:"0"}),children:[Xe," â€¢ ",Ze]})]})]}),C==="reference"&&x&&e.jsxs("div",{className:u({p:"3"}),children:[e.jsxs("div",{className:u({display:"flex",justifyContent:"space-between",alignItems:"center",mb:"3"}),children:[e.jsx("h4",{className:u({fontSize:"sm",fontWeight:"medium",color:"gray.700",m:0}),children:et}),e.jsxs("button",{onClick:d=>{d.stopPropagation(),$t()},className:u({px:"2",py:"1",fontSize:"xs",bg:"gray.600",color:"white",border:"none",borderRadius:"sm",cursor:"pointer",_hover:{bg:"gray.700"}}),children:["âœ• ",Ne]})]}),e.jsx("div",{className:u({position:"relative",width:"100%",height:ke==="wide"?"250px":"200px",overflow:"hidden",borderRadius:"sm",bg:"gray.100"}),children:e.jsx("img",{src:`data:${y};base64,${x}`,alt:at,className:u({width:"100%",height:"100%",objectFit:"contain",borderRadius:"sm"})})}),e.jsx("p",{className:u({fontSize:"xs",color:"gray.500",textAlign:"center",mt:"2",mb:"0"}),children:st})]}),C==="generated"&&p&&e.jsxs("div",{className:u({p:"3"}),children:[e.jsxs("div",{className:u({display:"flex",justifyContent:"space-between",alignItems:"center",mb:"3"}),children:[e.jsx("h4",{className:u({fontSize:"sm",fontWeight:"medium",color:"gray.700",m:0}),children:tt}),e.jsx("div",{className:u({display:"flex",gap:"2"}),children:e.jsxs("button",{onClick:()=>{v(null),I("image/jpeg"),h(void 0),l("empty");const d=document.getElementById("reference-image-input");d&&(d.value="")},className:u({px:"2",py:"1",fontSize:"xs",bg:"gray.600",color:"white",border:"none",borderRadius:"sm",cursor:"pointer",_hover:{bg:"gray.700"}}),disabled:j||L!=="idle",children:["âœ• ",Ne]})})]}),e.jsx("div",{className:u({position:"relative",width:"100%",height:ke==="wide"?"250px":"200px",overflow:"hidden",borderRadius:"sm",bg:"gray.100"}),children:e.jsx("img",{src:p,alt:nt,className:u({width:"100%",height:"100%",objectFit:"contain",borderRadius:"sm"})})})]})]}),e.jsx("textarea",{value:P,onChange:d=>A(d.target.value),placeholder:C==="reference"?He:_e,disabled:j||L!=="idle"||K,className:O.compactTextarea}),e.jsxs("div",{className:O.controlBar,children:[e.jsxs("div",{className:O.optionsGroup,children:[e.jsxs("select",{id:"imageSizeSelect",value:w,onChange:d=>T(d.target.value),disabled:j||L!=="idle"||K,className:O.compactSelect,"aria-label":"Select image format for your artwork",children:[e.jsx("option",{value:"1024x1024",children:ht}),e.jsx("option",{value:"1792x1024",children:pt})]}),e.jsxs("label",{className:f.checkboxLabel,title:R?"NFT will be publicly visible in the 'All Public Artworks' gallery":"NFT will remain unlisted from the 'All Public Artworks' gallery",children:[e.jsx("input",{type:"checkbox",checked:R,onChange:d=>H(d.target.checked),disabled:j||L!=="idle"||K,className:f.checkbox}),e.jsx(Fe,{label:"imagegen.listed"})]})]}),e.jsx(Ct,{})]})]}),e.jsxs("div",{className:u({mt:"2",fontSize:"xs",color:"gray.600",textAlign:"center"}),children:[wt," ",e.jsx("a",{href:"https://optimism.io",target:"_blank",rel:"noopener noreferrer","aria-label":vt,className:u({color:"blue.600",textDecoration:"underline",_hover:{color:"blue.800"}}),children:"Optimism"})," ","â€¢"," ",e.jsxs("a",{href:`https://optimistic.etherscan.io/address/${k.address}`,target:"_blank",rel:"noopener noreferrer","aria-label":jt,className:u({color:"blue.600",textDecoration:"underline",_hover:{color:"blue.800"}}),children:[Tt," â†—"]})]}),e.jsx("span",{id:"create-artwork-info",className:u({position:"absolute",left:"-9999px",top:"auto",width:"1px",height:"1px",overflow:"hidden"}),children:ft}),e.jsxs("div",{className:u({display:{base:"block",md:"none"},mt:"2",fontSize:"xs",color:"gray.600",textAlign:"center"}),children:[e.jsx($e,{size:"xs",className:u({mr:"1"})}),kt]}),L!=="idle"&&e.jsxs("div",{className:O.compactStatus,children:[e.jsx("div",{className:Z}),e.jsx("span",{children:L==="minting"?lt:dt})]}),W&&e.jsx("div",{className:O.compactError,children:W}),i&&s&&e.jsxs("div",{className:Vt,children:[e.jsx("h4",{className:u({margin:0,fontSize:"sm"}),children:xt}),e.jsxs("p",{className:u({margin:"xs 0",fontSize:"sm"}),children:["ID: ",i.toString()," - ",bt]})]})]})}):e.jsxs("div",{className:u({maxWidth:"500px",margin:"0 auto",textAlign:"center"}),children:[e.jsxs("h3",{className:u({fontSize:"2xl",fontWeight:"semibold",marginBottom:"4",color:"gray.800"}),children:["ðŸŽ¨ ",mt]}),e.jsx("div",{className:u({fontSize:"md",fontWeight:"medium",color:"gray.800",mb:"3",textAlign:"center"}),children:ut}),e.jsx("p",{className:u({fontSize:"sm",color:"gray.600",mb:"lg",lineHeight:"1.5"}),children:gt}),e.jsx("div",{className:u({display:"flex",justifyContent:"center"}),children:e.jsx("button",{onClick:Ft,className:me,children:M})})]})})}function Re({label:t,isActive:a,onClick:n}){return e.jsx("button",{className:`${G.tab} ${a?G.activeTab:""}`,onClick:n,"aria-selected":a,children:t})}function ba({message:t,type:a,duration:n,onClose:s}){const c=m.useRef(null);m.useEffect(()=>{const p=n??(a==="error"?4e3:a==="warning"?5e3:3e3);return c.current=setTimeout(()=>{s()},p),()=>{c.current&&clearTimeout(c.current)}},[n,a,s]);const i=()=>{switch(a){case"success":return"âœ…";case"warning":return"âš ï¸";case"error":default:return"âŒ"}};return e.jsx("div",{className:de.container,children:e.jsxs("div",{className:de.content,"data-type":a,children:[e.jsx("span",{className:de.icon,children:i()}),e.jsx("span",{className:de.message,children:t})]})})}function De(){const[t,a]=m.useState(null),n=(i,o="error",p)=>{a({message:i,type:o,duration:p})},s=()=>{a(null)},c=t?e.jsx(ba,{message:t.message,type:t.type,duration:t.duration,onClose:s}):null;return{showToast:n,hideToast:s,ToastComponent:c}}function ya({genImTokenId:t}){const{isConnected:a}=ee(),n=ze(),{writeContract:s,isPending:c,data:i}=ue(),{isLoading:o,isSuccess:p}=we({hash:i}),h=ge(),x=n===h.id,v=r({label:"imagegen.collect"}),{data:y,error:I,isPending:B,refetch:D}=he({...Ee,functionName:"getMintStats",args:[t],chainId:h.id}),C=async()=>{if(!a||!x||!y||!Array.isArray(y))return;const[,A]=y;s({...Ee,functionName:"mintCollectorNFT",args:[t],value:A})};m.useEffect(()=>{p&&setTimeout(()=>{D()},2e3)},[p,D]);const l=()=>{if(B)return"...";if(I||!y||!Array.isArray(y))return"0";const[A]=y;return A.toString()},P=()=>{if(B||I||!y||!Array.isArray(y))return"Price loading...";const[A,w]=y,T=Le(w),R=S=>{const U=parseFloat(S);return U>=.001?U.toFixed(3):U>=1e-4?U.toFixed(4):U.toFixed(6)},H=R(T),j=Number(A),$=Math.ceil((j+1)/5)*5,q=w/BigInt(2**Math.floor(j/5))*BigInt(2**Math.floor($/5)),W=R(Le(q));return`Current price: ${H} ETH | Price after ${$} mints: ${W} ETH`};return e.jsx("button",{onClick:C,disabled:!a||c||o||!x,className:`${f.actionButton} ${me}`,title:`Collect this NFT (${l()} collected) | ${P()}`,children:c?"ðŸ“¦ Collecting...":p?"âœ… Collected!":`ðŸ“¦ ${v} (${l()})`})}function Me({tokenId:t,onImageClick:a,onNftBurned:n,onListedStatusChanged:s,isHighlighted:c=!1,isPublicView:i=!1,preloadedImageUrl:o,preloadedMetadata:p}){const{writeContract:h,isPending:x,data:v}=ue(),{writeContract:y,isPending:I,data:B}=ue(),[D,C]=m.useState(!1),[l,P]=m.useState({tokenId:t,tokenURI:"",imageUrl:o,metadata:p,isLoading:!o}),[A,w]=m.useState(""),{showToast:T,ToastComponent:R}=De(),H=r({label:"imagegen.listed"}),j=r({label:"imagegen.download"}),$=r({label:"imagegen.delete"}),L=Be(),q=async b=>{try{if(b.startsWith("file://"))return console.warn("Cannot fetch file:// URLs in browser. Metadata:",b),null;const N=await fetch(b);if(!N.ok)throw new Error(`Failed to fetch metadata: ${N.status}`);return await N.json()}catch(N){return console.error("Error fetching NFT metadata:",N),null}};m.useEffect(()=>{(async()=>{try{P(z=>({...z,isLoading:!0,error:void 0}));const F=await L.readContract({address:k.address,abi:k.abi,functionName:"tokenURI",args:[t]});if(!F&&(o||p)){P(z=>({...z,tokenURI:"",isLoading:!1}));return}let M="";i&&(M=await L.readContract({address:k.address,abi:k.abi,functionName:"ownerOf",args:[t]}),w(M));let se;if(!i)try{se=await Te(ye,{...k,functionName:"isTokenListed",args:[t]})}catch(z){console.warn("Could not load listing status:",z)}let re=p,oe=o;if(F){const z=await q(F);z&&(re=z,oe=z.image)}P({tokenId:t,tokenURI:F,metadata:re,imageUrl:oe,isLoading:!1,isListed:se})}catch(N){console.error(`Error loading NFT ${t}:`,N),P({tokenId:t,tokenURI:"",imageUrl:o,metadata:p,isLoading:!1,error:`Failed to load NFT #${t}: ${N instanceof Error?N.message:"Unknown error"}`})}})()},[t,i,o,p,L]);const{isLoading:W,isSuccess:S}=we({hash:v}),{isLoading:U,isSuccess:Y}=we({hash:B});m.useEffect(()=>{S&&setTimeout(()=>{n()},1e3)},[S,n]),m.useEffect(()=>{Y&&s&&T("Listing status updated successfully!","success")},[Y,s,T]);const te=()=>{l.imageUrl&&a({src:l.imageUrl,alt:l.metadata?.name||`Artwork #${l.tokenId}`,title:l.metadata?.name,description:l.metadata?.description})},K=async()=>{if(l.imageUrl)try{const N=await(await fetch(l.imageUrl)).blob(),F=window.URL.createObjectURL(N),M=document.createElement("a");M.href=F,M.download=`${l.metadata?.name||`Artwork-${l.tokenId}`}.png`,document.body.appendChild(M),M.click(),document.body.removeChild(M),window.URL.revokeObjectURL(F)}catch(b){console.error("Download failed:",b),T("Download failed. Please try again.","error")}},ae=async()=>{const N=`https://opensea.io/item/optimism/${k.address}/${l.tokenId}`;try{await navigator.clipboard.writeText(N),T("OpenSea URL copied to clipboard!","success")}catch(F){console.error("Failed to copy URL:",F),window.open(N,"_blank","noopener,noreferrer")}},pe=async()=>{if(!D){C(!0),T(`âš ï¸ Click Delete again to permanently remove "${l.metadata?.name||`Artwork #${l.tokenId}`}"`,"warning"),setTimeout(()=>{C(!1)},5e3);return}C(!1);try{await h({...k,functionName:"burn",args:[l.tokenId]})}catch(b){console.error("Delete failed:",b),T("Failed to delete artwork. Please try again.","error")}},ne=async()=>{if(!s)return;const b=!l.isListed,N=b?"public":"private";try{s(l.tokenId,b),await y({...k,functionName:"setTokenListed",args:[l.tokenId,b]})}catch(F){console.error("Failed to update listing status:",F),s(l.tokenId,!b),T(`Failed to set artwork as ${N}. Please try again.`,"error")}};return e.jsxs("div",{className:`${f.container} ${c?f.highlighted:""} group`,onClick:te,children:[l.isLoading?e.jsxs("div",{className:f.loadingContainer,children:[e.jsx("div",{className:Z}),e.jsx("p",{className:f.loadingText,children:"Loading artwork..."})]}):l.error?e.jsxs("div",{className:f.errorContainer,children:[e.jsx("div",{className:f.errorBox,children:e.jsx("p",{className:f.errorText,children:l.error})}),e.jsxs("p",{className:f.tokenIdText,children:["ID: ",l.tokenId.toString()]})]}):e.jsxs(e.Fragment,{children:[l.imageUrl?e.jsxs("div",{className:f.imageContainer,children:[e.jsx("img",{src:l.imageUrl,alt:l.metadata?.name||`Artwork #${l.tokenId}`,className:f.image,onError:b=>{const N=b.target;N.style.display="none",N.nextElementSibling.classList.remove("hidden")}}),e.jsx("div",{className:f.imageError,style:{display:"none"},children:"ðŸ“· Image not available"})]}):e.jsx("div",{className:f.imagePlaceholder,children:"ðŸ“· No image available"}),e.jsxs("div",{className:f.cornerBadge,children:["#",l.tokenId.toString()]}),!i&&l.isListed&&e.jsxs("div",{className:f.listedBadge,children:["âœ“ ",H]}),i&&A&&e.jsxs("div",{className:f.ownerBadge,children:["ðŸ‘¤ ",A.slice(0,6),"...",A.slice(-4)]}),e.jsx("div",{className:f.actionsOverlay,children:e.jsxs("div",{className:f.actions,children:[l.imageUrl&&e.jsx("button",{onClick:b=>{b.stopPropagation(),K()},className:f.compactSecondaryButton,title:`${j} image`,children:"â¬‡ï¸"}),l.imageUrl&&e.jsx("button",{onClick:b=>{b.stopPropagation(),te()},className:f.compactSecondaryButton,title:"View full size",children:"ðŸ”"}),e.jsx("button",{onClick:b=>{b.stopPropagation(),ae()},className:f.compactSecondaryButton,title:"Share artwork",children:"ðŸ“¤"}),!i&&s&&l.isListed!==void 0&&e.jsx("button",{onClick:b=>{b.stopPropagation(),ne()},disabled:I||U,className:f.compactSecondaryButton,title:`${l.isListed?"Make private":"Make public"}`,children:l.isListed?"ðŸ”“":"ðŸ”’"}),i&&e.jsx(ya,{genImTokenId:l.tokenId}),!i&&e.jsx("button",{onClick:b=>{b.stopPropagation(),pe()},disabled:x||W,className:f.compactSecondaryButton,title:`${$} artwork (permanent)`,style:{backgroundColor:x||W?"rgba(0,0,0,0.3)":"rgba(220, 38, 38, 0.8)",opacity:x||W?.6:1},children:x||W?"â³":"ðŸ—‘ï¸"})]})})]}),R]})}function Oe({image:t,onClose:a}){const{showToast:n,ToastComponent:s}=De();m.useEffect(()=>{const i=o=>{o.key==="Escape"&&a()};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[a]);const c=async()=>{try{const o=await(await fetch(t.src)).blob(),p=window.URL.createObjectURL(o),h=document.createElement("a");h.href=p,h.download=`${t.title||"NFT-image"}.png`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(p)}catch(i){console.error("Download failed:",i),n("Download failed. Please try again.","error")}};return e.jsxs("div",{className:f.modalOverlay,onClick:a,children:[e.jsxs("div",{className:f.modalContent,onClick:i=>i.stopPropagation(),children:[e.jsx("button",{className:f.modalClose,onClick:a,children:"âœ•"}),e.jsx("img",{src:t.src,alt:t.alt,className:f.modalImage}),(t.title||t.description)&&e.jsxs("div",{className:f.modalInfo,children:[t.title&&e.jsx("h3",{className:f.modalTitle,children:t.title}),t.description&&e.jsx("p",{className:f.modalDescription,children:t.description}),e.jsx("div",{className:f.actions,style:{justifyContent:"center",marginTop:"12px"},children:e.jsx("button",{onClick:c,className:`${f.actionButton} ${me}`,children:"â¬‡ï¸ Download Full Size"})})]})]}),s]})}function wa({newlyCreatedNFT:t,onNewNFTDisplayed:a}){const{address:n,isConnected:s}=ee(),c=ge(),[i,o]=m.useState([]),[p,h]=m.useState(!1),[x,v]=m.useState(null),[y,I]=m.useState(null),{data:B,isLoading:D}=he({...k,functionName:"balanceOf",args:n?[n]:void 0,chainId:c.id,query:{enabled:!!n&&s}}),C=m.useCallback(async()=>{if(!s||!n){o([]);return}h(!0);try{const w=await Te(ye,{...k,functionName:"balanceOf",args:[n]});if(!w||w===0n){o([]);return}const T=[];for(let j=0;j<Number(w);j++){const $=(async()=>{try{return await Te(ye,{...k,functionName:"tokenOfOwnerByIndex",args:[n,BigInt(j)]})}catch(L){return console.error(`Error loading token ID at index ${j}:`,L),0n}})();T.push($)}const H=(await Promise.all(T)).filter(j=>j>0n).sort((j,$)=>$>j?1:$<j?-1:0);o(H)}catch(w){console.error("Error loading token IDs:",w),o([])}finally{h(!1)}},[s,n]),l=m.useCallback(w=>{v(w),o(T=>T.includes(w)?T:[w,...T]),setTimeout(()=>{v(null),a?.()},5e3)},[a]),P=m.useCallback((w,T)=>{console.log(`NFT ${w} listing status changed to: ${T}`)},[]);m.useEffect(()=>{s&&n&&C()},[n,s,C]),m.useEffect(()=>{t&&l(t.tokenId)},[t,l]);const A=D||p;return s?A&&i.length===0?e.jsxs("div",{className:_.loadingContainer,children:[e.jsx("div",{className:Z}),e.jsx("p",{children:"Loading your artworks..."})]}):B===0n||!B?e.jsx("div",{className:_.emptyStateContainer,children:e.jsx("p",{className:_.emptyStateText,children:"You haven't created any artworks yet. Use the generator above to create your first one!"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:_.grid,children:i.map((w,T)=>{const R=t?.tokenId===w,H=R?t.imageUrl:void 0,j=R?t.metadata:void 0;return e.jsx(Me,{tokenId:w,onImageClick:I,onNftBurned:()=>C(),onListedStatusChanged:P,isHighlighted:x===w,isPublicView:!1,preloadedImageUrl:H,preloadedMetadata:j},`my-${w}-${T}`)})}),y&&e.jsx(Oe,{image:y,onClose:()=>I(null)})]}):e.jsxs("div",{className:_.walletPrompt,children:[e.jsx("h3",{children:"ðŸ”— Connect Your Wallet"}),e.jsx("p",{children:"To view and manage your personal NFT artworks, please connect your wallet using the button above."}),e.jsx("p",{children:"Your artworks are stored on the blockchain and linked to your wallet address."}),e.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9em",opacity:.8},children:"ðŸ’¡ Tip: You can explore public artworks from other users in the â€œAll Public Artworksâ€ tab without connecting your wallet."})]})}function Ta(){const[t,a]=m.useState([]),[n,s]=m.useState(!1),[c,i]=m.useState(null),o=Be(),p=m.useCallback(async()=>{s(!0);try{const h=await o.readContract({address:k.address,abi:k.abi,functionName:"getAllPublicTokens"});if(!h||h.length===0){a([]);return}const x=h.sort((v,y)=>y>v?1:y<v?-1:0);a(x)}catch(h){console.error("Error loading public token IDs:",h),a([])}finally{s(!1)}},[o]);return m.useEffect(()=>{p()},[p]),n&&t.length===0?e.jsxs("div",{className:_.loadingContainer,children:[e.jsx("div",{className:Z}),e.jsx("p",{children:"Loading public artworks..."})]}):t.length===0?e.jsx("div",{className:_.emptyStateContainer,children:e.jsx("p",{className:_.emptyStateText,children:"No public artworks available yet."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:_.grid,children:t.map((h,x)=>e.jsx(Me,{tokenId:h,onImageClick:i,onNftBurned:()=>{},isHighlighted:!1,isPublicView:!0},`public-${h}-${x}`))}),c&&e.jsx(Oe,{image:c,onClose:()=>i(null)})]})}function va({newlyCreatedNFT:t,onNewNFTDisplayed:a,activeTab:n,onTabChange:s}={}){const{address:c,isConnected:i}=ee(),[o,p]=m.useState(()=>i?"my":"public"),h=n??o,x=s??p,v=he({...k,functionName:"balanceOf",args:c?[c]:void 0,chainId:ge().id,query:{enabled:!!c&&i}}),{data:y,refetch:I}=v;m.useEffect(()=>{t&&I&&I()},[t,I]);const B=r({label:"imagegen.myArtworks"}),D=r({label:"imagegen.allPublicArtworks"});return e.jsxs("div",{className:_.container,children:[e.jsx("div",{className:G.container,children:e.jsxs("div",{className:G.tabList,children:[e.jsx(Re,{label:i?`${B} (${y?.toString()||"0"})`:B,isActive:h==="my",onClick:()=>x("my")}),e.jsx(Re,{label:D,isActive:h==="public",onClick:()=>x("public")})]})}),e.jsx("div",{className:`${G.tabPanel} ${h==="my"?"":G.hiddenPanel}`,children:e.jsx(wa,{newlyCreatedNFT:t,onNewNFTDisplayed:a})}),e.jsx("div",{className:`${G.tabPanel} ${h==="public"?"":G.hiddenPanel}`,children:e.jsx(Ta,{})})]})}function ja(){const{isConnected:t}=ee(),[a,n]=m.useState(null),[s,c]=m.useState(()=>t?"my":"public"),i=(x,v,y)=>{console.log("Image generation succeeded:",{tokenId:x,imageUrl:v,metadata:y}),n({tokenId:x,imageUrl:v,metadata:y}),t&&c("my")},o=x=>{console.error("Image generation failed:",x)},p=()=>{n(null)},h=x=>{c(x)};return e.jsxs("div",{className:Zt,children:[e.jsx(xa,{onSuccess:i,onError:o}),e.jsx(va,{newlyCreatedNFT:a??void 0,onNewNFTDisplayed:p,activeTab:s,onTabChange:h})]})}const Na=Object.freeze(Object.defineProperty({__proto__:null,default:ja},Symbol.toStringTag,{value:"Module"}));function Ca(){return"AI Image Generator | fretchen.eu"}const Sa=Object.freeze(Object.defineProperty({__proto__:null,title:Ca},Symbol.toStringTag,{value:"Module"})),za={hasServerOnlyHook:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!1}},isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:oa}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:ra}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:sa}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Na}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:na}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+title.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Sa}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:aa}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:ta}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:ea}}};export{za as configValuesSerialized};
