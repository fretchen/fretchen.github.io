import{r as s,d as A,j as e,c as o,F as D,i as _,W as F,L as G,a as R,b as $,o as L}from"../chunks/chunk-BrI07O8X.js";import{u as M,g as B,a as W,b as q}from"../chunks/chunk-BhgTFpt_.js";import{c as H,h as V,i as t,b as Y,e as O,s as J,l as K}from"../chunks/chunk-B2Ih5JAS.js";/* empty css                      */import"../chunks/chunk-DQ3hQvvF.js";/* empty css                      *//* empty css                      */const Q=async l=>new Promise((u,g)=>{const n=async()=>{try{const i=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[l]});i?u(i):setTimeout(n,2e3)}catch(i){g(i)}};n()});function X(){const l=W(),[u,g]=s.useState(),[n,i]=s.useState(),[d,E]=s.useState(""),[c,S]=s.useState(!1),[a,m]=s.useState("idle"),[w,p]=s.useState(null),{address:y,isConnected:h}=A(),j=B(),{data:N}=M({...l,functionName:"mintPrice",args:[],chainId:j.id}),{writeContractAsync:U}=q(),b=async()=>{if(!h||!y){p("Please connect your wallet first");return}if(!d.trim()){p("Please enter a prompt");return}if(!N){p("Could not load mint price from contract");return}S(!0),p(null),m("minting");try{const r=`ipfs://tempURI/${Date.now()}`,P=await U({...l,functionName:"safeMint",args:[r],value:N,chainId:j.id});console.log("Minting transaction sent:",P);const T=await Q(P),x=T==null?void 0:T.logs.find(z=>z.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!x||x.topics.length<4)throw new Error("Could not extract token ID from transaction");const k=x.topics[3],v=BigInt(k);console.log("Minted token ID:",v),i(v),m("generating");const f=await fetch(`https://mypersonaljscloudivnad9dy-readnft.functions.fnc.fr-par.scw.cloud?prompt=${encodeURIComponent(d)}&tokenId=${v}`);if(!f.ok)throw new Error(`Error: ${f.status} ${f.statusText}`);const C=await f.json();console.log("Image generation completed",C);const I=C.image_url;g(I),m("idle")}catch(r){console.error("Error:",r),p(r instanceof Error?r.message:"An unknown error occurred"),m("error")}finally{S(!1)}};return e.jsxs("div",{className:H,children:[e.jsx("h1",{className:V,children:"Decentral AI Image Generator"}),e.jsxs("div",{className:t.cardLayout,children:[e.jsxs("div",{className:t.column,children:[e.jsx("h2",{className:t.columnHeading,children:"Create Your Image"}),e.jsxs("div",{className:t.stepsList,children:[e.jsxs("div",{className:t.stepItem,children:[e.jsx("span",{className:t.stepNumber,children:"1"}),e.jsx("span",{children:"Enter a descriptive prompt below"})]}),e.jsxs("div",{className:t.stepItem,children:[e.jsx("span",{className:t.stepNumber,children:"2"}),e.jsx("span",{children:'Click "Mint & Generate" (costs ~10Â¢ in ETH)'})]}),e.jsxs("div",{className:t.stepItem,children:[e.jsx("span",{className:t.stepNumber,children:"3"}),e.jsx("span",{children:"Wait ~30s for your image to appear"})]})]}),e.jsx("textarea",{value:d,onChange:r=>E(r.target.value),placeholder:"Describe your image in detail... (e.g. 'A futuristic city skyline at sunset with flying cars')",disabled:c||a!=="idle",className:`${t.promptTextarea} ${c||a!=="idle"?o({opacity:.7}):""}`}),a!=="idle"&&e.jsxs("div",{className:t.statusIndicator,children:[e.jsxs("div",{className:t.statusRow,children:[e.jsx("div",{className:t.spinner}),e.jsx("span",{children:a==="minting"?"Creating your NFT...":"Generating your image..."})]}),e.jsx("div",{className:t.statusText,children:a==="minting"?"Confirm the transaction in your wallet":"This may take up to 30 seconds"})]}),e.jsx("button",{onClick:b,disabled:c||!d.trim()||!h||!y,className:`${Y} ${c||!d.trim()||!h||!y?o({opacity:.7,cursor:"not-allowed"}):""}`,children:c?a==="minting"?"Creating NFT...":"Generating Image...":"Mint & Generate"}),!h&&e.jsx("p",{className:o({fontSize:"sm",color:"#666",margin:"xs 0"}),children:"Connect your wallet to create an NFT"}),w&&e.jsx("div",{className:O,children:w})]}),e.jsxs("div",{className:t.column,children:[e.jsx("h2",{className:t.columnHeading,children:"Your Generated Image"}),e.jsx("div",{className:t.imagePreview,children:u?e.jsx("img",{src:u,alt:"Generated",className:t.generatedImage}):e.jsx(e.Fragment,{children:a!=="idle"?e.jsx("p",{className:o({fontWeight:"medium"}),children:a==="minting"?"Creating NFT...":"Generating your image..."}):e.jsx("p",{children:"Your image will appear here"})})}),n&&e.jsxs("div",{className:J,children:[e.jsx("h3",{className:o({margin:0,fontSize:"md"}),children:"ðŸŽ‰ NFT successfully created!"}),e.jsxs("p",{className:o({margin:"xs 0"}),children:[e.jsx("strong",{children:"Token ID:"})," ",n.toString()]}),e.jsx("a",{href:`https://optimistic.etherscan.io/token/${l.address}?a=${n}`,target:"_blank",rel:"noopener noreferrer",className:K,children:"View on Etherscan â†’"})]})]})]})]})}const Z=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),le={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:L}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:$}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:R}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Z}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:G}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:F}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:_}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:D}}};export{le as configValuesSerialized};
