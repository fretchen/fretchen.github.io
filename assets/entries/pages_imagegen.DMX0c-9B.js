import{r as l,e as E,j as e,f as t,g as d,h as F,k as G,s as R,l as $,c as L,m as B,F as W,i as q,W as H,L as V,a as Y,b as O,o as J}from"../chunks/chunk-DvPZXuhD.js";import{u as K,g as Q,a as X,b as Z}from"../chunks/chunk-BY1mnE9A.js";/* empty css                      */import"../chunks/chunk-DQ3hQvvF.js";/* empty css                      *//* empty css                      */const ee=async c=>new Promise((r,a)=>{const i=async()=>{try{const o=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[c]});o?r(o):setTimeout(i,2e3)}catch(o){a(o)}};i()});function te({apiUrl:c="https://mypersonaljscloudivnad9dy-readnft.functions.fnc.fr-par.scw.cloud",onSuccess:r,onError:a}){const i=X(),[o,U]=l.useState(),[x,b]=l.useState(),[h,z]=l.useState(""),[u,S]=l.useState(!1),[n,g]=l.useState("idle"),[j,p]=l.useState(null),{address:N,isConnected:T}=E(),P=Q(),{data:C}=K({...i,functionName:"mintPrice",args:[],chainId:P.id}),{writeContractAsync:A}=Z(),D=async()=>{if(!T||!N){const s="Please connect your wallet first";p(s),a==null||a(s);return}if(!h.trim()){const s="Please enter a prompt";p(s),a==null||a(s);return}if(!C){const s="Could not load mint price from contract";p(s),a==null||a(s);return}S(!0),p(null),g("minting");try{const s=`ipfs://tempURI/${Date.now()}`,m=await A({...i,functionName:"safeMint",args:[s],value:C,chainId:P.id});console.log("Minting transaction sent:",m);const v=await ee(m),w=v==null?void 0:v.logs.find(M=>M.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!w||w.topics.length<4)throw new Error("Could not extract token ID from transaction");const _=w.topics[3],f=BigInt(_);console.log("Minted token ID:",f),b(f),g("generating");const y=await fetch(`${c}?prompt=${encodeURIComponent(h)}&tokenId=${f}`);if(!y.ok)throw new Error(`Error: ${y.status} ${y.statusText}`);const I=await y.json();console.log("Image generation completed",I);const k=I.image_url;U(k),g("idle"),r==null||r(f,k)}catch(s){console.error("Error:",s);const m=s instanceof Error?s.message:"An unknown error occurred";p(m),g("error"),a==null||a(m)}finally{S(!1)}};return e.jsxs("div",{className:t.cardLayout,children:[e.jsxs("div",{className:t.column,children:[e.jsx("h2",{className:t.columnHeading,children:"Create Your Image"}),e.jsxs("div",{className:t.stepsList,children:[e.jsxs("div",{className:t.stepItem,children:[e.jsx("span",{className:t.stepNumber,children:"1"}),e.jsx("span",{children:"Enter a descriptive prompt below"})]}),e.jsxs("div",{className:t.stepItem,children:[e.jsx("span",{className:t.stepNumber,children:"2"}),e.jsx("span",{children:'Click "Mint & Generate" (costs ~10Â¢ in ETH)'})]}),e.jsxs("div",{className:t.stepItem,children:[e.jsx("span",{className:t.stepNumber,children:"3"}),e.jsx("span",{children:"Wait ~30s for your image to appear"})]})]}),e.jsx("textarea",{value:h,onChange:s=>z(s.target.value),placeholder:"Describe your image in detail... (e.g. 'A futuristic city skyline at sunset with flying cars')",disabled:u||n!=="idle",className:`${t.promptTextarea} ${u||n!=="idle"?d({opacity:.7}):""}`}),n!=="idle"&&e.jsxs("div",{className:t.statusIndicator,children:[e.jsxs("div",{className:t.statusRow,children:[e.jsx("div",{className:t.spinner}),e.jsx("span",{children:n==="minting"?"Creating your NFT...":"Generating your image..."})]}),e.jsx("div",{className:t.statusText,children:n==="minting"?"Confirm the transaction in your wallet":"This may take up to 30 seconds"})]}),e.jsx("button",{onClick:D,disabled:u,className:`${F} ${u||!h.trim()||!T||!N?d({opacity:.7,cursor:"not-allowed"}):""}`,children:u?n==="minting"?"Creating NFT...":"Generating Image...":"Mint & Generate"}),!T&&e.jsx("p",{className:d({fontSize:"sm",color:"#666",margin:"xs 0"}),children:"Connect your wallet to create an NFT"}),j&&e.jsx("div",{className:G,children:j})]}),e.jsxs("div",{className:t.column,children:[e.jsx("h2",{className:t.columnHeading,children:"Your Generated Image"}),e.jsx("div",{className:t.imagePreview,children:o?e.jsx("img",{src:o,alt:"Generated",className:t.generatedImage}):e.jsx(e.Fragment,{children:n!=="idle"?e.jsx("p",{className:d({fontWeight:"medium"}),children:n==="minting"?"Creating NFT...":"Generating your image..."}):e.jsx("p",{children:"Your image will appear here"})})}),x&&e.jsxs("div",{className:R,children:[e.jsx("h3",{className:d({margin:0,fontSize:"md"}),children:"ðŸŽ‰ NFT successfully created!"}),e.jsxs("p",{className:d({margin:"xs 0"}),children:[e.jsx("strong",{children:"Token ID:"})," ",x.toString()]}),e.jsx("a",{href:`https://optimistic.etherscan.io/token/${i.address}?a=${x}`,target:"_blank",rel:"noopener noreferrer",className:$,children:"View on Etherscan â†’"})]})]})]})}function ae(){const c=(a,i)=>{console.log("Image generation succeeded:",{tokenId:a,imageUrl:i})},r=a=>{console.error("Image generation failed:",a)};return e.jsxs("div",{className:L,children:[e.jsx("h1",{className:B,children:"Decentral AI Image Generator"}),e.jsx(te,{onSuccess:c,onError:r})]})}const se=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"})),ce={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:J}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:O}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Y}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:se}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:V}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:H}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:q}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:W}}};export{ce as configValuesSerialized};
