import{r as i,j as e,D as F,F as R,i as _,W as L,L as N,a as $,b as G,o as M}from"../chunks/chunk-Y1mneeJi.js";import{d as b,b as B,a as q,u as W}from"../chunks/chunk-BGqtppIp.js";/* empty css                      */import"../chunks/chunk-lek2_cOl.js";/* empty css                      */const H=async o=>new Promise((a,c)=>{const t=async()=>{try{const r=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[o]});r?a(r):setTimeout(t,2e3)}catch(r){c(r)}};t()});function V({onGenerate:o}){const[a,c]=i.useState(""),[t,r]=i.useState(!1),[s,l]=i.useState("idle"),[p,u]=i.useState(null),[S,E]=i.useState(void 0),{address:g,isConnected:h}=F(),w=q(),v=b(),{data:d}=B({...v,functionName:"mintPrice",args:[],chainId:w.id});console.log("2. Mint price:",d?d.toString():"Loading...");const j=d?parseFloat(d.toString())/1e18:void 0;console.log("3. Mint price in ETH:",j?j.toString():"Loading...");const{writeContractAsync:C}=W(),D=async()=>{if(!h||!g){u("Please connect your wallet first");return}if(!a.trim()){u("Please enter a prompt");return}if(!d){u("Could not load mint price from contract");return}r(!0),u(null),l("minting");try{const n=`ipfs://tempURI/${Date.now()}`,P=await C({...v,functionName:"safeMint",args:[n],value:d,chainId:w.id});console.log("Minting transaction sent:",P);const y=await H(P),T=y==null?void 0:y.logs.find(z=>z.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!T||T.topics.length<4)throw new Error("Could not extract token ID from transaction");const k=T.topics[3],f=BigInt(k);console.log("Minted token ID:",f),E(f),l("generating");const m=await fetch(`https://mypersonaljscloudivnad9dy-readnft.functions.fnc.fr-par.scw.cloud?prompt=${encodeURIComponent(a)}&tokenId=${f}`);if(!m.ok)throw new Error(`Error: ${m.status} ${m.statusText}`);const U=await m.json();console.log("Image generation completed");const I=U.image_url,x=await fetch(I);if(!x.ok)throw new Error(`Error retrieving the image: ${x.status} ${x.statusText}`);const A=(await x.json()).b64_image;o(A,f),l("idle")}catch(n){console.error("Error:",n),u(n instanceof Error?n.message:"An unknown error occurred"),l("error")}finally{r(!1)}};return e.jsx("div",{style:{padding:"20px"},children:e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px",flexDirection:"column"},children:[e.jsx("textarea",{value:a,onChange:n=>c(n.target.value),placeholder:"Describe your image...",disabled:t||s!=="idle",style:{padding:"8px",width:"300px",height:"150px",borderRadius:"4px",border:"1px solid #ccc",resize:"vertical",opacity:t||s!=="idle"?.7:1}}),e.jsx("button",{onClick:D,disabled:t||!a.trim()||!h||!g,style:{padding:"8px 16px",backgroundColor:"#0066cc",color:"white",border:"none",borderRadius:"4px",cursor:t||!a.trim()||!h||!g?"not-allowed":"pointer",width:"300px",opacity:t||!a.trim()||!h||!g?.7:1},children:t?s==="minting"?"NFT is being minted...":"Image is being generated...":"Mint & Generate"}),!h&&e.jsx("p",{style:{color:"#666"},children:"Connect your wallet to create an NFT"}),p&&e.jsx("p",{style:{color:"red",margin:"10px 0"},children:p}),S&&s==="idle"&&e.jsxs("p",{style:{color:"green"},children:["NFT successfully created! Token ID: ",S.toString()]})]})})}function O({imageBase64:o}){return e.jsx("div",{style:{width:"300px",height:"300px",border:"2px dashed #ccc",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20px"},children:o?e.jsx("img",{src:`data:image/jpeg;base64,${o}`,alt:"Generated",style:{maxWidth:"100%",maxHeight:"100%"}}):e.jsx("p",{style:{color:"#666"},children:"Your image will appear here"})})}function Y(){const o=b(),[a,c]=i.useState(),[t,r]=i.useState(),s=(l,p)=>{c(l),p&&r(p)};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Decentral AI Image Generator"}),e.jsx("p",{children:"Create your AI image and pay for it with ETH. The process:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Enter a prompt"}),e.jsx("li",{children:'Click on `"`Mint & Generate`"`'}),e.jsx("li",{children:"First an NFT is created, then the image is generated"})]}),e.jsx(V,{onGenerate:s}),e.jsx(O,{imageBase64:a}),t&&e.jsxs("div",{style:{marginTop:"20px",padding:"15px",border:"1px solid #28a745",borderRadius:"4px"},children:[e.jsx("h3",{children:"ðŸŽ‰ NFT successfully created!"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Token ID:"})," ",t.toString()]}),e.jsx("p",{children:e.jsxs("a",{href:`https://optimistic.etherscan.io/token/${o.address}?a=${t}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"none"},children:[" ","View on Etherscan â†’"]})})]})]})}const J=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"})),re={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:M}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:G}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:$}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:J}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:N}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:L}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:_}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:R}}};export{re as configValuesSerialized};
