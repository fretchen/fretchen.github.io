import{r as i,e as se,j as e,f as b,n,s as V,g as ce,h as X,k as R,t as M,l as q,R as re,m as J,q as ne,v as de,w as _,c as ue,F as me,i as he,W as pe,L as ge,a as fe,b as xe,o as ye}from"../chunks/chunk-BEUklOHK.js";import{u as oe,g as ie,a as Q,b as K,r as W,c as ee}from"../chunks/chunk-CJy6Tra2.js";/* empty css                      */import"../chunks/chunk-DQ3hQvvF.js";/* empty css                      *//* empty css                      */const we=async t=>new Promise((m,o)=>{const u=async()=>{try{const j=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[t]});j?m(j):setTimeout(u,2e3)}catch(j){o(j)}};u()});function ke({apiUrl:t="https://mypersonaljscloudivnad9dy-readnftv2.functions.fnc.fr-par.scw.cloud",onSuccess:m,onError:o}){const u=Q(),[j,h]=i.useState(),[p,U]=i.useState(),[g,S]=i.useState(""),[z,y]=i.useState("1024x1024"),[w,T]=i.useState(!1),[k,B]=i.useState(!1),[$,F]=i.useState("idle"),[O,L]=i.useState(null),{address:v,isConnected:P}=se(),I=ie(),{data:H}=oe({...u,functionName:"mintPrice",args:[],...(I==null?void 0:I.id)&&{chainId:I.id}}),{writeContractAsync:G}=K(),D=async()=>{if(!P||!v){const c="Please connect your account first";L(c),o==null||o(c);return}if(!g.trim()){const c="Please enter a prompt";L(c),o==null||o(c);return}if(!H){const c="Could not load creation fee from system";L(c),o==null||o(c);return}B(!0),L(null),F("minting");try{const c=`ipfs://tempURI/${Date.now()}`,E=await G({...u,functionName:"safeMint",args:[c,w],value:H,...(I==null?void 0:I.id)&&{chainId:I.id}});console.log("Minting transaction sent:",E);const s=await we(E),d=s==null?void 0:s.logs.find(x=>x.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!d||d.topics.length<4)throw new Error("Could not extract artwork ID from transaction");const N=d.topics[3],f=BigInt(N);console.log("Created artwork ID:",f),U(f),F("generating");const A=await fetch(`${t}?prompt=${encodeURIComponent(g)}&tokenId=${f}&size=${z}`);if(!A.ok)throw new Error(`Error: ${A.status} ${A.statusText}`);const r=await A.json();console.log("Image generation completed",r);const a=r.image_url;h(a),F("idle");const l={name:`AI Generated Artwork #${f}`,description:`AI generated artwork based on the prompt: "${g}"`,image:a,external_url:r.metadata_url||"",attributes:[{trait_type:"Prompt",value:g},{trait_type:"Generation Method",value:"AI Generated"}]};m==null||m(f,a,l),setTimeout(()=>{S(""),y("1024x1024"),h(void 0),U(void 0),L(null)},3e3)}catch(c){console.error("Error:",c);const E=c instanceof Error?c.message:"An unknown error occurred";L(E),F("error"),o==null||o(E)}finally{B(!1)}};return e.jsx("div",{className:b.compactLayout,children:e.jsxs("div",{className:b.compactContainer,children:[e.jsxs("div",{className:b.compactHeader,children:[e.jsx("h3",{className:b.compactTitle,children:"ðŸŽ¨ Create Your Digital Artwork"}),e.jsx("span",{className:b.compactSubtitle,children:"Describe your vision and generate a unique AI artwork for ~10Â¢. Your creation will be minted as an NFT on the blockchain."})]}),e.jsxs("div",{className:b.compactForm,children:[e.jsx("textarea",{value:g,onChange:c=>S(c.target.value),placeholder:"Describe your image in detail... (e.g., 'A futuristic city skyline at sunset with neon lights reflecting in the water')",disabled:k||$!=="idle",className:b.compactTextarea}),e.jsxs("div",{className:b.controlBar,children:[e.jsxs("div",{className:b.optionsGroup,children:[e.jsxs("select",{id:"imageSizeSelect",value:z,onChange:c=>y(c.target.value),disabled:k||$!=="idle",className:b.compactSelect,"aria-label":"Select image format for your artwork",children:[e.jsx("option",{value:"1024x1024",children:"â—¼ Square"}),e.jsx("option",{value:"1792x1024",children:"â–¬ Wide"})]}),e.jsxs("label",{className:n.checkboxLabel,title:w?"NFT will be publicly visible in the 'All Public Artworks' gallery":"NFT will remain unlisted from the 'All Public Artworks' gallery",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:c=>T(c.target.checked),disabled:k||$!=="idle",className:n.checkbox}),"Listed"]})]}),e.jsx("button",{onClick:D,disabled:k||!g.trim()||!P,className:`${b.compactButton} ${k||!g.trim()||!P?b.compactButtonDisabled:""}`,children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:V}),$==="minting"?"Creating...":"Generating..."]}):"ðŸŽ¨ Create Artwork"})]})]}),$!=="idle"&&e.jsxs("div",{className:b.compactStatus,children:[e.jsx("div",{className:V}),e.jsx("span",{children:$==="minting"?"Creating your artwork...":"Generating image..."})]}),!P&&e.jsx("div",{className:b.compactError,children:"Connect your account to create artwork"}),O&&e.jsx("div",{className:b.compactError,children:O}),p&&j&&e.jsxs("div",{className:ce,children:[e.jsx("h4",{className:X({margin:0,fontSize:"sm"}),children:"âœ… Artwork created successfully!"}),e.jsxs("p",{className:X({margin:"xs 0",fontSize:"sm"}),children:["ID: ",p.toString()," - Check your gallery below"]})]})]})})}function te({label:t,isActive:m,onClick:o}){return e.jsx("button",{className:`${M.tab} ${m?M.activeTab:""}`,onClick:o,children:t})}function Te({newlyCreatedNFT:t,onNewNFTDisplayed:m}={}){const{address:o,isConnected:u}=se(),j=ie(),h=Q(),[p,U]=i.useState("my"),[g,S]=i.useState([]),[z,y]=i.useState(!1),[w,T]=i.useState([]),[k,B]=i.useState(!1),[$,F]=i.useState(null),[O,L]=i.useState(null),{data:v,isLoading:P}=oe({...h,functionName:"balanceOf",args:o?[o]:void 0,chainId:j.id,query:{enabled:!!o&&u}}),I=async s=>{try{if(s.startsWith("file://"))return console.warn("Cannot fetch file:// URLs in browser. Metadata:",s),null;const d=await fetch(s);if(!d.ok)throw new Error(`Failed to fetch metadata: ${d.status}`);return await d.json()}catch(d){return console.error("Error fetching NFT metadata:",d),null}},H=async()=>{B(!0);try{const s=await W(q,{...h,functionName:"getAllPublicTokens"});if(!s||s.length===0){T([]);return}const d=s.map(r=>({tokenId:r,tokenURI:"",isLoading:!0,owner:""}));T(d);const N=s.map(async r=>{try{const a=await W(q,{...h,functionName:"ownerOf",args:[r]}),x=await W(q,{...h,functionName:"tokenURI",args:[r]}),Y=a,C=await I(x);return{tokenId:r,tokenURI:x,metadata:C||void 0,imageUrl:C==null?void 0:C.image,isLoading:!1,owner:Y}}catch(a){return console.error(`Error loading public NFT ${r}:`,a),{tokenId:r,tokenURI:"",isLoading:!1,error:`Failed to load NFT #${r}: ${a instanceof Error?a.message:"Unknown error"}`,owner:""}}}),A=(await Promise.all(N)).sort((r,a)=>r.error&&!a.error?1:!r.error&&a.error?-1:r.error&&a.error?0:a.tokenId>r.tokenId?1:a.tokenId<r.tokenId?-1:0);T(A)}catch(s){console.error("Error loading public NFTs:",s),T([])}finally{B(!1)}},G=async()=>{if(!u||!o){S([]);return}y(!0);try{const s=await W(q,{...h,functionName:"balanceOf",args:[o]});if(!s||s===0n){S([]);return}const d=Array.from({length:Number(s)},()=>({tokenId:0n,tokenURI:"",isLoading:!0}));S(d);const N=[];for(let r=0;r<Number(s);r++){const a=(async()=>{try{const x=await W(q,{...h,functionName:"tokenOfOwnerByIndex",args:[o,BigInt(r)]}),C=await W(q,{...h,functionName:"tokenURI",args:[x]}),le=await W(q,{...h,functionName:"isTokenListed",args:[x]}),Z=await I(C);return{tokenId:x,tokenURI:C,metadata:Z||void 0,imageUrl:Z==null?void 0:Z.image,isLoading:!1,isListed:le}}catch(l){return console.error(`Error loading NFT at index ${r}:`,l),{tokenId:0n,tokenURI:"",isLoading:!1,error:`Failed to load NFT #${r}: ${l instanceof Error?l.message:"Unknown error"}`}}})();N.push(a)}const A=(await Promise.all(N)).sort((r,a)=>r.error&&!a.error?1:!r.error&&a.error?-1:r.error&&a.error?0:a.tokenId>r.tokenId?1:a.tokenId<r.tokenId?-1:0);S(A)}catch(s){console.error("Error loading NFTs:",s),S([])}finally{y(!1)}},D=async(s,d)=>{S(N=>N.map(f=>f.tokenId===s?{...f,isListed:d}:f))};i.useEffect(()=>{p==="my"?u&&o&&G():p==="public"&&H()},[p,o,u,v]),i.useEffect(()=>{if(t){F(t.tokenId);const s={tokenId:t.tokenId,tokenURI:"",imageUrl:t.imageUrl,metadata:t.metadata,isLoading:!1,isListed:!1};S(d=>{const N=d.findIndex(f=>f.tokenId===t.tokenId);if(N!==-1){const f=[...d];return f[N]={...f[N],imageUrl:t.imageUrl,metadata:t.metadata},f}else return[s,...d]}),setTimeout(()=>{F(null),m==null||m()},5e3)}},[t,m]);const c=p==="my"&&(P||z),E=p==="public"&&k;return e.jsxs("div",{className:R.container,children:[e.jsx("div",{className:M.container,children:e.jsxs("div",{className:M.tabList,children:[e.jsx(te,{label:u?`My Artworks (${(v==null?void 0:v.toString())||"0"})`:"My Artworks",isActive:p==="my",onClick:()=>U("my")}),e.jsx(te,{label:"All Public Artworks",isActive:p==="public",onClick:()=>U("public")})]})}),e.jsx("div",{className:`${M.tabPanel} ${p==="my"?"":M.hiddenPanel}`,children:u?c&&g.length===0?e.jsxs("div",{className:R.loadingContainer,children:[e.jsx("div",{className:V}),e.jsx("p",{children:"Loading your artworks..."})]}):v===0n||!v?e.jsx("div",{className:R.emptyStateContainer,children:e.jsx("p",{className:R.emptyStateText,children:"You haven't created any artworks yet. Use the generator above to create your first one!"})}):e.jsx("div",{className:R.grid,children:g.map((s,d)=>e.jsx(ae,{nft:s,onImageClick:L,onNftBurned:()=>G(),onListedStatusChanged:D,isHighlighted:$===s.tokenId,isPublicView:!1},`my-${s.tokenId}-${d}`))}):e.jsxs("div",{className:R.walletPrompt,children:[e.jsx("h3",{children:"ðŸ”— Connect Your Wallet"}),e.jsx("p",{children:"To view and manage your personal NFT artworks, please connect your wallet using the button above."}),e.jsx("p",{children:"Your artworks are stored on the blockchain and linked to your wallet address."}),e.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9em",opacity:.8},children:"ðŸ’¡ Tip: You can explore public artworks from other users in the â€œAll Public Artworksâ€ tab without connecting your wallet."})]})}),e.jsx("div",{className:`${M.tabPanel} ${p==="public"?"":M.hiddenPanel}`,children:E&&w.length===0?e.jsxs("div",{className:R.loadingContainer,children:[e.jsx("div",{className:V}),e.jsx("p",{children:"Loading public artworks..."})]}):w.length===0?e.jsx("div",{className:R.emptyStateContainer,children:e.jsx("p",{className:R.emptyStateText,children:"No public artworks available yet."})}):e.jsx("div",{className:R.grid,children:w.map((s,d)=>e.jsx(ae,{nft:s,onImageClick:L,onNftBurned:()=>{},isHighlighted:!1,isPublicView:!0,owner:s.owner},`public-${s.tokenId}-${d}`))})}),O&&e.jsx(ve,{image:O,onClose:()=>L(null)})]})}function ae({nft:t,onImageClick:m,onNftBurned:o,onListedStatusChanged:u,isHighlighted:j=!1,isPublicView:h=!1,owner:p}){var f,A,r;const{writeContract:U,isPending:g,data:S}=K(),{writeContract:z,isPending:y,data:w}=K(),T=Q(),[k,B]=i.useState(!1),[$,F]=i.useState(""),[O,L]=i.useState("success"),v=re.useRef(null),{isLoading:P,isSuccess:I}=ee({hash:S}),{isLoading:H,isSuccess:G}=ee({hash:w});i.useEffect(()=>{I&&setTimeout(()=>{o()},1e3)},[I,o]),i.useEffect(()=>{G&&u&&D("Listing status updated successfully!","success")},[G,u]),i.useEffect(()=>()=>{v.current&&clearTimeout(v.current)},[]);const D=(a,l="error")=>{F(a),L(l),B(!0),v.current&&clearTimeout(v.current);const x=l==="error"?4e3:3e3;v.current=setTimeout(()=>{B(!1),v.current=null},x)},c=()=>{var a,l,x;t.imageUrl&&m({src:t.imageUrl,alt:((a=t.metadata)==null?void 0:a.name)||`Artwork #${t.tokenId}`,title:(l=t.metadata)==null?void 0:l.name,description:(x=t.metadata)==null?void 0:x.description})},E=async()=>{var a;if(t.imageUrl)try{const x=await(await fetch(t.imageUrl)).blob(),Y=window.URL.createObjectURL(x),C=document.createElement("a");C.href=Y,C.download=`${((a=t.metadata)==null?void 0:a.name)||`Artwork-${t.tokenId}`}.png`,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(Y)}catch(l){console.error("Download failed:",l),D("Download failed. Please try again.")}},s=async()=>{const l=`https://opensea.io/item/optimism/${T.address}/${t.tokenId}`;try{await navigator.clipboard.writeText(l),D("OpenSea URL copied to clipboard!","success")}catch(x){console.error("Failed to copy URL:",x),window.open(l,"_blank","noopener,noreferrer")}},d=async()=>{var a;if(confirm(`Are you sure you want to permanently delete "${((a=t.metadata)==null?void 0:a.name)||`Artwork #${t.tokenId}`}"? This action cannot be undone.`))try{await U({...T,functionName:"burn",args:[t.tokenId]})}catch(l){console.error("Delete failed:",l),D("Failed to delete artwork. Please try again.")}},N=async()=>{if(!u)return;const a=!t.isListed,l=a?"public":"private";try{u(t.tokenId,a),await z({...T,functionName:"setTokenListed",args:[t.tokenId,a]})}catch(x){console.error("Failed to update listing status:",x),u(t.tokenId,!a),D(`Failed to set artwork as ${l}. Please try again.`)}};return e.jsxs("div",{className:`${n.container} ${j?n.highlighted:""}`,children:[t.isLoading?e.jsxs("div",{className:n.loadingContainer,children:[e.jsx("div",{className:V}),e.jsx("p",{className:n.loadingText,children:"Loading artwork..."})]}):t.error?e.jsxs("div",{className:n.errorContainer,children:[e.jsx("div",{className:n.errorBox,children:e.jsx("p",{className:n.errorText,children:t.error})}),e.jsxs("p",{className:n.tokenIdText,children:["ID: ",t.tokenId.toString()]})]}):e.jsxs(e.Fragment,{children:[t.imageUrl?e.jsxs("div",{className:n.imageContainer,children:[e.jsx("img",{src:t.imageUrl,alt:((f=t.metadata)==null?void 0:f.name)||`Artwork #${t.tokenId}`,className:n.image,onClick:c,style:{cursor:"pointer"},onError:a=>{const l=a.target;l.style.display="none",l.nextElementSibling.classList.remove("hidden")}}),e.jsx("div",{className:n.imageError,style:{display:"none"},children:"Image not available"})]}):e.jsx("div",{className:n.imagePlaceholder,children:"No image available"}),e.jsx("h3",{className:n.title,children:((A=t.metadata)==null?void 0:A.name)||`Artwork #${t.tokenId}`}),((r=t.metadata)==null?void 0:r.description)&&e.jsx("p",{className:n.description,children:t.metadata.description}),e.jsxs("div",{className:n.footer,children:[e.jsxs("span",{children:["ID: ",t.tokenId.toString()]}),!h&&u&&t.isListed!==void 0&&e.jsxs("label",{className:n.checkboxLabel,title:`${t.isListed?"NFT is publicly listed":"NFT is private"}`,children:[e.jsx("input",{type:"checkbox",checked:t.isListed,onChange:N,disabled:y||H,className:n.checkbox}),"Listed"]}),h&&p&&e.jsxs("span",{title:`Owned by ${p}`,children:["Owner: ",p.slice(0,6),"...",p.slice(-4)]})]}),e.jsxs("div",{className:n.actions,children:[t.imageUrl&&e.jsx("button",{onClick:c,className:`${n.actionButton} ${J}`,title:"View full size",children:"ðŸ” Zoom"}),t.imageUrl&&e.jsx("button",{onClick:E,className:`${n.actionButton} ${ne}`,title:"Download image",children:"â¬‡ï¸ Download"}),e.jsx("button",{onClick:s,className:`${n.actionButton} ${J}`,title:"Share your artwork on the marketplace",children:"ðŸ“¤ Share"}),!h&&e.jsx("button",{onClick:d,disabled:g||P,className:`${n.actionButton} ${g||P?J:de}`,title:"Delete artwork (permanent)",style:{opacity:g||P?.6:1},children:g?"ðŸ—‘ï¸ Deleting...":P?"â³ Confirming...":"ðŸ—‘ï¸ Delete"})]})]}),k&&e.jsx("div",{className:_.container,children:e.jsxs("div",{className:_.content,children:[e.jsx("span",{className:_.icon,children:O==="success"?"âœ…":"âŒ"}),e.jsx("span",{className:_.message,children:$})]})})]})}function ve({image:t,onClose:m}){const[o,u]=i.useState(!1),[j,h]=i.useState(""),[p,U]=i.useState("success"),g=re.useRef(null);i.useEffect(()=>()=>{g.current&&clearTimeout(g.current)},[]);const S=(y,w="error")=>{h(y),U(w),u(!0),g.current&&clearTimeout(g.current);const T=w==="error"?4e3:3e3;g.current=setTimeout(()=>{u(!1),g.current=null},T)};i.useEffect(()=>{const y=w=>{w.key==="Escape"&&m()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[m]);const z=async()=>{try{const w=await(await fetch(t.src)).blob(),T=window.URL.createObjectURL(w),k=document.createElement("a");k.href=T,k.download=`${t.title||"NFT-image"}.png`,document.body.appendChild(k),k.click(),document.body.removeChild(k),window.URL.revokeObjectURL(T)}catch(y){console.error("Download failed:",y),S("Download failed. Please try again.")}};return e.jsxs("div",{className:n.modalOverlay,onClick:m,children:[e.jsxs("div",{className:n.modalContent,onClick:y=>y.stopPropagation(),children:[e.jsx("button",{className:n.modalClose,onClick:m,children:"âœ•"}),e.jsx("img",{src:t.src,alt:t.alt,className:n.modalImage}),(t.title||t.description)&&e.jsxs("div",{className:n.modalInfo,children:[t.title&&e.jsx("h3",{className:n.modalTitle,children:t.title}),t.description&&e.jsx("p",{className:n.modalDescription,children:t.description}),e.jsx("div",{className:n.actions,style:{justifyContent:"center",marginTop:"12px"},children:e.jsx("button",{onClick:z,className:`${n.actionButton} ${ne}`,children:"â¬‡ï¸ Download Full Size"})})]})]}),o&&e.jsx("div",{className:_.container,children:e.jsxs("div",{className:_.content,children:[e.jsx("span",{className:_.icon,children:p==="success"?"âœ…":"âŒ"}),e.jsx("span",{className:_.message,children:j})]})})]})}function Ne(){const[t,m]=i.useState(null),o=(h,p,U)=>{console.log("Image generation succeeded:",{tokenId:h,imageUrl:p,metadata:U}),m({tokenId:h,imageUrl:p,metadata:U})},u=h=>{console.error("Image generation failed:",h)},j=()=>{m(null)};return e.jsxs("div",{className:ue,children:[e.jsx(ke,{onSuccess:o,onError:u}),e.jsx(Te,{newlyCreatedNFT:t??void 0,onNewNFTDisplayed:j})]})}const be=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"})),Ae={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:ye}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:xe}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:fe}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:be}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:ge}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:pe}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:he}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:me}}};export{Ae as configValuesSerialized};
