import{bg as Ht,bh as Wt,bi as qt,a0 as Fe,r as m,a1 as Gt,D as u,j as e,u as Kt,bj as Yt,bk as Jt,bl as Qt,a3 as Vt,a6 as ae,bd as ze,a7 as Xt,a4 as o,aB as de,bm as O,bn as p,bo as te,bp as Zt,bq as ea,br as G,bs as le,a2 as Le,bt as ye,bu as W,v as ta,F as aa,a as na,W as sa,c as ra,d as oa,e as ia,o as ca}from"../chunks/chunk-KLFdlzZP.js";import{a as ue,g as I,e as Ee}from"../chunks/chunk-DEgiiinc.js";import{d as la}from"../chunks/chunk-t-pXVLBL.js";import{u as ge,a as me,b as we,r as Te}from"../chunks/chunk-DiYWcP6Z.js";import{u as Be}from"../chunks/chunk-CGhYUnM-.js";/* empty css                      *//* empty css                      */import"../chunks/chunk-CaXqtdqp.js";import"../chunks/chunk-k7VojDmK.js";let be=[];function Ae(t){const a=t.chains;return Ht(be,a)?be:(be=a,a)}async function da(t,a){const{addEthereumChainParameter:n,chainId:s}=a,l=t.state.connections.get(a.connector?.uid??t.state.current);if(l){const i=l.connector;if(!i.switchChain)throw new Wt({connector:i});return await i.switchChain({addEthereumChainParameter:n,chainId:s})}const c=t.chains.find(i=>i.id===s);if(!c)throw new qt;return t.setState(i=>({...i,chainId:s})),c}function ma(t,a){const{onChange:n}=a;return t._internal.chains.subscribe((s,l)=>{n(s,l)})}function ua(t){return{mutationFn(a){return da(t,a)},mutationKey:["switchChain"]}}function ga(t={}){const a=Fe(t);return m.useSyncExternalStore(n=>ma(a,{onChange:n}),()=>Ae(a),()=>Ae(a))}function ha(t={}){const{mutation:a}=t,n=Fe(t),s=ua(n),{mutate:l,mutateAsync:c,...i}=Gt({...a,...s});return{...i,chains:ga({config:n}),switchChain:l,switchChainAsync:c}}function $e({size:t="sm",className:a}){const n={xs:u({fontSize:"xs",lineHeight:"1"}),sm:u({fontSize:"sm",lineHeight:"1"}),md:u({fontSize:"md",lineHeight:"1"})},s=u({display:"inline-flex",alignItems:"center",justifyContent:"center",width:"1em",height:"1em",borderRadius:"50%",backgroundColor:"blue.100",color:"blue.600",fontWeight:"bold",cursor:"help"});return e.jsx("span",{className:`${s} ${n[t]} ${a||""}`,role:"img","aria-label":"Information",children:"i"})}function Re({label:t,locale:a}){const s=Kt(),l=a??s.locale??la,i=Yt(l==="de"?Jt:Qt,t);return e.jsx("span",{"data-locale":l,children:i})}const pa="https://mypersonaljscloudivnad9dy-genimgbfl.functions.fnc.fr-par.scw.cloud",fa=(t,a,n=1920)=>{const s=t/a;return t<=n&&a<=n?{width:t,height:a}:t>a?{width:n,height:Math.round(n/s)}:{width:Math.round(n*s),height:n}},xa=(t,a=1024)=>new Promise((n,s)=>{const l=document.createElement("canvas"),c=l.getContext("2d"),i=new Image;i.onload=()=>{const{width:f,height:h}=fa(i.width,i.height);if(l.width=f,l.height=h,!c){s(new Error("Could not get canvas context"));return}c.fillStyle="white",c.fillRect(0,0,f,h),c.drawImage(i,0,0,f,h);let x=.9;const v=()=>{const b=l.toDataURL("image/jpeg",x);b.length*.75/1024<=a||x<=.1?n({base64:b.split(",")[1],mimeType:"image/jpeg"}):(x-=.1,setTimeout(v,0))};v()},i.onerror=()=>s(new Error("Failed to load image")),i.src=URL.createObjectURL(t)}),ba=async t=>new Promise((a,n)=>{const s=async()=>{try{const l=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[t]});l?a(l):setTimeout(s,2e3)}catch(l){n(l)}};s()});function ya({apiUrl:t=pa,onSuccess:a,onError:n}){const{trackEvent:s}=Vt(),[l,c]=m.useState(),[i,f]=m.useState(),[h,x]=m.useState(),[v,b]=m.useState(null),[L,E]=m.useState("image/jpeg"),{address:_,isConnected:R}=ae(),[r,A]=m.useState("empty"),[C,T]=m.useState(""),[w,F]=m.useState("1024x1024"),[B,k]=m.useState(!1),[P,z]=m.useState(!1),[D,M]=m.useState("idle"),[K,N]=m.useState(null),q=ue(),J=ze(),{switchChain:he,isPending:Y}=ha(),{connectors:ne,connect:pe}=Xt(),{data:y}=ge({...I,functionName:"mintPrice",args:[],...q?.id&&{chainId:q.id}}),{writeContractAsync:j}=me(),$=async d=>new Promise((g,S)=>{const X=()=>{J===d?g():setTimeout(X,100)};setTimeout(()=>{S(new Error(Je))},1e4),X()}),H=()=>{ne.length>0&&pe({connector:ne[0]})},Q=o({label:"imagegen.connectWalletButton"}),se=o({label:"imagegen.enterPrompt"}),re=o({label:"imagegen.switchingNetwork"}),U=o({label:"imagegen.creating"}),_e=o({label:"imagegen.generating"}),ve=o({label:"imagegen.createArtwork"}),He=o({label:"imagegen.promptPlaceholder"}),We=o({label:"imagegen.editPromptPlaceholder"}),je=o({label:"imagegen.editImage"}),qe=o({label:"imagegen.connectAccountFirst"}),Ge=o({label:"imagegen.switchToOptimism"}),Ke=o({label:"imagegen.enterPromptError"}),Ye=o({label:"imagegen.loadMintPrice"}),Je=o({label:"imagegen.chainSwitchTimeout"}),Qe=o({label:"imagegen.extractTokenId"}),Ve=o({label:"imagegen.unknownError"}),Xe=o({label:"imagegen.uploadReferenceImage"}),Ze=o({label:"imagegen.dragDropHere"}),et=o({label:"imagegen.supportedFormats"}),tt=o({label:"imagegen.referenceImageTitle"}),at=o({label:"imagegen.generatedArtworkTitle"}),Ne=o({label:"imagegen.remove"}),nt=o({label:"imagegen.referenceImageAlt"}),st=o({label:"imagegen.generatedArtworkAlt"}),rt=o({label:"imagegen.referenceImageHint"}),ot=o({label:"imagegen.invalidFileType"}),it=o({label:"imagegen.fileTooLarge"}),ct=o({label:"imagegen.compressionFailed"}),lt=o({label:"imagegen.failedToProcessImage"}),dt=o({label:"imagegen.creatingArtwork"}),mt=o({label:"imagegen.generatingImage"}),ut=o({label:"imagegen.title"}),gt=o({label:"imagegen.collapsedTitle"}),ht=o({label:"imagegen.collapsedDescription"}),pt=o({label:"imagegen.square"}),ft=o({label:"imagegen.wide"}),xt=o({label:"imagegen.mintingInfo"}),bt=o({label:"imagegen.artworkCreated"}),yt=o({label:"imagegen.checkGallery"}),wt=o({label:"imagegen.switchingToOptimism"}),Tt=o({label:"imagegen.poweredBy"}),vt=o({label:"imagegen.viewContract"}),jt=o({label:"imagegen.learnMoreOptimism"}),Nt=o({label:"imagegen.viewContractEtherscan"}),Ct=()=>Y?"switching":P?"loading":C.trim()?"ready":"needsPrompt",Ce=d=>{switch(d){case"switching":return re;case"loading":return D==="minting"?U:_e;case"connect":return Q;case"needsPrompt":return se;case"ready":return r!=="empty"?je:ve;default:return r!=="empty"?je:ve}},V=Ct(),kt=()=>{const d=V==="needsPrompt",g=V==="loading"||V==="switching",S=()=>{s("imagegen-create-artwork-click",{hasReferenceImage:r!=="empty",promptLength:C.trim().length,isConnected:R,imageSize:w}),St()};return e.jsx("button",{onClick:S,disabled:d,className:`${de} ${d?ea:""}`,title:o({label:"imagegen.mintingInfo"}),"aria-describedby":"create-artwork-info",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:te}),Ce(V)]}):e.jsxs(e.Fragment,{children:["ðŸŽ¨ ",Ce(V),e.jsx($e,{size:"xs",className:u({ml:"1",opacity:"0.7"})})]})})},St=async()=>{if(!R||!_){const g=qe;N(g),n?.(g);return}const d=q?.id;if(d&&J!==d)try{N(wt),await he({chainId:d}),await $(d),N(null)}catch(g){console.error("Failed to switch chain:",g);const S=g instanceof Error?g.message:Ge;N(S),n?.(S);return}if(!C.trim()){const g=Ke;N(g),n?.(g);return}if(!y){const g=Ye;N(g),n?.(g);return}z(!0),N(null),M("minting");try{const S=await j({...I,functionName:"safeMint",args:["",B],value:y,...q?.id&&{chainId:q.id}});console.log("Minting transaction sent:",S);const fe=(await ba(S))?.logs.find(ie=>ie.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!fe||fe.topics.length<4)throw new Error(Qe);const Ft=fe.topics[3],Z=BigInt(Ft);console.log("Created artwork ID:",Z),f(Z),M("generating");const Ie=v!==null,zt=Ie?"edit":"generate",Pe={prompt:C,tokenId:Z.toString(),size:w,mode:zt};Ie&&v&&(Pe.referenceImage=v);const oe=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!oe.ok)throw new Error(`Error: ${oe.status} ${oe.statusText}`);const xe=await oe.json();console.log("Image generation completed",xe);const ee=xe.image_url;c(ee),x(ee),A("generated"),M("idle");try{const Dt=await(await fetch(ee)).blob(),Mt=(await new Promise((Ot,_t)=>{const ce=new FileReader;ce.onload=()=>Ot(ce.result),ce.onerror=_t,ce.readAsDataURL(Dt)})).split(",")[1];b(Mt)}catch(ie){console.warn("Failed to convert generated image to base64:",ie)}const Bt={name:`AI Generated Artwork #${Z}`,description:`AI generated artwork based on the prompt: "${C}"`,image:ee,external_url:xe.metadata_url||"",attributes:[{trait_type:"Prompt",value:C},{trait_type:"Generation Method",value:"AI Generated"}]};a?.(Z,ee,Bt),setTimeout(()=>{T(""),F("1024x1024"),c(void 0),f(void 0),N(null)},3e3)}catch(g){console.error("Error:",g);const S=g instanceof Error?g.message:Ve;N(S),M("error"),n?.(S)}finally{z(!1)}},It=o({label:"imagegen.mintingInfo"}),Pt=d=>["image/jpeg","image/png"].includes(d.type)?d.size>10485760?(N(it),!1):!0:(N(ot),!1),ke=async d=>{if(Pt(d)){N(null),z(!0);try{const g=await xa(d,1024);b(g.base64),E(g.mimeType),A("reference");const S=Math.round(d.size/1024),X=Math.round(g.base64.length*.75/1024);console.log(`Image compressed: ${S}KB â†’ ${X}KB (${d.type} â†’ ${g.mimeType})`)}catch(g){console.error("Image compression failed:",g);const S=g instanceof Error?g.message:lt;N(`${ct}: ${S}`)}finally{z(!1)}}},Lt=d=>{d.preventDefault(),d.stopPropagation()},Et=d=>{d.preventDefault(),d.stopPropagation()},At=d=>{d.preventDefault(),d.stopPropagation();const g=Array.from(d.dataTransfer.files);g.length>0&&ke(g[0])},$t=d=>{const g=d.target.files;g&&g.length>0&&ke(g[0])},Rt=()=>{b(null),E("image/jpeg");const d=document.getElementById("reference-image-input");d&&(d.value=""),A(h?"generated":"empty")},Se=w==="1792x1024"?"wide":"square",Ut=()=>{s("imagegen-connect-click"),H()};return e.jsx("div",{className:u({transition:"all 0.5s ease-in-out",overflow:"hidden"}),children:R?e.jsx("div",{className:O.compactLayout,children:e.jsxs("div",{className:O.compactContainer,children:[e.jsx("div",{className:O.compactHeader,children:e.jsxs("h3",{className:O.compactTitle,children:["ðŸŽ¨",e.jsx(Re,{label:"imagegen.title"})]})}),e.jsxs("div",{className:O.compactForm,children:[e.jsxs("div",{"data-testid":"drop-zone",className:u({mb:"4",border:"1px solid",borderColor:r==="empty"?"gray.300":"gray.400",borderRadius:"md",bg:r==="empty"?"gray.50":"white",position:"relative",cursor:r==="empty"?"pointer":"default",overflow:"hidden",width:"100%",_hover:r==="empty"?{borderColor:"gray.400",bg:"gray.100"}:{}}),onDragOver:Lt,onDragEnter:Et,onDrop:At,onClick:()=>{r==="empty"&&document.getElementById("reference-image-input")?.click()},children:[e.jsx("input",{id:"reference-image-input","data-testid":"reference-image-input",type:"file",accept:"image/*",onChange:$t,className:u({position:"absolute",opacity:0,width:0,height:0,pointerEvents:"none"})}),r==="empty"&&e.jsxs("div",{className:u({display:"flex",alignItems:"center",justifyContent:"center",py:"6",px:"4",gap:"3"}),children:[e.jsx("div",{className:u({fontSize:"xl",color:"gray.500"}),children:"ðŸ“¸"}),e.jsxs("div",{className:u({textAlign:"left"}),children:[e.jsx("h4",{className:u({fontSize:"sm",fontWeight:"medium",color:"gray.700",mb:"1"}),children:Xe}),e.jsxs("p",{className:u({fontSize:"xs",color:"gray.500",mb:"0"}),children:[Ze," â€¢ ",et]})]})]}),r==="reference"&&v&&e.jsxs("div",{className:u({p:"3"}),children:[e.jsxs("div",{className:u({display:"flex",justifyContent:"space-between",alignItems:"center",mb:"3"}),children:[e.jsx("h4",{className:u({fontSize:"sm",fontWeight:"medium",color:"gray.700",m:0}),children:tt}),e.jsxs("button",{onClick:d=>{d.stopPropagation(),Rt()},className:u({px:"2",py:"1",fontSize:"xs",bg:"gray.600",color:"white",border:"none",borderRadius:"sm",cursor:"pointer",_hover:{bg:"gray.700"}}),children:["âœ• ",Ne]})]}),e.jsx("div",{className:u({position:"relative",width:"100%",height:Se==="wide"?"250px":"200px",overflow:"hidden",borderRadius:"sm",bg:"gray.100"}),children:e.jsx("img",{src:`data:${L};base64,${v}`,alt:nt,className:u({width:"100%",height:"100%",objectFit:"contain",borderRadius:"sm"})})}),e.jsx("p",{className:u({fontSize:"xs",color:"gray.500",textAlign:"center",mt:"2",mb:"0"}),children:rt})]}),r==="generated"&&h&&e.jsxs("div",{className:u({p:"3"}),children:[e.jsxs("div",{className:u({display:"flex",justifyContent:"space-between",alignItems:"center",mb:"3"}),children:[e.jsx("h4",{className:u({fontSize:"sm",fontWeight:"medium",color:"gray.700",m:0}),children:at}),e.jsx("div",{className:u({display:"flex",gap:"2"}),children:e.jsxs("button",{onClick:()=>{b(null),E("image/jpeg"),x(void 0),A("empty");const d=document.getElementById("reference-image-input");d&&(d.value="")},className:u({px:"2",py:"1",fontSize:"xs",bg:"gray.600",color:"white",border:"none",borderRadius:"sm",cursor:"pointer",_hover:{bg:"gray.700"}}),disabled:P||D!=="idle",children:["âœ• ",Ne]})})]}),e.jsx("div",{className:u({position:"relative",width:"100%",height:Se==="wide"?"250px":"200px",overflow:"hidden",borderRadius:"sm",bg:"gray.100"}),children:e.jsx("img",{src:h,alt:st,className:u({width:"100%",height:"100%",objectFit:"contain",borderRadius:"sm"})})})]})]}),e.jsx("textarea",{value:C,onChange:d=>T(d.target.value),placeholder:r==="reference"?We:He,disabled:P||D!=="idle"||Y,className:O.compactTextarea}),e.jsxs("div",{className:O.controlBar,children:[e.jsxs("div",{className:O.optionsGroup,children:[e.jsxs("select",{id:"imageSizeSelect",value:w,onChange:d=>F(d.target.value),disabled:P||D!=="idle"||Y,className:O.compactSelect,"aria-label":"Select image format for your artwork",children:[e.jsx("option",{value:"1024x1024",children:pt}),e.jsx("option",{value:"1792x1024",children:ft})]}),e.jsxs("label",{className:p.checkboxLabel,title:B?"NFT will be publicly visible in the 'All Public Artworks' gallery":"NFT will remain unlisted from the 'All Public Artworks' gallery",children:[e.jsx("input",{type:"checkbox",checked:B,onChange:d=>k(d.target.checked),disabled:P||D!=="idle"||Y,className:p.checkbox}),e.jsx(Re,{label:"imagegen.listed"})]})]}),e.jsx(kt,{})]})]}),e.jsxs("div",{className:u({mt:"2",fontSize:"xs",color:"gray.600",textAlign:"center"}),children:[Tt," ",e.jsx("a",{href:"https://optimism.io",target:"_blank",rel:"noopener noreferrer","aria-label":jt,className:u({color:"blue.600",textDecoration:"underline",_hover:{color:"blue.800"}}),children:"Optimism"})," ","â€¢"," ",e.jsxs("a",{href:`https://optimistic.etherscan.io/address/${I.address}`,target:"_blank",rel:"noopener noreferrer","aria-label":Nt,className:u({color:"blue.600",textDecoration:"underline",_hover:{color:"blue.800"}}),children:[vt," â†—"]})]}),e.jsx("span",{id:"create-artwork-info",className:u({position:"absolute",left:"-9999px",top:"auto",width:"1px",height:"1px",overflow:"hidden"}),children:xt}),e.jsxs("div",{className:u({display:{base:"block",md:"none"},mt:"2",fontSize:"xs",color:"gray.600",textAlign:"center"}),children:[e.jsx($e,{size:"xs",className:u({mr:"1"})}),It]}),D!=="idle"&&e.jsxs("div",{className:O.compactStatus,children:[e.jsx("div",{className:te}),e.jsx("span",{children:D==="minting"?dt:mt})]}),K&&e.jsx("div",{className:O.compactError,children:K}),i&&l&&e.jsxs("div",{className:Zt,children:[e.jsx("h4",{className:u({margin:0,fontSize:"sm"}),children:bt}),e.jsxs("p",{className:u({margin:"xs 0",fontSize:"sm"}),children:["ID: ",i.toString()," - ",yt]})]})]})}):e.jsxs("div",{className:u({maxWidth:"500px",margin:"0 auto",textAlign:"center"}),children:[e.jsxs("h3",{className:u({fontSize:"2xl",fontWeight:"semibold",marginBottom:"4",color:"gray.800"}),children:["ðŸŽ¨ ",ut]}),e.jsx("div",{className:u({fontSize:"md",fontWeight:"medium",color:"gray.800",mb:"3",textAlign:"center"}),children:gt}),e.jsx("p",{className:u({fontSize:"sm",color:"gray.600",mb:"lg",lineHeight:"1.5"}),children:ht}),e.jsx("div",{className:u({display:"flex",justifyContent:"center"}),children:e.jsx("button",{onClick:Ut,onMouseEnter:()=>s("imagegen-connect-hover"),className:de,children:Q})})]})})}function Ue({label:t,isActive:a,onClick:n}){return e.jsx("button",{className:`${G.tab} ${a?G.activeTab:""}`,onClick:n,"aria-selected":a,children:t})}function wa({message:t,type:a,duration:n,onClose:s}){const l=m.useRef(null);m.useEffect(()=>{const f=n??(a==="error"?4e3:a==="warning"?5e3:3e3);return l.current=setTimeout(()=>{s()},f),()=>{l.current&&clearTimeout(l.current)}},[n,a,s]);const c=()=>{switch(a){case"success":return"âœ…";case"warning":return"âš ï¸";case"error":default:return"âŒ"}};return e.jsx("div",{className:le.container,children:e.jsxs("div",{className:le.content,"data-type":a,children:[e.jsx("span",{className:le.icon,children:c()}),e.jsx("span",{className:le.message,children:t})]})})}function De(){const[t,a]=m.useState(null),n=(c,i="error",f)=>{a({message:c,type:i,duration:f})},s=()=>{a(null)},l=t?e.jsx(wa,{message:t.message,type:t.type,duration:t.duration,onClose:s}):null;return{showToast:n,hideToast:s,ToastComponent:l}}function Ta({genImTokenId:t}){const{isConnected:a}=ae(),n=ze(),{writeContract:s,isPending:l,data:c}=me(),{isLoading:i,isSuccess:f}=we({hash:c}),h=ue(),x=n===h.id,v=o({label:"imagegen.collect"}),{data:b,error:L,isPending:E,refetch:_}=ge({...Ee,functionName:"getMintStats",args:[t],chainId:h.id}),R=async()=>{if(!a||!x||!b||!Array.isArray(b))return;const[,C]=b;s({...Ee,functionName:"mintCollectorNFT",args:[t],value:C})};m.useEffect(()=>{f&&setTimeout(()=>{_()},2e3)},[f,_]);const r=()=>{if(E)return"...";if(L||!b||!Array.isArray(b))return"0";const[C]=b;return C.toString()},A=()=>{if(E||L||!b||!Array.isArray(b))return"Price loading...";const[C,T]=b,w=Le(T),F=K=>{const N=parseFloat(K);return N>=.001?N.toFixed(3):N>=1e-4?N.toFixed(4):N.toFixed(6)},B=F(w),k=Number(C),P=Math.ceil((k+1)/5)*5,D=T/BigInt(2**Math.floor(k/5))*BigInt(2**Math.floor(P/5)),M=F(Le(D));return`Current price: ${B} ETH | Price after ${P} mints: ${M} ETH`};return e.jsx("button",{onClick:R,disabled:!a||l||i||!x,className:`${p.actionButton} ${de}`,title:`Collect this NFT (${r()} collected) | ${A()}`,children:l?"ðŸ“¦ Collecting...":f?"âœ… Collected!":`ðŸ“¦ ${v} (${r()})`})}function Me({tokenId:t,onImageClick:a,onNftBurned:n,onListedStatusChanged:s,isHighlighted:l=!1,isPublicView:c=!1,preloadedImageUrl:i,preloadedMetadata:f}){const{writeContract:h,isPending:x,data:v}=me(),{writeContract:b,isPending:L,data:E}=me(),[_,R]=m.useState(!1),[r,A]=m.useState({tokenId:t,tokenURI:"",imageUrl:i,metadata:f,isLoading:!i}),[C,T]=m.useState(""),{showToast:w,ToastComponent:F}=De(),B=o({label:"imagegen.listed"}),k=o({label:"imagegen.download"}),P=o({label:"imagegen.delete"}),z=Be(),D=async y=>{try{if(y.startsWith("file://"))return console.warn("Cannot fetch file:// URLs in browser. Metadata:",y),null;const j=await fetch(y);if(!j.ok)throw new Error(`Failed to fetch metadata: ${j.status}`);return await j.json()}catch(j){return console.error("Error fetching NFT metadata:",j),null}};m.useEffect(()=>{(async()=>{try{A(U=>({...U,isLoading:!0,error:void 0}));const $=await z.readContract({address:I.address,abi:I.abi,functionName:"tokenURI",args:[t]});if(!$&&(i||f)){A(U=>({...U,tokenURI:"",isLoading:!1}));return}let H="";c&&(H=await z.readContract({address:I.address,abi:I.abi,functionName:"ownerOf",args:[t]}),T(H));let Q;if(!c)try{Q=await Te(ye,{...I,functionName:"isTokenListed",args:[t]})}catch(U){console.warn("Could not load listing status:",U)}let se=f,re=i;if($){const U=await D($);U&&(se=U,re=U.image)}A({tokenId:t,tokenURI:$,metadata:se,imageUrl:re,isLoading:!1,isListed:Q})}catch(j){console.error(`Error loading NFT ${t}:`,j),A({tokenId:t,tokenURI:"",imageUrl:i,metadata:f,isLoading:!1,error:`Failed to load NFT #${t}: ${j instanceof Error?j.message:"Unknown error"}`})}})()},[t,c,i,f,z]);const{isLoading:M,isSuccess:K}=we({hash:v}),{isLoading:N,isSuccess:q}=we({hash:E});m.useEffect(()=>{K&&setTimeout(()=>{n()},1e3)},[K,n]),m.useEffect(()=>{q&&s&&w("Listing status updated successfully!","success")},[q,s,w]);const J=()=>{r.imageUrl&&a({src:r.imageUrl,alt:r.metadata?.name||`Artwork #${r.tokenId}`,title:r.metadata?.name,description:r.metadata?.description})},he=async()=>{if(r.imageUrl)try{const j=await(await fetch(r.imageUrl)).blob(),$=window.URL.createObjectURL(j),H=document.createElement("a");H.href=$,H.download=`${r.metadata?.name||`Artwork-${r.tokenId}`}.png`,document.body.appendChild(H),H.click(),document.body.removeChild(H),window.URL.revokeObjectURL($)}catch(y){console.error("Download failed:",y),w("Download failed. Please try again.","error")}},Y=async()=>{const j=`https://opensea.io/item/optimism/${I.address}/${r.tokenId}`;try{await navigator.clipboard.writeText(j),w("OpenSea URL copied to clipboard!","success")}catch($){console.error("Failed to copy URL:",$),window.open(j,"_blank","noopener,noreferrer")}},ne=async()=>{if(!_){R(!0),w(`âš ï¸ Click Delete again to permanently remove "${r.metadata?.name||`Artwork #${r.tokenId}`}"`,"warning"),setTimeout(()=>{R(!1)},5e3);return}R(!1);try{await h({...I,functionName:"burn",args:[r.tokenId]})}catch(y){console.error("Delete failed:",y),w("Failed to delete artwork. Please try again.","error")}},pe=async()=>{if(!s)return;const y=!r.isListed,j=y?"public":"private";try{s(r.tokenId,y),await b({...I,functionName:"setTokenListed",args:[r.tokenId,y]})}catch($){console.error("Failed to update listing status:",$),s(r.tokenId,!y),w(`Failed to set artwork as ${j}. Please try again.`,"error")}};return e.jsxs("div",{className:`${p.container} ${l?p.highlighted:""} group`,onClick:J,children:[r.isLoading?e.jsxs("div",{className:p.loadingContainer,children:[e.jsx("div",{className:te}),e.jsx("p",{className:p.loadingText,children:"Loading artwork..."})]}):r.error?e.jsxs("div",{className:p.errorContainer,children:[e.jsx("div",{className:p.errorBox,children:e.jsx("p",{className:p.errorText,children:r.error})}),e.jsxs("p",{className:p.tokenIdText,children:["ID: ",r.tokenId.toString()]})]}):e.jsxs(e.Fragment,{children:[r.imageUrl?e.jsxs("div",{className:p.imageContainer,children:[e.jsx("img",{src:r.imageUrl,alt:r.metadata?.name||`Artwork #${r.tokenId}`,className:p.image,onError:y=>{const j=y.target;j.style.display="none",j.nextElementSibling.classList.remove("hidden")}}),e.jsx("div",{className:p.imageError,style:{display:"none"},children:"ðŸ“· Image not available"})]}):e.jsx("div",{className:p.imagePlaceholder,children:"ðŸ“· No image available"}),e.jsxs("div",{className:p.cornerBadge,children:["#",r.tokenId.toString()]}),!c&&r.isListed&&e.jsxs("div",{className:p.listedBadge,children:["âœ“ ",B]}),c&&C&&e.jsxs("div",{className:p.ownerBadge,children:["ðŸ‘¤ ",C.slice(0,6),"...",C.slice(-4)]}),e.jsx("div",{className:p.actionsOverlay,children:e.jsxs("div",{className:p.actions,children:[r.imageUrl&&e.jsx("button",{onClick:y=>{y.stopPropagation(),he()},className:p.compactSecondaryButton,title:`${k} image`,children:"â¬‡ï¸"}),r.imageUrl&&e.jsx("button",{onClick:y=>{y.stopPropagation(),J()},className:p.compactSecondaryButton,title:"View full size",children:"ðŸ”"}),e.jsx("button",{onClick:y=>{y.stopPropagation(),Y()},className:p.compactSecondaryButton,title:"Share artwork",children:"ðŸ“¤"}),!c&&s&&r.isListed!==void 0&&e.jsx("button",{onClick:y=>{y.stopPropagation(),pe()},disabled:L||N,className:p.compactSecondaryButton,title:`${r.isListed?"Make private":"Make public"}`,children:r.isListed?"ðŸ”“":"ðŸ”’"}),c&&e.jsx(Ta,{genImTokenId:r.tokenId}),!c&&e.jsx("button",{onClick:y=>{y.stopPropagation(),ne()},disabled:x||M,className:p.compactSecondaryButton,title:`${P} artwork (permanent)`,style:{backgroundColor:x||M?"rgba(0,0,0,0.3)":"rgba(220, 38, 38, 0.8)",opacity:x||M?.6:1},children:x||M?"â³":"ðŸ—‘ï¸"})]})})]}),F]})}function Oe({image:t,onClose:a}){const{showToast:n,ToastComponent:s}=De();m.useEffect(()=>{const c=i=>{i.key==="Escape"&&a()};return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[a]);const l=async()=>{try{const i=await(await fetch(t.src)).blob(),f=window.URL.createObjectURL(i),h=document.createElement("a");h.href=f,h.download=`${t.title||"NFT-image"}.png`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(f)}catch(c){console.error("Download failed:",c),n("Download failed. Please try again.","error")}};return e.jsxs("div",{className:p.modalOverlay,onClick:a,children:[e.jsxs("div",{className:p.modalContent,onClick:c=>c.stopPropagation(),children:[e.jsx("button",{className:p.modalClose,onClick:a,children:"âœ•"}),e.jsx("img",{src:t.src,alt:t.alt,className:p.modalImage}),(t.title||t.description)&&e.jsxs("div",{className:p.modalInfo,children:[t.title&&e.jsx("h3",{className:p.modalTitle,children:t.title}),t.description&&e.jsx("p",{className:p.modalDescription,children:t.description}),e.jsx("div",{className:p.actions,style:{justifyContent:"center",marginTop:"12px"},children:e.jsx("button",{onClick:l,className:`${p.actionButton} ${de}`,children:"â¬‡ï¸ Download Full Size"})})]})]}),s]})}function va({newlyCreatedNFT:t,onNewNFTDisplayed:a}){const{address:n,isConnected:s}=ae(),l=ue(),[c,i]=m.useState([]),[f,h]=m.useState(!1),[x,v]=m.useState(null),[b,L]=m.useState(null),{data:E,isLoading:_}=ge({...I,functionName:"balanceOf",args:n?[n]:void 0,chainId:l.id,query:{enabled:!!n&&s}}),R=m.useCallback(async()=>{if(!s||!n){i([]);return}h(!0);try{const T=await Te(ye,{...I,functionName:"balanceOf",args:[n]});if(!T||T===0n){i([]);return}const w=[];for(let k=0;k<Number(T);k++){const P=(async()=>{try{return await Te(ye,{...I,functionName:"tokenOfOwnerByIndex",args:[n,BigInt(k)]})}catch(z){return console.error(`Error loading token ID at index ${k}:`,z),0n}})();w.push(P)}const B=(await Promise.all(w)).filter(k=>k>0n).sort((k,P)=>P>k?1:P<k?-1:0);i(B)}catch(T){console.error("Error loading token IDs:",T),i([])}finally{h(!1)}},[s,n]),r=m.useCallback(T=>{v(T),i(w=>w.includes(T)?w:[T,...w]),setTimeout(()=>{v(null),a?.()},5e3)},[a]),A=m.useCallback((T,w)=>{console.log(`NFT ${T} listing status changed to: ${w}`)},[]);m.useEffect(()=>{s&&n&&R()},[n,s,R]),m.useEffect(()=>{t&&r(t.tokenId)},[t,r]);const C=_||f;return s?C&&c.length===0?e.jsxs("div",{className:W.loadingContainer,children:[e.jsx("div",{className:te}),e.jsx("p",{children:"Loading your artworks..."})]}):E===0n||!E?e.jsx("div",{className:W.emptyStateContainer,children:e.jsx("p",{className:W.emptyStateText,children:"You haven't created any artworks yet. Use the generator above to create your first one!"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:W.grid,children:c.map((T,w)=>{const F=t?.tokenId===T,B=F?t.imageUrl:void 0,k=F?t.metadata:void 0;return e.jsx(Me,{tokenId:T,onImageClick:L,onNftBurned:()=>R(),onListedStatusChanged:A,isHighlighted:x===T,isPublicView:!1,preloadedImageUrl:B,preloadedMetadata:k},`my-${T}-${w}`)})}),b&&e.jsx(Oe,{image:b,onClose:()=>L(null)})]}):e.jsxs("div",{className:W.walletPrompt,children:[e.jsx("h3",{children:"ðŸ”— Connect Your Wallet"}),e.jsx("p",{children:"To view and manage your personal NFT artworks, please connect your wallet using the button above."}),e.jsx("p",{children:"Your artworks are stored on the blockchain and linked to your wallet address."}),e.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9em",opacity:.8},children:"ðŸ’¡ Tip: You can explore public artworks from other users in the â€œAll Public Artworksâ€ tab without connecting your wallet."})]})}function ja(){const[t,a]=m.useState([]),[n,s]=m.useState(!1),[l,c]=m.useState(null),i=Be(),f=m.useCallback(async()=>{s(!0);try{const h=await i.readContract({address:I.address,abi:I.abi,functionName:"getAllPublicTokens"});if(!h||h.length===0){a([]);return}const x=h.sort((v,b)=>b>v?1:b<v?-1:0);a(x)}catch(h){console.error("Error loading public token IDs:",h),a([])}finally{s(!1)}},[i]);return m.useEffect(()=>{f()},[f]),n&&t.length===0?e.jsxs("div",{className:W.loadingContainer,children:[e.jsx("div",{className:te}),e.jsx("p",{children:"Loading public artworks..."})]}):t.length===0?e.jsx("div",{className:W.emptyStateContainer,children:e.jsx("p",{className:W.emptyStateText,children:"No public artworks available yet."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:W.grid,children:t.map((h,x)=>e.jsx(Me,{tokenId:h,onImageClick:c,onNftBurned:()=>{},isHighlighted:!1,isPublicView:!0},`public-${h}-${x}`))}),l&&e.jsx(Oe,{image:l,onClose:()=>c(null)})]})}function Na({newlyCreatedNFT:t,onNewNFTDisplayed:a,activeTab:n,onTabChange:s}={}){const{address:l,isConnected:c}=ae(),[i,f]=m.useState(()=>c?"my":"public"),h=n??i,x=s??f,v=ge({...I,functionName:"balanceOf",args:l?[l]:void 0,chainId:ue().id,query:{enabled:!!l&&c}}),{data:b,refetch:L}=v;m.useEffect(()=>{t&&L&&L()},[t,L]);const E=o({label:"imagegen.myArtworks"}),_=o({label:"imagegen.allPublicArtworks"});return e.jsxs("div",{className:W.container,children:[e.jsx("div",{className:G.container,children:e.jsxs("div",{className:G.tabList,children:[e.jsx(Ue,{label:c?`${E} (${b?.toString()||"0"})`:E,isActive:h==="my",onClick:()=>x("my")}),e.jsx(Ue,{label:_,isActive:h==="public",onClick:()=>x("public")})]})}),e.jsx("div",{className:`${G.tabPanel} ${h==="my"?"":G.hiddenPanel}`,children:e.jsx(va,{newlyCreatedNFT:t,onNewNFTDisplayed:a})}),e.jsx("div",{className:`${G.tabPanel} ${h==="public"?"":G.hiddenPanel}`,children:e.jsx(ja,{})})]})}function Ca(){const{isConnected:t}=ae(),[a,n]=m.useState(null),[s,l]=m.useState(()=>t?"my":"public"),c=(x,v,b)=>{console.log("Image generation succeeded:",{tokenId:x,imageUrl:v,metadata:b}),n({tokenId:x,imageUrl:v,metadata:b}),t&&l("my")},i=x=>{console.error("Image generation failed:",x)},f=()=>{n(null)},h=x=>{l(x)};return e.jsxs("div",{className:ta,children:[e.jsx(ya,{onSuccess:c,onError:i}),e.jsx(Na,{newlyCreatedNFT:a??void 0,onNewNFTDisplayed:f,activeTab:s,onTabChange:h})]})}const ka=Object.freeze(Object.defineProperty({__proto__:null,default:Ca},Symbol.toStringTag,{value:"Module"}));function Sa(){return"AI Image Generator | fretchen.eu"}const Ia=Object.freeze(Object.defineProperty({__proto__:null,title:Sa},Symbol.toStringTag,{value:"Module"})),Da={hasServerOnlyHook:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!1}},isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:ca}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:ia}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:oa}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:ka}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:ra}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+title.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Ia}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:sa}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:na}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:aa}}};export{Da as configValuesSerialized};
