import{r as d,e as W,j as e,f as y,s as z,g as X,h as G,n as R,k as M,R as H,l as o,m as _,q as V,t as ee,v as A,c as te,w as ae,F as se,i as oe,W as re,L as ne,a as ie,b as ce,o as le}from"../chunks/chunk-EeCUCye7.js";import{u as Y,g as Z,a as q,b as J,r as O,c as de}from"../chunks/chunk-CAwQi4ep.js";/* empty css                      */import"../chunks/chunk-DQ3hQvvF.js";/* empty css                      *//* empty css                      */const ue=async t=>new Promise((u,s)=>{const h=async()=>{try{const w=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[t]});w?u(w):setTimeout(h,2e3)}catch(w){s(w)}};h()});function me({apiUrl:t="https://mypersonaljscloudivnad9dy-readnftv2.functions.fnc.fr-par.scw.cloud",onSuccess:u,onError:s}){const h=q(),[w,m]=d.useState(),[j,g]=d.useState(),[p,b]=d.useState(""),[P,f]=d.useState("1024x1024"),[x,C]=d.useState(!1),[n,S]=d.useState("idle"),[L,T]=d.useState(null),{address:$,isConnected:l}=W(),i=Z(),{data:N}=Y({...h,functionName:"mintPrice",args:[],...(i==null?void 0:i.id)&&{chainId:i.id}}),{writeContractAsync:I}=J(),D=async()=>{if(!l||!$){const a="Please connect your account first";T(a),s==null||s(a);return}if(!p.trim()){const a="Please enter a prompt";T(a),s==null||s(a);return}if(!N){const a="Could not load creation fee from system";T(a),s==null||s(a);return}C(!0),T(null),S("minting");try{const a=`ipfs://tempURI/${Date.now()}`,r=await I({...h,functionName:"safeMint",args:[a],value:N,...(i==null?void 0:i.id)&&{chainId:i.id}});console.log("Minting transaction sent:",r);const c=await ue(r),k=c==null?void 0:c.logs.find(Q=>Q.topics[0]==="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef");if(!k||k.topics.length<4)throw new Error("Could not extract artwork ID from transaction");const E=k.topics[3],v=BigInt(E);console.log("Created artwork ID:",v),g(v),S("generating");const U=await fetch(`${t}?prompt=${encodeURIComponent(p)}&tokenId=${v}&size=${P}`);if(!U.ok)throw new Error(`Error: ${U.status} ${U.statusText}`);const F=await U.json();console.log("Image generation completed",F);const B=F.image_url;m(B),S("idle");const K={name:`AI Generated Artwork #${v}`,description:`AI generated artwork based on the prompt: "${p}"`,image:B,external_url:F.metadata_url||"",attributes:[{trait_type:"Prompt",value:p},{trait_type:"Generation Method",value:"AI Generated"}]};u==null||u(v,B,K),setTimeout(()=>{b(""),f("1024x1024"),m(void 0),g(void 0),T(null)},3e3)}catch(a){console.error("Error:",a);const r=a instanceof Error?a.message:"An unknown error occurred";T(r),S("error"),s==null||s(r)}finally{C(!1)}};return e.jsx("div",{className:y.compactLayout,children:e.jsxs("div",{className:y.compactContainer,children:[e.jsxs("div",{className:y.compactHeader,children:[e.jsx("h3",{className:y.compactTitle,children:"🎨 Create Your Digital Artwork"}),e.jsx("span",{className:y.compactSubtitle,children:"Describe your vision and generate a unique AI artwork for ~10¢. Your creation will be minted as an NFT on the blockchain."})]}),e.jsxs("div",{className:y.compactForm,children:[e.jsx("textarea",{value:p,onChange:a=>b(a.target.value),placeholder:"Describe your image in detail... (e.g., 'A futuristic city skyline at sunset with neon lights reflecting in the water')",disabled:x||n!=="idle",className:y.compactTextarea}),e.jsxs("div",{className:y.compactFormRow,children:[e.jsxs("select",{id:"imageSizeSelect",value:P,onChange:a=>f(a.target.value),disabled:x||n!=="idle",className:y.compactSelect,"aria-label":"Select image format for your artwork",children:[e.jsx("option",{value:"1024x1024",children:"◼ Square"}),e.jsx("option",{value:"1792x1024",children:"▬ Wide"})]}),e.jsx("button",{onClick:D,disabled:x||!p.trim()||!l,className:`${y.compactButton} ${x||!p.trim()||!l?y.compactButtonDisabled:""}`,children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:z}),n==="minting"?"Creating...":"Generating..."]}):"🎨 Create Artwork"})]})]}),n!=="idle"&&e.jsxs("div",{className:y.compactStatus,children:[e.jsx("div",{className:z}),e.jsx("span",{children:n==="minting"?"Creating your artwork...":"Generating image..."})]}),!l&&e.jsx("div",{className:y.compactError,children:"Connect your account to create artwork"}),L&&e.jsx("div",{className:y.compactError,children:L}),j&&w&&e.jsxs("div",{className:X,children:[e.jsx("h4",{className:G({margin:0,fontSize:"sm"}),children:"✅ Artwork created successfully!"}),e.jsxs("p",{className:G({margin:"xs 0",fontSize:"sm"}),children:["ID: ",j.toString()," - Check your gallery below"]})]})]})})}function he({newlyCreatedNFT:t,onNewNFTDisplayed:u}={}){const{address:s,isConnected:h}=W(),w=Z(),m=q(),[j,g]=d.useState([]),[p,b]=d.useState(!1),[P,f]=d.useState(null),[x,C]=d.useState(null),{data:n,isLoading:S}=Y({...m,functionName:"balanceOf",args:s?[s]:void 0,chainId:w.id,query:{enabled:!!s&&h}}),L=async l=>{try{if(l.startsWith("file://"))return console.warn("Cannot fetch file:// URLs in browser. Metadata:",l),null;const i=await fetch(l);if(!i.ok)throw new Error(`Failed to fetch metadata: ${i.status}`);return await i.json()}catch(i){return console.error("Error fetching NFT metadata:",i),null}},T=async()=>{if(!h||!s){g([]);return}b(!0);try{const l=await O(M,{...m,functionName:"balanceOf",args:[s]});if(!l||l===0n){g([]);return}const i=Array.from({length:Number(l)},()=>({tokenId:0n,tokenURI:"",isLoading:!0}));g(i);const N=[];for(let a=0;a<Number(l);a++){const r=(async()=>{try{const k=await O(M,{...m,functionName:"tokenOfOwnerByIndex",args:[s,BigInt(a)]}),v=await O(M,{...m,functionName:"tokenURI",args:[k]}),U=await L(v);return{tokenId:k,tokenURI:v,metadata:U||void 0,imageUrl:U==null?void 0:U.image,isLoading:!1}}catch(c){return console.error(`Error loading NFT at index ${a}:`,c),{tokenId:0n,tokenURI:"",isLoading:!1,error:`Failed to load NFT #${a}: ${c instanceof Error?c.message:"Unknown error"}`}}})();N.push(r)}const D=(await Promise.all(N)).sort((a,r)=>a.error&&!r.error?1:!a.error&&r.error?-1:a.error&&r.error?0:Number(r.tokenId-a.tokenId));g(D)}catch(l){console.error("Error loading NFTs:",l),g([])}finally{b(!1)}};if(d.useEffect(()=>{h&&s&&T()},[s,h,n]),d.useEffect(()=>{if(t){f(t.tokenId);const l={tokenId:t.tokenId,tokenURI:"",imageUrl:t.imageUrl,metadata:t.metadata,isLoading:!1};g(i=>{const N=i.findIndex(I=>I.tokenId===t.tokenId);if(N!==-1){const I=[...i];return I[N]={...I[N],imageUrl:t.imageUrl,metadata:t.metadata},I}else return[l,...i]}),setTimeout(()=>{f(null),u==null||u()},5e3)}},[t,u]),!h)return e.jsx("div",{className:R.walletPrompt,children:e.jsx("p",{children:"Connect your account to view your artworks"})});const $=S||p;return e.jsxs("div",{className:R.container,children:[e.jsx("div",{className:R.heading,children:e.jsxs("h2",{className:y.columnHeading,children:["Your Digital Artworks (",(n==null?void 0:n.toString())||"0",")"]})}),$&&j.length===0?e.jsxs("div",{className:R.loadingContainer,children:[e.jsx("div",{className:z}),e.jsx("p",{children:"Loading your artworks..."})]}):n===0n||!n?e.jsx("div",{className:R.emptyStateContainer,children:e.jsx("p",{className:R.emptyStateText,children:"You haven't created any artworks yet. Use the generator above to create your first one!"})}):e.jsx("div",{className:R.grid,children:j.map((l,i)=>e.jsx(pe,{nft:l,onImageClick:C,onNftBurned:()=>T(),isHighlighted:P===l.tokenId},`${l.tokenId}-${i}`))}),x&&e.jsx(ge,{image:x,onClose:()=>C(null)})]})}function pe({nft:t,onImageClick:u,onNftBurned:s,isHighlighted:h=!1}){var I,D,a;const{writeContract:w,isPending:m,data:j}=J(),g=q(),[p,b]=d.useState(!1),[P,f]=d.useState(""),[x,C]=d.useState("success"),n=H.useRef(null),{isLoading:S,isSuccess:L}=de({hash:j});d.useEffect(()=>{L&&setTimeout(()=>{s()},1e3)},[L,s]),d.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]);const T=(r,c="success")=>{f(r),C(c),b(!0),n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{b(!1),n.current=null},4e3)},$=()=>{var r,c,k;t.imageUrl&&u({src:t.imageUrl,alt:((r=t.metadata)==null?void 0:r.name)||`Artwork #${t.tokenId}`,title:(c=t.metadata)==null?void 0:c.name,description:(k=t.metadata)==null?void 0:k.description})},l=async()=>{var r;if(t.imageUrl)try{const k=await(await fetch(t.imageUrl)).blob(),E=window.URL.createObjectURL(k),v=document.createElement("a");v.href=E,v.download=`${((r=t.metadata)==null?void 0:r.name)||`Artwork-${t.tokenId}`}.png`,document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(E)}catch(c){console.error("Download failed:",c),T("Download failed. Please try again.","error")}},i=async()=>{const c=`https://opensea.io/item/optimism/${g.address}/${t.tokenId}`;try{await navigator.clipboard.writeText(c),T("OpenSea URL copied to clipboard!","success")}catch(k){console.error("Failed to copy URL:",k),window.open(c,"_blank","noopener,noreferrer")}},N=async()=>{var r;if(confirm(`Are you sure you want to permanently delete "${((r=t.metadata)==null?void 0:r.name)||`Artwork #${t.tokenId}`}"? This action cannot be undone.`))try{await w({...g,functionName:"burn",args:[t.tokenId]})}catch(c){console.error("Delete failed:",c),T("Failed to delete artwork. Please try again.","error")}};return e.jsxs("div",{className:`${o.container} ${h?o.highlighted:""}`,children:[t.isLoading?e.jsxs("div",{className:o.loadingContainer,children:[e.jsx("div",{className:z}),e.jsx("p",{className:o.loadingText,children:"Loading artwork..."})]}):t.error?e.jsxs("div",{className:o.errorContainer,children:[e.jsx("div",{className:o.errorBox,children:e.jsx("p",{className:o.errorText,children:t.error})}),e.jsxs("p",{className:o.tokenIdText,children:["ID: ",t.tokenId.toString()]})]}):e.jsxs(e.Fragment,{children:[t.imageUrl?e.jsxs("div",{className:o.imageContainer,children:[e.jsx("img",{src:t.imageUrl,alt:((I=t.metadata)==null?void 0:I.name)||`Artwork #${t.tokenId}`,className:o.image,onClick:$,style:{cursor:"pointer"},onError:r=>{const c=r.target;c.style.display="none",c.nextElementSibling.classList.remove("hidden")}}),e.jsx("div",{className:o.imageError,style:{display:"none"},children:"Image not available"})]}):e.jsx("div",{className:o.imagePlaceholder,children:"No image available"}),e.jsx("h3",{className:o.title,children:((D=t.metadata)==null?void 0:D.name)||`Artwork #${t.tokenId}`}),((a=t.metadata)==null?void 0:a.description)&&e.jsx("p",{className:o.description,children:t.metadata.description}),e.jsx("div",{className:o.footer,children:e.jsxs("span",{children:["ID: ",t.tokenId.toString()]})}),e.jsxs("div",{className:o.actions,children:[t.imageUrl&&e.jsx("button",{onClick:$,className:`${o.actionButton} ${_}`,title:"View full size",children:"🔍 Zoom"}),t.imageUrl&&e.jsx("button",{onClick:l,className:`${o.actionButton} ${V}`,title:"Download image",children:"⬇️ Download"}),e.jsx("button",{onClick:i,className:`${o.actionButton} ${_}`,title:"Share your artwork on the marketplace",children:"📤 Share"}),e.jsx("button",{onClick:N,disabled:m||S,className:`${o.actionButton} ${m||S?_:ee}`,title:"Delete artwork (permanent)",style:{opacity:m||S?.6:1},children:m?"🗑️ Deleting...":S?"⏳ Confirming...":"🗑️ Delete"})]})]}),p&&e.jsx("div",{className:A.container,children:e.jsxs("div",{className:A.content,children:[e.jsx("span",{className:A.icon,children:x==="success"?"✅":"❌"}),e.jsx("span",{className:A.message,children:P})]})})]})}function ge({image:t,onClose:u}){const[s,h]=d.useState(!1),[w,m]=d.useState(""),[j,g]=d.useState("success"),p=H.useRef(null);d.useEffect(()=>{const f=x=>{x.key==="Escape"&&u()};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f),p.current&&clearTimeout(p.current)}},[u]);const b=(f,x="success")=>{m(f),g(x),h(!0),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{h(!1),p.current=null},4e3)},P=async()=>{try{const x=await(await fetch(t.src)).blob(),C=window.URL.createObjectURL(x),n=document.createElement("a");n.href=C,n.download=`${t.title||"NFT-image"}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(C)}catch(f){console.error("Download failed:",f),b("Download failed. Please try again.","error")}};return e.jsxs("div",{className:o.modalOverlay,onClick:u,children:[e.jsxs("div",{className:o.modalContent,onClick:f=>f.stopPropagation(),children:[e.jsx("button",{className:o.modalClose,onClick:u,children:"✕"}),e.jsx("img",{src:t.src,alt:t.alt,className:o.modalImage}),(t.title||t.description)&&e.jsxs("div",{className:o.modalInfo,children:[t.title&&e.jsx("h3",{className:o.modalTitle,children:t.title}),t.description&&e.jsx("p",{className:o.modalDescription,children:t.description}),e.jsx("div",{className:o.actions,style:{justifyContent:"center",marginTop:"12px"},children:e.jsx("button",{onClick:P,className:`${o.actionButton} ${V}`,children:"⬇️ Download Full Size"})})]})]}),s&&e.jsx("div",{className:A.container,children:e.jsxs("div",{className:A.content,children:[e.jsx("span",{className:A.icon,children:j==="success"?"✅":"❌"}),e.jsx("span",{className:A.message,children:w})]})})]})}function fe(){const[t,u]=d.useState(null),s=(m,j,g)=>{console.log("Image generation succeeded:",{tokenId:m,imageUrl:j,metadata:g}),u({tokenId:m,imageUrl:j,metadata:g})},h=m=>{console.error("Image generation failed:",m)},w=()=>{u(null)};return e.jsxs("div",{className:te,children:[e.jsx("h1",{className:ae,children:"AI Image Creator"}),e.jsx(me,{onSuccess:s,onError:h}),e.jsx(he,{newlyCreatedNFT:t??void 0,onNewNFTDisplayed:w})]})}const xe=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"})),Ne={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:le}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:ce}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:ie}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/imagegen/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:xe}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:ne}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Notes by fretchen"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:re}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:oe}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:se}}};export{Ne as configValuesSerialized};
