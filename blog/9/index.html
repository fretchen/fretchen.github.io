<!DOCTYPE html>
    <html lang="en">
      <head>
        <link rel="stylesheet" type="text/css" href="/assets/static/vike-react-9c9f96f4.BcWtY8Ol.css">
        <link rel="stylesheet" type="text/css" href="/assets/static/layouts_style-b34a8e57.D8B4iL9t.css">
        <link rel="stylesheet" type="text/css" href="/assets/static/layouts_panda-c5b34b81.BYVSAL4t.css">
        <link rel="stylesheet" type="text/css" href="/assets/static/katex-afcc0501.-PCUNDC-.css">
        <link rel="preload" href="/assets/static/KaTeX_AMS-Regular.BQhdFMY1.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Caligraphic-Bold.Dq_IR9rO.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Caligraphic-Regular.Di6jR-x-.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Fraktur-Bold.CL6g_b3V.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Fraktur-Regular.CTYiF6lA.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Main-Bold.Cx986IdX.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Main-BoldItalic.DxDJ3AOS.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Main-Italic.NWA7e6Wa.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Main-Regular.B22Nviop.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Math-BoldItalic.CZnvNsCZ.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Math-Italic.t53AETM-.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_SansSerif-Bold.D1sUS0GD.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_SansSerif-Italic.C3H0VqGB.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_SansSerif-Regular.DDBCnlJ7.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Script-Regular.D3wIWfF6.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Size1-Regular.mCD8mA8B.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Size2-Regular.Dy4dx90m.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Size3-Regular.CTq5MqoE.woff" as="font" type="font/woff" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Size4-Regular.Dl5lxZxV.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/static/KaTeX_Typewriter-Regular.CO6r4hn1.woff2" as="font" type="font/woff2" crossorigin>
        <meta charset="UTF-8" />
        
    <title>Generating AI images, paying anonymously and little</title><meta property="og:title" content="Generating AI images, paying anonymously and little" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="icon" href="/assets/static/image_3_1fc7cfc7b9e9.Ck5EW_Yn.jpg"/><script defer="" src="https://cloud.umami.is/script.js" data-website-id="e41ae7d9-a536-426d-b40e-f2488b11bf95"></script>
    
    <meta name="description" content="Blog, notepad, whatever you want to call it." /><meta property="og:description" content="Blog, notepad, whatever you want to call it." />
    
  
      </head>
      <body>
        
        <div id="root"><div class="d_flex flex-d_column max-w_token(sizes.container) m_auto"><div id="Appbar" class="p_token(spacing.sm)_token(spacing.md) w_token(sizes.full) d_flex flex-d_row gap_token(spacing.md) bd-b_token(borders.light) ai_center [@media_(max-width:_768px)]:gap_token(spacing.sm) [@media_(max-width:_768px)]:p_token(spacing.sm) [@media_(max-width:_480px)]:gap_token(spacing.xs) [@media_(max-width:_480px)]:p_token(spacing.xs)_token(spacing.sm)"><div class="pos_relative flex_1 d_flex [@media_(max-width:_768px)]:w_100%"><div class="d_flex flex-d_row gap_token(spacing.md) ai_center flex_1 [@media_(min-width:_769px)]:[&amp;_&gt;_:last-child]:ml_auto [@media_(max-width:_768px)]:ov-x_auto [@media_(max-width:_768px)]:ov-y_hidden [@media_(max-width:_768px)]:gap_token(spacing.sm) [@media_(max-width:_768px)]:w_100% [@media_(max-width:_768px)]:pb_token(spacing.xs) [@media_(max-width:_768px)]:scrs-t_x_mandatory [@media_(max-width:_768px)]:pos_relative [@media_(max-width:_768px)]:z_1 [@media_(max-width:_480px)]:gap_token(spacing.sm)"><div class="flex-sh_0 white-space_nowrap [@media_(max-width:_768px)]:scr-sa_start [@media_(max-width:_768px)]:p_token(spacing.sm)_token(spacing.md) [@media_(max-width:_768px)]:min-w_auto [@media_(max-width:_768px)]:ta_center"><a href="/" class="c_token(colors.primary) hover:bg-c_token(colors.background) ">Welcome</a></div><div class="flex-sh_0 white-space_nowrap [@media_(max-width:_768px)]:scr-sa_start [@media_(max-width:_768px)]:p_token(spacing.sm)_token(spacing.md) [@media_(max-width:_768px)]:min-w_auto [@media_(max-width:_768px)]:ta_center"><a href="/blog" class="c_token(colors.primary) fw_token(fontWeights.bold) hover:bg-c_token(colors.border) ">Blog</a></div><div class="flex-sh_0 white-space_nowrap [@media_(max-width:_768px)]:scr-sa_start [@media_(max-width:_768px)]:p_token(spacing.sm)_token(spacing.md) [@media_(max-width:_768px)]:min-w_auto [@media_(max-width:_768px)]:ta_center"><a href="/quantum" class="c_token(colors.primary) hover:bg-c_token(colors.background) ">Quantum</a></div><div class="flex-sh_0 white-space_nowrap [@media_(max-width:_768px)]:scr-sa_start [@media_(max-width:_768px)]:p_token(spacing.sm)_token(spacing.md) [@media_(max-width:_768px)]:min-w_auto [@media_(max-width:_768px)]:ta_center"><a href="/imagegen" class="c_token(colors.primary) hover:bg-c_token(colors.background) ">ImageGen</a></div><div class="flex-sh_0 white-space_nowrap [@media_(max-width:_768px)]:scr-sa_start [@media_(max-width:_768px)]:p_token(spacing.sm)_token(spacing.md) [@media_(max-width:_768px)]:min-w_auto [@media_(max-width:_768px)]:ta_center"><div class="pos_relative d_inline-block"><button class="p_8px_16px bg-c_transparent c_brand bd_1px_solid_token(colors.brand) bdr_sm cursor_pointer fw_medium d_flex ai_center gap_xs trs_all_0.2s_ease min-w_120px jc_center hover:bg-c_rgba(59,_130,_246,_0.05) hover:bd-c_#0052a3 hover:c_#0052a3 [@media_(max-width:_768px)]:p_6px_10px [@media_(max-width:_768px)]:fs_13px [@media_(max-width:_768px)]:min-w_auto [@media_(max-width:_768px)]:max-w_none [@media_(max-width:_768px)]:w_auto [@media_(max-width:_768px)]:ml_token(spacing.sm) [@media_(max-width:_480px)]:p_4px_8px [@media_(max-width:_480px)]:fs_12px [@media_(max-width:_480px)]:ml_token(spacing.xs)">Connect Account</button></div></div></div><div class="d_none [@media_(max-width:_768px)]:d_block [@media_(max-width:_768px)]:pos_absolute [@media_(max-width:_768px)]:top_0 [@media_(max-width:_768px)]:right_0 [@media_(max-width:_768px)]:w_30px [@media_(max-width:_768px)]:h_100% [@media_(max-width:_768px)]:bg_linear-gradient(to_right,_transparent_0%,_rgba(255,255,255,0.9)_70%,_white_100%) [@media_(max-width:_768px)]:pointer-events_none [@media_(max-width:_768px)]:z_2 [@media_(max-width:_768px)]:op_1 [@media_(max-width:_768px)]:trs_opacity_0.3s_ease [@media_(max-width:_768px)]:[&amp;::before]:content_&quot;→&quot; [@media_(max-width:_768px)]:[&amp;::before]:pos_absolute [@media_(max-width:_768px)]:[&amp;::before]:top_50% [@media_(max-width:_768px)]:[&amp;::before]:right_6px [@media_(max-width:_768px)]:[&amp;::before]:trf_translateY(-50%) [@media_(max-width:_768px)]:[&amp;::before]:fs_12px [@media_(max-width:_768px)]:[&amp;::before]:c_rgba(59,_130,_246,_0.7) [@media_(max-width:_768px)]:[&amp;::before]:fw_bold [@media_(max-width:_768px)]:[&amp;::before]:anim_pulse_2s_ease-in-out_infinite"></div></div></div><div id="page-container"><div id="page-content" class="p_token(spacing.md) pb_token(spacing.xl) min-h_token(sizes.screen)"><div class="max-w_900px mx_auto px_md"><h1 class="fs_2xl fw_bold m_0 mb_token(spacing.sm) c_text lh_1.2 [@media_(max-width:_768px)]:fs_xl [@media_(max-width:_480px)]:fs_lg ov_hidden tov_ellipsis wb_break-word hy_auto">Generating AI images, paying anonymously and little</h1><div class="fs_sm c_gray.600 mb_lg d_flex ai_center gap_xs flex-wrap_wrap lh_1.4 [@media_(max-width:_768px)]:fs_xs [@media_(max-width:_768px)]:gap_xs ">May 20, 2025<span class="m_0_token(spacing.xs) op_0.5 us_none">•</span>⭐ Loading...</div><div class="ov_hidden lh_1.6"><p>As I wrote already in one of my <a href="6">previous posts</a>, I have set up a small image generator on my website. The whole thing is hosted in Europe and I am using open source models. The system is running on a serverless setup, which is also hosted in Europe. The costs are low and I am happy with the setup. But to make it sustainable, I need to charge the users for the images at least as much as I get charged.</p>
<p>I do not want to go with advertisement or anything like that. To test the waters, I have recently set up a support button to &quot;support&quot; the website. This experiment proofed that it Layer-2 solutions on ethereum are nowadays super cheap and up for task. Feel free to have a look into my note over <a href="7">here</a>.</p>
<p>In the last few week I was able to tie the two ingredients (the AI system and the blockchain) together and I will describe the setup here.</p>
<h2>The challenge</h2>
<p>Nowadays it costs roughly 5 to 6 cents to generate an image with services like <a href="https://cloud.ionos.de/managed/ai-model-hub">Ionos</a> or <a href="https://deepinfra.com/">deepinfra</a>. Therefore, I wondered if it was possible to implement a payment system with similiar cost but with anonymous web3 payment systems instead of Stripe etc. This meant mostly that I had to solve two major challenges:</p>
<ul>
<li><strong>Challenge 1:</strong> How could I connect the ethereum payment systems to the serverless systems.</li>
<li><strong>Challenge 2:</strong> How could I minimize the fees and remain competitive ?</li>
</ul>
<h2>Connect payments to the AI serverless system</h2>
<p>This part actually required quite a bit of try and error. At first I thought that I could simply tell the external serverless system to &quot;listen&quot; to an ethereum event on the contract. However, this would have required a constant listener and would have been too expensive.</p>
<p>In the second step, I though about oracle systems like <a href="https://chain.link/">Chainlink</a>. However, this came with a few shortcomings:</p>
<ul>
<li>With chainlink you have to pay 3 cents per request. This is substantial overhead.</li>
<li>The only chainlink service that was really appropiate would have been <a href="https://chain.link/functions">chainlink functions</a>. However, this one needs that external API to answer within 9 seconds, which is not possible with the current AI setup, which takes up to 30 seconds to generate the images.</li>
</ul>
<p>I therefore decided to set up the contract on my own.</p>
<h3>The Smart NFT contract: Bridging Blockchain and AI</h3>
<p>The <a href="https://optimistic.etherscan.io/address/0x9859431b682e861b19e87Db14a04944BC747AB6d#code"><code>GenImNFT</code></a> contract is the heart of my solution. It functions as an automated intermediary between users who want AI-generated images and the system that creates these images. Here are its key features:</p>
<ul>
<li>
<p><strong>NFT Creation:</strong> Users can purchase (or &quot;mint&quot;) an NFT for a small fee (currently about 10 cents in ETH). This NFT initially contains a placeholder image.</p>
</li>
<li>
<p><strong>Intelligent Image Updates:</strong> Once a user has paid, the contract stores the empty NFT and signals that an image can be added. When a new image is updated by a separate wallet, the contract updates the NFT with the new image link and records that this update has occurred. No further changes to the image are possible by external wallets afterwards.</p>
</li>
<li>
<p><strong>Automatic Payment:</strong> The contract automatically pays the wallet that provided the image once the image has been updated. This happens directly within the blockchain, without requiring separate payment processing.</p>
</li>
</ul>
<h3>Using the contract</h3>
<p>I could then use the contract for the <a href="../imagegen">image generation</a> in a fairly straight-forward fashion which handles both the creation of the NFT and the image generation. When a user enters a prompt and clicks &quot;Mint &amp; Generate,&quot; the component first calls the contract&#x27;s safeMint function, sending along the required payment (around 10 cents in ETH). This transaction creates a new NFT with a temporary placeholder image.</p>
<p>After a successful mint, the component extracts the newly created token ID from the transaction receipt. This token ID uniquely identifies the NFT that needs to be updated. The component then sends this token ID along with the user&#x27;s prompt to a serverless API function that handles the AI image generation. This process is similar to the previous setup, but now the serverless function has been extended to update the NFT with the generated image using a dedicated wallet.</p>
<p>The payment system works in two steps: first, the user pays the contract when minting the NFT; then, when the image is generated and the NFT is updated, the contract automatically releases payment to the wallet that submitted the image. This ensures that users only pay for successfully generated images, and image providers are compensated only after delivering the image.</p>
<h2>The total costs</h2>
<p>All in all, the costs for the serverless system and the transactions is almost negligible. On this part, I built up directly on the very positive experience I had with the <a href="7">support button</a> that works on the <a href="https://www.optimism.io/">optimism</a> chain.</p>
<p>If I wanted to optimize the system, it would most likely be possible to offer the service for 1 cents above the price charged by the image generation services. However, for the moment I have set up a buffer against the rather hefty fluctuations of ethereum such that I can currently offer the service for roughly 10 cents an image.</p>
<h2>Some nice side effects of the system</h2>
<p>As I set up the system, I discovered the perks of the whole NFT setup. I actually decided to follow the ERC-721 standard to safe all the important imformation concerning the image. The prompt is part of the description. The model and the time of minting are simply attributes. This allowed me to directly list some of the images on <a href="https://opensea.io/">opensea</a> and opens the possibility to trade some of the cooler images.</p>
<h2>Conclusion</h2>
<p>Taken together, I am super happy with the setup:</p>
<ul>
<li>Anyone can generate AI images for a small fee such that it is sustainable.</li>
<li>The costs are fully under control and the system is fully automated.</li>
<li>The system is fully anonymous and does not require any personal data (which I never wanted to collect anyways). Say goodby annoying GDPR banners.</li>
<li>The system is fully decentralized and can be used by anyone that cares.</li>
</ul>
<p>So, if you want to generate some images, feel free to check out the <a href="../imagegen">image generation page</a> and mint your first NFT. I am looking forward to see what you can come up with and what are your comments.</p></div><div class="d_flex jc_space-between mt_xl bd-t_1px_solid_token(colors.border) pt_md"><div class="d_flex flex-d_column ai_flex-start"><a href="/blog/8" class="c_token(colors.primary) hover:bg-c_token(colors.background) "><span class="c_gray.600">Previous: </span><span class="fw_medium c_brand">My short lived contact with the world of VCs in Germany</span></a></div><div class="d_flex flex-d_column ai_flex-end ta_right"><a href="/blog/10" class="c_token(colors.primary) hover:bg-c_token(colors.background) "><span class="c_gray.600">Next: </span><span class="fw_medium c_brand">Updates to the website</span></a></div></div></div></div></div><footer class="p_token(spacing.md) ta_center bd-t_1px_solid_token(colors.border) mt_token(spacing.xl) c_gray.600"><span class="fs_sm c_gray.500">by fretchen</span></footer></div><script class="_rqd_">_rqd_=[];_rqc_=()=>{Array.from(
        document.getElementsByClassName("_rqd_")
      ).forEach((e) => e.remove())};_rqc_()</script></div>
        
        <script id="vike_pageContext" type="application/json">{"_urlRewrite":null,"pageId":"!/pages/blog/@id","routeParams":{"id":"9"}}</script>
        <script id="vike_globalContext" type="application/json">{}</script>
        <script src="/assets/entries/entry-client-routing.BtIFXeIX.js" type="module" async></script>
        <link rel="modulepreload" href="/assets/entries/pages_blog_-id.B0nvFXZ5.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-DL7sj6F6.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-ETYCELfk.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-BBzGi2qx.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-_4WLh2YF.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-U5yrpZ3U.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-B06vZUX9.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-GjwIKr4Q.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-BkZTit6M.js" as="script" type="text/javascript">
        <link rel="modulepreload" href="/assets/chunks/chunk-V4Eg7efz.js" as="script" type="text/javascript">
      </body>
    </html>