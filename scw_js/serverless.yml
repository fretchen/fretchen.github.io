service: my-personal-js-cloud

# Read environment variables from a .env file
useDotenv: true

configValidationMode: off
provider:
  name: scaleway
  runtime: node22
  secret:
    SCW_SECRET_KEY: ${env:SCW_SECRET_KEY}
    SCW_ACCESS_KEY: ${env:SCW_ACCESS_KEY}
    IONOS_API_TOKEN: ${env:IONOS_API_TOKEN}
    BFL_API_TOKEN: ${env:BFL_API_TOKEN}
    NFT_WALLET_PRIVATE_KEY: ${env:NFT_WALLET_PRIVATE_KEY}
    NFT_WALLET_PUBLIC_KEY: ${env:NFT_WALLET_PUBLIC_KEY}
    USDC_PAYMENT_AMOUNT: ${env:USDC_PAYMENT_AMOUNT, "70000"}

plugins:
  - serverless-scaleway-functions

package:
  patterns:
    - "dist/**"
    - "!node_modules/**"
    - "!test/**"
    - "!coverage/**"
    - "!.git/**"
    - "!*.test.js"
    - "!tsup.config.js"
    - "!vitest.config.js"
    - "!eslint.config.js"

functions:
  genimgx402token:
    handler: dist/genimg_x402_token.handle
    description: "x402 v2 Token Payment - Paid image generation with USDC"
    custom_domains:
      - imagegen-agent.fretchen.eu
  llm:
    handler: dist/sc_llm.handle
  leafhistory:
    handler: dist/leaf_history.handle
